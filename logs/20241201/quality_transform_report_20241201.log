2024-12-01 08:58:13,651 - ERROR - Removed 0 duplicate rows
2024-12-01 08:58:13,668 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 08:58:13,670 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 08:58:13,670 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 08:58:14,110 - ERROR - Removed 0 duplicate rows
2024-12-01 08:58:14,112 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 08:58:14,112 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 08:58:14,482 - ERROR - Removed 0 duplicate rows
2024-12-01 08:58:14,484 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 08:58:14,484 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 08:58:14,850 - ERROR - Removed 0 duplicate rows
2024-12-01 08:58:14,852 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 08:58:14,853 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 08:58:15,202 - ERROR - Removed 0 duplicate rows
2024-12-01 08:58:15,204 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 08:58:15,204 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 08:58:15,692 - ERROR - Removed 0 duplicate rows
2024-12-01 08:58:15,693 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 08:58:15,694 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 08:58:16,067 - ERROR - Removed 0 duplicate rows
2024-12-01 08:58:16,069 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 08:58:16,069 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 08:58:16,070 - ERROR - Starting cleaning for transactions
2024-12-01 08:58:16,162 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 08:58:16,220 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 08:58:16,254 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 08:58:16,280 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 08:58:16,361 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 08:58:16,361 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 08:58:16,433 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 08:58:16,433 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 08:58:16,500 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 08:58:16,500 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 08:58:16,501 - INFO - Finished cleaning for transactions
2024-12-01 08:58:16,502 - ERROR - Finished cleaning for transactions
2024-12-01 08:58:16,741 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 08:58:16,741 - ERROR - Starting cleaning for clients
2024-12-01 08:58:16,783 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 08:58:16,800 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 08:58:16,812 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 08:58:16,814 - INFO - Finished cleaning for clients
2024-12-01 08:58:16,814 - ERROR - Finished cleaning for clients
2024-12-01 08:58:16,987 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 08:58:16,988 - ERROR - Starting cleaning for produits
2024-12-01 08:58:17,000 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 08:58:17,014 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 08:58:17,046 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 08:58:17,048 - INFO - Finished cleaning for produits
2024-12-01 08:58:17,048 - ERROR - Finished cleaning for produits
2024-12-01 08:58:17,187 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 08:58:17,188 - ERROR - Starting cleaning for magasins
2024-12-01 08:58:17,226 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 08:58:17,237 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 08:58:17,250 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 08:58:17,251 - INFO - Finished cleaning for magasins
2024-12-01 08:58:17,251 - ERROR - Finished cleaning for magasins
2024-12-01 08:58:17,369 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 08:58:17,370 - ERROR - Starting cleaning for exchange
2024-12-01 08:58:17,376 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 08:58:17,393 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 08:58:17,394 - INFO - Finished cleaning for exchange
2024-12-01 08:58:17,395 - ERROR - Finished cleaning for exchange
2024-12-01 08:58:17,650 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 27514 rows after removing duplicates.
2024-12-01 08:58:17,651 - ERROR - Starting cleaning for rates
2024-12-01 08:58:17,656 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 08:58:17,671 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 08:58:17,673 - INFO - Finished cleaning for rates
2024-12-01 08:58:17,673 - ERROR - Finished cleaning for rates
2024-12-01 08:58:17,819 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 08:58:17,820 - ERROR - Starting cleaning for categories
2024-12-01 08:58:17,825 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 08:58:17,835 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 08:58:17,836 - INFO - Finished cleaning for categories
2024-12-01 08:58:17,836 - ERROR - Finished cleaning for categories
2024-12-01 08:58:17,985 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 08:58:18,198 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 08:58:18,325 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 08:58:18,445 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 08:58:18,560 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 08:58:18,588 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 08:58:18,589 - INFO - Début des jointures et des transformations.
2024-12-01 08:58:18,639 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 08:58:19,937 - ERROR - Calcul des taxes en cours...
2024-12-01 08:58:19,939 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'id_taux', 'currency', 'ratetoeuro']
2024-12-01 08:58:19,940 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 08:58:19,940 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 08:58:19,941 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 08:58:19,983 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 08:58:20,165 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 08:58:21,142 - ERROR - Calcul du taux de taxe terminé
2024-12-01 08:58:21,208 - ERROR - Calcul du prix après remise terminé
2024-12-01 08:58:22,908 - ERROR - Nombre total de lignes : 2155.
2024-12-01 08:58:22,909 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 08:58:22,909 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 08:58:23,583 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 08:58:23,585 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 08:58:23,648 - ERROR - Détection des anomalies en cours...
2024-12-01 08:58:23,750 - ERROR - Détection des anomalies terminée.
2024-12-01 08:58:24,369 - ERROR - Total anomalies detected: 4
2024-12-01 08:58:24,370 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 08:58:24,683 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 08:58:26,220 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 08:58:26,220 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 08:58:26,678 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 08:58:26,759 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 08:58:26,760 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 08:58:26,818 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 08:58:26,818 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 08:58:26,936 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 08:58:26,936 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 08:58:30,536 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 08:58:30,537 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 08:58:31,118 - INFO - Data cleaning process completed.
2024-12-01 08:58:31,123 - INFO - Closing down clientserver connection
2024-12-01 09:21:32,128 - ERROR - Removed 0 duplicate rows
2024-12-01 09:21:32,145 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 09:21:32,146 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 09:21:32,146 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 09:21:32,606 - ERROR - Removed 0 duplicate rows
2024-12-01 09:21:32,608 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 09:21:32,609 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 09:21:32,963 - ERROR - Removed 0 duplicate rows
2024-12-01 09:21:32,965 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 09:21:32,965 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 09:21:33,323 - ERROR - Removed 0 duplicate rows
2024-12-01 09:21:33,325 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 09:21:33,325 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 09:21:33,643 - ERROR - Removed 0 duplicate rows
2024-12-01 09:21:33,645 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 09:21:33,645 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 09:21:34,142 - ERROR - Removed 0 duplicate rows
2024-12-01 09:21:34,144 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 09:21:34,144 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 09:21:34,480 - ERROR - Removed 0 duplicate rows
2024-12-01 09:21:34,482 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 09:21:34,482 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 09:21:34,483 - ERROR - Starting cleaning for transactions
2024-12-01 09:21:34,591 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 09:21:34,630 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 09:21:34,660 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 09:21:34,683 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 09:21:34,758 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 09:21:34,758 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 09:21:34,834 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 09:21:34,834 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 09:21:34,912 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 09:21:34,912 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 09:21:34,913 - INFO - Finished cleaning for transactions
2024-12-01 09:21:34,913 - ERROR - Finished cleaning for transactions
2024-12-01 09:21:35,144 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 09:21:35,146 - ERROR - Starting cleaning for clients
2024-12-01 09:21:35,189 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 09:21:35,203 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 09:21:35,215 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 09:21:35,217 - INFO - Finished cleaning for clients
2024-12-01 09:21:35,217 - ERROR - Finished cleaning for clients
2024-12-01 09:21:35,356 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 09:21:35,357 - ERROR - Starting cleaning for produits
2024-12-01 09:21:35,369 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 09:21:35,382 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 09:21:35,414 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 09:21:35,415 - INFO - Finished cleaning for produits
2024-12-01 09:21:35,416 - ERROR - Finished cleaning for produits
2024-12-01 09:21:35,606 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 09:21:35,607 - ERROR - Starting cleaning for magasins
2024-12-01 09:21:35,641 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 09:21:35,651 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 09:21:35,663 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 09:21:35,664 - INFO - Finished cleaning for magasins
2024-12-01 09:21:35,664 - ERROR - Finished cleaning for magasins
2024-12-01 09:21:35,776 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 09:21:35,776 - ERROR - Starting cleaning for exchange
2024-12-01 09:21:35,789 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 09:21:35,802 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 09:21:35,804 - INFO - Finished cleaning for exchange
2024-12-01 09:21:35,804 - ERROR - Finished cleaning for exchange
2024-12-01 09:21:36,046 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 27514 rows after removing duplicates.
2024-12-01 09:21:36,046 - ERROR - Starting cleaning for rates
2024-12-01 09:21:36,052 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 09:21:36,066 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 09:21:36,067 - INFO - Finished cleaning for rates
2024-12-01 09:21:36,067 - ERROR - Finished cleaning for rates
2024-12-01 09:21:36,208 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 09:21:36,209 - ERROR - Starting cleaning for categories
2024-12-01 09:21:36,214 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 09:21:36,225 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 09:21:36,226 - INFO - Finished cleaning for categories
2024-12-01 09:21:36,226 - ERROR - Finished cleaning for categories
2024-12-01 09:21:36,341 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 09:21:36,558 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 09:21:36,704 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 09:21:36,831 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 09:21:36,976 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 09:21:37,007 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 09:21:37,007 - INFO - Début des jointures et des transformations.
2024-12-01 09:21:37,057 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 09:21:38,265 - ERROR - Calcul des taxes en cours...
2024-12-01 09:21:38,267 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'id_taux', 'currency', 'ratetoeuro']
2024-12-01 09:21:38,268 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 09:21:38,268 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 09:21:38,268 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 09:21:38,309 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 09:21:38,444 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 09:21:39,216 - ERROR - Calcul du taux de taxe terminé
2024-12-01 09:21:39,258 - ERROR - Calcul du prix après remise terminé
2024-12-01 09:21:40,848 - ERROR - Nombre total de lignes : 2155.
2024-12-01 09:21:40,849 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 09:21:40,849 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 09:21:41,419 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 09:21:41,420 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 09:21:41,448 - ERROR - Détection des anomalies en cours...
2024-12-01 09:21:41,542 - ERROR - Détection des anomalies terminée.
2024-12-01 09:21:42,149 - ERROR - Total anomalies detected: 4
2024-12-01 09:21:42,150 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 09:21:42,461 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 09:21:43,929 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 09:21:43,929 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 09:21:44,346 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 09:21:44,411 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 09:21:44,411 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 09:21:44,465 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 09:21:44,465 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 09:21:44,571 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 09:21:44,571 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 09:21:48,490 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 09:21:48,490 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 09:21:48,831 - INFO - Data cleaning process completed.
2024-12-01 09:21:48,834 - INFO - Closing down clientserver connection
2024-12-01 09:30:56,794 - ERROR - Removed 0 duplicate rows
2024-12-01 09:30:56,810 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 09:30:56,811 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 09:30:56,811 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 09:30:57,280 - ERROR - Removed 0 duplicate rows
2024-12-01 09:30:57,282 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 09:30:57,282 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 09:30:57,678 - ERROR - Removed 0 duplicate rows
2024-12-01 09:30:57,680 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 09:30:57,680 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 09:30:58,061 - ERROR - Removed 0 duplicate rows
2024-12-01 09:30:58,062 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 09:30:58,062 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 09:30:58,408 - ERROR - Removed 0 duplicate rows
2024-12-01 09:30:58,409 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 09:30:58,410 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 09:30:58,901 - ERROR - Removed 0 duplicate rows
2024-12-01 09:30:58,903 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 09:30:58,903 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 09:30:59,230 - ERROR - Removed 0 duplicate rows
2024-12-01 09:30:59,232 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 09:30:59,232 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 09:30:59,233 - ERROR - Starting cleaning for transactions
2024-12-01 09:30:59,335 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 09:30:59,382 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 09:30:59,411 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 09:30:59,436 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 09:30:59,498 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 09:30:59,498 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 09:30:59,561 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 09:30:59,562 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 09:30:59,624 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 09:30:59,624 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 09:30:59,625 - INFO - Finished cleaning for transactions
2024-12-01 09:30:59,625 - ERROR - Finished cleaning for transactions
2024-12-01 09:30:59,866 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 09:30:59,867 - ERROR - Starting cleaning for clients
2024-12-01 09:30:59,909 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 09:30:59,924 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 09:30:59,939 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 09:30:59,941 - INFO - Finished cleaning for clients
2024-12-01 09:30:59,941 - ERROR - Finished cleaning for clients
2024-12-01 09:31:00,125 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 09:31:00,126 - ERROR - Starting cleaning for produits
2024-12-01 09:31:00,140 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 09:31:00,154 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 09:31:00,183 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 09:31:00,184 - INFO - Finished cleaning for produits
2024-12-01 09:31:00,184 - ERROR - Finished cleaning for produits
2024-12-01 09:31:00,322 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 09:31:00,323 - ERROR - Starting cleaning for magasins
2024-12-01 09:31:00,357 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 09:31:00,371 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 09:31:00,384 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 09:31:00,385 - INFO - Finished cleaning for magasins
2024-12-01 09:31:00,385 - ERROR - Finished cleaning for magasins
2024-12-01 09:31:00,511 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 09:31:00,512 - ERROR - Starting cleaning for exchange
2024-12-01 09:31:00,518 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 09:31:00,533 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 09:31:00,535 - INFO - Finished cleaning for exchange
2024-12-01 09:31:00,535 - ERROR - Finished cleaning for exchange
2024-12-01 09:31:00,783 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 27514 rows after removing duplicates.
2024-12-01 09:31:00,784 - ERROR - Starting cleaning for rates
2024-12-01 09:31:00,789 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 09:31:00,800 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 09:31:00,801 - INFO - Finished cleaning for rates
2024-12-01 09:31:00,801 - ERROR - Finished cleaning for rates
2024-12-01 09:31:00,941 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 09:31:00,941 - ERROR - Starting cleaning for categories
2024-12-01 09:31:00,947 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 09:31:00,959 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 09:31:00,960 - INFO - Finished cleaning for categories
2024-12-01 09:31:00,961 - ERROR - Finished cleaning for categories
2024-12-01 09:31:01,069 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 09:31:01,316 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 09:31:01,498 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 09:31:01,624 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 09:31:01,736 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 09:31:01,766 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 09:31:01,766 - INFO - Début des jointures et des transformations.
2024-12-01 09:31:01,815 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 09:31:03,061 - ERROR - Calcul des taxes en cours...
2024-12-01 09:31:03,063 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'id_taux', 'currency', 'ratetoeuro']
2024-12-01 09:31:03,064 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 09:31:03,064 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 09:31:03,064 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 09:31:03,111 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 09:31:03,255 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 09:31:04,041 - ERROR - Calcul du taux de taxe terminé
2024-12-01 09:31:04,087 - ERROR - Calcul du prix après remise terminé
2024-12-01 09:31:05,484 - ERROR - Nombre total de lignes : 2155.
2024-12-01 09:31:05,485 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 09:31:05,485 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 09:31:06,308 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 09:31:06,309 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 09:31:06,336 - ERROR - Détection des anomalies en cours...
2024-12-01 09:31:06,440 - ERROR - Détection des anomalies terminée.
2024-12-01 09:31:07,032 - ERROR - Total anomalies detected: 4
2024-12-01 09:31:07,032 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 09:31:07,348 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 09:31:08,833 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 09:31:08,833 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 09:31:09,232 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 09:31:09,308 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 09:31:09,309 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 09:31:09,361 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 09:31:09,361 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 09:31:09,475 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 09:31:09,475 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 09:31:12,981 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 09:31:12,981 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 09:31:13,444 - INFO - Data cleaning process completed.
2024-12-01 09:31:13,446 - INFO - Closing down clientserver connection
2024-12-01 12:23:12,596 - ERROR - Removed 0 duplicate rows
2024-12-01 12:23:12,611 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 12:23:12,612 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:23:12,612 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:23:13,030 - ERROR - Removed 0 duplicate rows
2024-12-01 12:23:13,032 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:23:13,033 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:23:13,446 - ERROR - Removed 0 duplicate rows
2024-12-01 12:23:13,447 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:23:13,448 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:23:13,813 - ERROR - Removed 0 duplicate rows
2024-12-01 12:23:13,815 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:23:13,815 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:23:14,158 - ERROR - Removed 0 duplicate rows
2024-12-01 12:23:14,160 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:23:14,161 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:23:14,646 - ERROR - Removed 0 duplicate rows
2024-12-01 12:23:14,648 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:23:14,649 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:23:15,053 - ERROR - Removed 0 duplicate rows
2024-12-01 12:23:15,055 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:23:15,056 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:23:15,056 - ERROR - Starting cleaning for transactions
2024-12-01 12:23:15,154 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:23:15,192 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 12:23:15,217 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:23:15,236 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 12:23:15,302 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 12:23:15,303 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 12:23:15,374 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:23:15,374 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:23:15,442 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:23:15,442 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:23:15,443 - INFO - Finished cleaning for transactions
2024-12-01 12:23:15,444 - ERROR - Finished cleaning for transactions
2024-12-01 12:23:15,689 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 12:23:15,690 - ERROR - Starting cleaning for clients
2024-12-01 12:23:15,737 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:23:15,750 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:23:15,765 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:23:15,767 - INFO - Finished cleaning for clients
2024-12-01 12:23:15,767 - ERROR - Finished cleaning for clients
2024-12-01 12:23:15,923 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 12:23:15,924 - ERROR - Starting cleaning for produits
2024-12-01 12:23:15,938 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:23:15,949 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:23:15,990 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 12:23:15,991 - INFO - Finished cleaning for produits
2024-12-01 12:23:15,992 - ERROR - Finished cleaning for produits
2024-12-01 12:23:16,153 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 12:23:16,153 - ERROR - Starting cleaning for magasins
2024-12-01 12:23:16,189 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:23:16,201 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:23:16,215 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:23:16,216 - INFO - Finished cleaning for magasins
2024-12-01 12:23:16,216 - ERROR - Finished cleaning for magasins
2024-12-01 12:23:16,343 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 12:23:16,344 - ERROR - Starting cleaning for exchange
2024-12-01 12:23:16,351 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:23:16,363 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:23:16,364 - INFO - Finished cleaning for exchange
2024-12-01 12:23:16,365 - ERROR - Finished cleaning for exchange
2024-12-01 12:23:16,629 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 27514 rows after removing duplicates.
2024-12-01 12:23:16,630 - ERROR - Starting cleaning for rates
2024-12-01 12:23:16,637 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:23:16,650 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:23:16,652 - INFO - Finished cleaning for rates
2024-12-01 12:23:16,652 - ERROR - Finished cleaning for rates
2024-12-01 12:23:16,796 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 12:23:16,796 - ERROR - Starting cleaning for categories
2024-12-01 12:23:16,801 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:23:16,813 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 12:23:16,815 - INFO - Finished cleaning for categories
2024-12-01 12:23:16,815 - ERROR - Finished cleaning for categories
2024-12-01 12:23:16,928 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 12:23:17,171 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 12:23:17,303 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 12:23:17,430 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 12:23:17,543 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 12:23:17,584 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 12:23:17,584 - INFO - Début des jointures et des transformations.
2024-12-01 12:23:17,634 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 12:23:18,960 - ERROR - Calcul des taxes en cours...
2024-12-01 12:23:18,962 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'id_taux', 'currency', 'ratetoeuro']
2024-12-01 12:23:18,964 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 12:23:18,964 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 12:23:18,965 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 12:23:19,011 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 12:23:19,197 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 12:23:20,352 - ERROR - Calcul du taux de taxe terminé
2024-12-01 12:23:20,414 - ERROR - Calcul du prix après remise terminé
2024-12-01 12:23:22,175 - ERROR - Nombre total de lignes : 2155.
2024-12-01 12:23:22,176 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 12:23:22,177 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 12:23:22,914 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 12:23:22,915 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 12:23:22,948 - ERROR - Détection des anomalies en cours...
2024-12-01 12:23:23,075 - ERROR - Détection des anomalies terminée.
2024-12-01 12:23:23,860 - ERROR - Total anomalies detected: 4
2024-12-01 12:23:23,861 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 12:23:24,307 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 12:23:26,361 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 12:23:26,362 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 12:23:26,848 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 12:23:26,964 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:23:26,965 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:23:27,028 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 12:23:27,028 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 12:23:27,145 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:23:27,146 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:23:31,806 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:23:31,806 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:23:32,362 - INFO - Data cleaning process completed.
2024-12-01 12:23:32,364 - INFO - Closing down clientserver connection
2024-12-01 12:24:31,046 - ERROR - Removed 0 duplicate rows
2024-12-01 12:24:31,062 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 12:24:31,062 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:24:31,064 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:24:31,517 - ERROR - Removed 0 duplicate rows
2024-12-01 12:24:31,518 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:24:31,519 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:24:31,881 - ERROR - Removed 0 duplicate rows
2024-12-01 12:24:31,883 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:24:31,884 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:24:32,229 - ERROR - Removed 0 duplicate rows
2024-12-01 12:24:32,231 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:24:32,231 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:24:32,530 - ERROR - Removed 0 duplicate rows
2024-12-01 12:24:32,532 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:24:32,532 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:24:33,033 - ERROR - Removed 0 duplicate rows
2024-12-01 12:24:33,036 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:24:33,036 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:24:33,381 - ERROR - Removed 0 duplicate rows
2024-12-01 12:24:33,383 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:24:33,384 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:24:33,384 - ERROR - Starting cleaning for transactions
2024-12-01 12:24:33,484 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:24:33,529 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 12:24:33,555 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:24:33,574 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 12:24:33,650 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 12:24:33,650 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 12:24:33,720 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:24:33,720 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:24:33,790 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:24:33,791 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:24:33,791 - INFO - Finished cleaning for transactions
2024-12-01 12:24:33,792 - ERROR - Finished cleaning for transactions
2024-12-01 12:24:34,024 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 12:24:34,024 - ERROR - Starting cleaning for clients
2024-12-01 12:24:34,066 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:24:34,080 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:24:34,093 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:24:34,095 - INFO - Finished cleaning for clients
2024-12-01 12:24:34,095 - ERROR - Finished cleaning for clients
2024-12-01 12:24:34,244 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 12:24:34,245 - ERROR - Starting cleaning for produits
2024-12-01 12:24:34,262 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:24:34,274 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:24:34,332 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 12:24:34,334 - INFO - Finished cleaning for produits
2024-12-01 12:24:34,334 - ERROR - Finished cleaning for produits
2024-12-01 12:24:34,483 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 12:24:34,484 - ERROR - Starting cleaning for magasins
2024-12-01 12:24:34,517 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:24:34,529 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:24:34,541 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:24:34,542 - INFO - Finished cleaning for magasins
2024-12-01 12:24:34,542 - ERROR - Finished cleaning for magasins
2024-12-01 12:24:34,658 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 12:24:34,659 - ERROR - Starting cleaning for exchange
2024-12-01 12:24:34,666 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:24:34,679 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:24:34,681 - INFO - Finished cleaning for exchange
2024-12-01 12:24:34,681 - ERROR - Finished cleaning for exchange
2024-12-01 12:24:34,929 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 27514 rows after removing duplicates.
2024-12-01 12:24:34,929 - ERROR - Starting cleaning for rates
2024-12-01 12:24:34,935 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:24:34,947 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:24:34,948 - INFO - Finished cleaning for rates
2024-12-01 12:24:34,948 - ERROR - Finished cleaning for rates
2024-12-01 12:24:35,089 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 12:24:35,089 - ERROR - Starting cleaning for categories
2024-12-01 12:24:35,094 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:24:35,103 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 12:24:35,104 - INFO - Finished cleaning for categories
2024-12-01 12:24:35,104 - ERROR - Finished cleaning for categories
2024-12-01 12:24:35,234 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 12:24:35,453 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 12:24:35,587 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 12:24:35,743 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 12:24:35,860 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 12:24:35,904 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 12:24:35,904 - INFO - Début des jointures et des transformations.
2024-12-01 12:24:35,952 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 12:24:37,189 - ERROR - Calcul des taxes en cours...
2024-12-01 12:24:37,191 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'id_taux', 'currency', 'ratetoeuro']
2024-12-01 12:24:37,192 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 12:24:37,193 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 12:24:37,193 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 12:24:37,231 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 12:24:37,373 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 12:24:38,275 - ERROR - Calcul du taux de taxe terminé
2024-12-01 12:24:38,318 - ERROR - Calcul du prix après remise terminé
2024-12-01 12:24:39,819 - ERROR - Nombre total de lignes : 2155.
2024-12-01 12:24:39,819 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 12:24:39,820 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 12:24:40,485 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 12:24:40,486 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 12:24:40,515 - ERROR - Détection des anomalies en cours...
2024-12-01 12:24:40,616 - ERROR - Détection des anomalies terminée.
2024-12-01 12:24:41,526 - ERROR - Total anomalies detected: 4
2024-12-01 12:24:41,526 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 12:24:41,848 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 12:24:43,320 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 12:24:43,320 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 12:24:43,730 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 12:24:43,794 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:24:43,795 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:24:43,842 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 12:24:43,842 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 12:24:43,946 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:24:43,946 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:24:47,602 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:24:47,602 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:24:47,923 - INFO - Data cleaning process completed.
2024-12-01 12:24:47,925 - INFO - Closing down clientserver connection
2024-12-01 12:27:57,270 - ERROR - Removed 0 duplicate rows
2024-12-01 12:27:57,283 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 12:27:57,284 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:27:57,284 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:27:57,720 - ERROR - Removed 0 duplicate rows
2024-12-01 12:27:57,723 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:27:57,724 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:27:58,112 - ERROR - Removed 0 duplicate rows
2024-12-01 12:27:58,115 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:27:58,116 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:27:58,495 - ERROR - Removed 0 duplicate rows
2024-12-01 12:27:58,496 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:27:58,497 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:27:58,798 - ERROR - Removed 0 duplicate rows
2024-12-01 12:27:58,799 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:27:58,800 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:27:59,299 - ERROR - Removed 0 duplicate rows
2024-12-01 12:27:59,301 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:27:59,302 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:27:59,645 - ERROR - Removed 0 duplicate rows
2024-12-01 12:27:59,646 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:27:59,647 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:27:59,647 - ERROR - Starting cleaning for transactions
2024-12-01 12:27:59,752 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:27:59,792 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 12:27:59,814 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:27:59,835 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 12:27:59,898 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 12:27:59,899 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 12:27:59,964 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:27:59,964 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:28:00,034 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:28:00,034 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:28:00,035 - INFO - Finished cleaning for transactions
2024-12-01 12:28:00,035 - ERROR - Finished cleaning for transactions
2024-12-01 12:28:00,270 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 12:28:00,271 - ERROR - Starting cleaning for clients
2024-12-01 12:28:00,312 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:28:00,350 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:28:00,363 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:28:00,365 - INFO - Finished cleaning for clients
2024-12-01 12:28:00,365 - ERROR - Finished cleaning for clients
2024-12-01 12:28:00,516 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 12:28:00,516 - ERROR - Starting cleaning for produits
2024-12-01 12:28:00,527 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:28:00,537 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:28:00,564 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 12:28:00,565 - INFO - Finished cleaning for produits
2024-12-01 12:28:00,566 - ERROR - Finished cleaning for produits
2024-12-01 12:28:00,708 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 12:28:00,708 - ERROR - Starting cleaning for magasins
2024-12-01 12:28:00,735 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:28:00,749 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:28:00,762 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:28:00,764 - INFO - Finished cleaning for magasins
2024-12-01 12:28:00,764 - ERROR - Finished cleaning for magasins
2024-12-01 12:28:00,883 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 12:28:00,884 - ERROR - Starting cleaning for exchange
2024-12-01 12:28:00,890 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:28:00,903 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:28:00,904 - INFO - Finished cleaning for exchange
2024-12-01 12:28:00,905 - ERROR - Finished cleaning for exchange
2024-12-01 12:28:01,155 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 27514 rows after removing duplicates.
2024-12-01 12:28:01,155 - ERROR - Starting cleaning for rates
2024-12-01 12:28:01,162 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:28:01,172 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:28:01,173 - INFO - Finished cleaning for rates
2024-12-01 12:28:01,173 - ERROR - Finished cleaning for rates
2024-12-01 12:28:01,357 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 12:28:01,358 - ERROR - Starting cleaning for categories
2024-12-01 12:28:01,364 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:28:01,375 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 12:28:01,376 - INFO - Finished cleaning for categories
2024-12-01 12:28:01,377 - ERROR - Finished cleaning for categories
2024-12-01 12:28:01,507 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 12:28:01,778 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 12:28:01,935 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 12:28:02,065 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 12:28:02,209 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 12:28:02,259 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 12:28:02,260 - INFO - Début des jointures et des transformations.
2024-12-01 12:28:02,308 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 12:28:03,993 - ERROR - Calcul des taxes en cours...
2024-12-01 12:28:03,995 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'id_taux', 'currency', 'ratetoeuro']
2024-12-01 12:28:03,996 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 12:28:03,996 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 12:28:03,997 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 12:28:04,031 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 12:28:04,163 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 12:28:05,076 - ERROR - Calcul du taux de taxe terminé
2024-12-01 12:28:05,137 - ERROR - Calcul du prix après remise terminé
2024-12-01 12:28:06,799 - ERROR - Nombre total de lignes : 2155.
2024-12-01 12:28:06,800 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 12:28:06,800 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 12:28:07,458 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 12:28:07,459 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 12:28:07,487 - ERROR - Détection des anomalies en cours...
2024-12-01 12:28:07,583 - ERROR - Détection des anomalies terminée.
2024-12-01 12:28:08,293 - ERROR - Total anomalies detected: 4
2024-12-01 12:28:08,294 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 12:28:08,737 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 12:28:10,418 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 12:28:10,418 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 12:28:10,827 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 12:28:10,896 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:28:10,897 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:28:10,947 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 12:28:10,948 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 12:28:11,053 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:28:11,054 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:28:15,569 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:28:15,569 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:28:15,716 - INFO - Data cleaning process completed.
2024-12-01 12:28:15,718 - INFO - Closing down clientserver connection
2024-12-01 12:29:25,991 - ERROR - Removed 0 duplicate rows
2024-12-01 12:29:26,006 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 12:29:26,007 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:29:26,007 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:29:26,471 - ERROR - Removed 0 duplicate rows
2024-12-01 12:29:26,473 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:29:26,474 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:29:26,840 - ERROR - Removed 0 duplicate rows
2024-12-01 12:29:26,843 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:29:26,843 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:29:27,180 - ERROR - Removed 0 duplicate rows
2024-12-01 12:29:27,182 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:29:27,183 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:29:27,500 - ERROR - Removed 0 duplicate rows
2024-12-01 12:29:27,501 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:29:27,502 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:29:28,015 - ERROR - Removed 0 duplicate rows
2024-12-01 12:29:28,016 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:29:28,017 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:29:28,365 - ERROR - Removed 0 duplicate rows
2024-12-01 12:29:28,367 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:29:28,368 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:29:28,368 - ERROR - Starting cleaning for transactions
2024-12-01 12:29:28,473 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:29:28,515 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 12:29:28,540 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:29:28,559 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 12:29:28,630 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 12:29:28,630 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 12:29:28,697 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:29:28,698 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:29:28,760 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:29:28,760 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:29:28,761 - INFO - Finished cleaning for transactions
2024-12-01 12:29:28,761 - ERROR - Finished cleaning for transactions
2024-12-01 12:29:29,000 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 12:29:29,001 - ERROR - Starting cleaning for clients
2024-12-01 12:29:29,042 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:29:29,059 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:29:29,072 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:29:29,074 - INFO - Finished cleaning for clients
2024-12-01 12:29:29,074 - ERROR - Finished cleaning for clients
2024-12-01 12:29:29,247 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 12:29:29,248 - ERROR - Starting cleaning for produits
2024-12-01 12:29:29,272 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:29:29,285 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:29:29,316 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 12:29:29,318 - INFO - Finished cleaning for produits
2024-12-01 12:29:29,318 - ERROR - Finished cleaning for produits
2024-12-01 12:29:29,453 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 12:29:29,454 - ERROR - Starting cleaning for magasins
2024-12-01 12:29:29,486 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:29:29,497 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:29:29,507 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:29:29,509 - INFO - Finished cleaning for magasins
2024-12-01 12:29:29,509 - ERROR - Finished cleaning for magasins
2024-12-01 12:29:29,628 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 12:29:29,629 - ERROR - Starting cleaning for exchange
2024-12-01 12:29:29,635 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:29:29,647 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:29:29,649 - INFO - Finished cleaning for exchange
2024-12-01 12:29:29,649 - ERROR - Finished cleaning for exchange
2024-12-01 12:29:29,894 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 27514 rows after removing duplicates.
2024-12-01 12:29:29,894 - ERROR - Starting cleaning for rates
2024-12-01 12:29:29,900 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:29:29,911 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:29:29,912 - INFO - Finished cleaning for rates
2024-12-01 12:29:29,912 - ERROR - Finished cleaning for rates
2024-12-01 12:29:30,055 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 12:29:30,056 - ERROR - Starting cleaning for categories
2024-12-01 12:29:30,061 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:29:30,072 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 12:29:30,073 - INFO - Finished cleaning for categories
2024-12-01 12:29:30,074 - ERROR - Finished cleaning for categories
2024-12-01 12:29:30,187 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 12:29:30,408 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 12:29:30,540 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 12:29:30,701 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 12:29:30,817 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 12:29:30,874 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 12:29:30,874 - INFO - Début des jointures et des transformations.
2024-12-01 12:29:30,925 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 12:29:32,661 - ERROR - Calcul des taxes en cours...
2024-12-01 12:29:32,662 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'id_taux', 'currency', 'ratetoeuro']
2024-12-01 12:29:32,663 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 12:29:32,663 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 12:29:32,664 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 12:29:32,704 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 12:29:32,844 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 12:29:33,712 - ERROR - Calcul du taux de taxe terminé
2024-12-01 12:29:33,759 - ERROR - Calcul du prix après remise terminé
2024-12-01 12:29:35,364 - ERROR - Nombre total de lignes : 2155.
2024-12-01 12:29:35,364 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 12:29:35,365 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 12:29:36,108 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 12:29:36,109 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 12:29:36,141 - ERROR - Détection des anomalies en cours...
2024-12-01 12:29:36,248 - ERROR - Détection des anomalies terminée.
2024-12-01 12:29:37,151 - ERROR - Total anomalies detected: 4
2024-12-01 12:29:37,152 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 12:29:37,506 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 12:29:39,064 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 12:29:39,064 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 12:29:39,489 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 12:29:39,562 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:29:39,562 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:29:39,616 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 12:29:39,616 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 12:29:39,732 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:29:39,733 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:29:43,783 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:29:43,783 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:29:44,051 - INFO - Data cleaning process completed.
2024-12-01 12:29:44,052 - INFO - Closing down clientserver connection
2024-12-01 12:31:33,812 - ERROR - Removed 0 duplicate rows
2024-12-01 12:31:33,827 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 12:31:33,828 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:31:33,828 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:31:34,300 - ERROR - Removed 0 duplicate rows
2024-12-01 12:31:34,303 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:31:34,303 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:31:34,692 - ERROR - Removed 0 duplicate rows
2024-12-01 12:31:34,695 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:31:34,695 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:31:35,066 - ERROR - Removed 0 duplicate rows
2024-12-01 12:31:35,067 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:31:35,068 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:31:35,415 - ERROR - Removed 0 duplicate rows
2024-12-01 12:31:35,416 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:31:35,417 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:31:36,126 - ERROR - Removed 0 duplicate rows
2024-12-01 12:31:36,127 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:31:36,128 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:31:36,470 - ERROR - Removed 0 duplicate rows
2024-12-01 12:31:36,471 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:31:36,472 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:31:36,472 - ERROR - Starting cleaning for transactions
2024-12-01 12:31:36,570 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:31:36,603 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 12:31:36,625 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:31:36,640 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 12:31:36,710 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 12:31:36,711 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 12:31:36,778 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:31:36,779 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:31:36,845 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:31:36,845 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:31:36,846 - INFO - Finished cleaning for transactions
2024-12-01 12:31:36,846 - ERROR - Finished cleaning for transactions
2024-12-01 12:31:37,073 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 12:31:37,074 - ERROR - Starting cleaning for clients
2024-12-01 12:31:37,112 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:31:37,125 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:31:37,142 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:31:37,144 - INFO - Finished cleaning for clients
2024-12-01 12:31:37,145 - ERROR - Finished cleaning for clients
2024-12-01 12:31:37,344 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 12:31:37,345 - ERROR - Starting cleaning for produits
2024-12-01 12:31:37,360 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:31:37,376 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:31:37,414 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 12:31:37,415 - INFO - Finished cleaning for produits
2024-12-01 12:31:37,416 - ERROR - Finished cleaning for produits
2024-12-01 12:31:37,613 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 12:31:37,614 - ERROR - Starting cleaning for magasins
2024-12-01 12:31:37,652 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:31:37,664 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:31:37,678 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:31:37,680 - INFO - Finished cleaning for magasins
2024-12-01 12:31:37,681 - ERROR - Finished cleaning for magasins
2024-12-01 12:31:37,833 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 12:31:37,834 - ERROR - Starting cleaning for exchange
2024-12-01 12:31:37,842 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:31:37,854 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:31:37,856 - INFO - Finished cleaning for exchange
2024-12-01 12:31:37,856 - ERROR - Finished cleaning for exchange
2024-12-01 12:31:38,156 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 27514 rows after removing duplicates.
2024-12-01 12:31:38,157 - ERROR - Starting cleaning for rates
2024-12-01 12:31:38,163 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:31:38,174 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:31:38,175 - INFO - Finished cleaning for rates
2024-12-01 12:31:38,175 - ERROR - Finished cleaning for rates
2024-12-01 12:31:38,336 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 12:31:38,337 - ERROR - Starting cleaning for categories
2024-12-01 12:31:38,342 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:31:38,354 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 12:31:38,355 - INFO - Finished cleaning for categories
2024-12-01 12:31:38,356 - ERROR - Finished cleaning for categories
2024-12-01 12:31:38,499 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 12:31:38,751 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 12:31:38,893 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 12:31:39,060 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 12:31:39,177 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 12:31:39,222 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 12:31:39,223 - INFO - Début des jointures et des transformations.
2024-12-01 12:31:39,283 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 12:31:40,561 - ERROR - Calcul des taxes en cours...
2024-12-01 12:31:40,562 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'id_taux', 'currency', 'ratetoeuro']
2024-12-01 12:31:40,564 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 12:31:40,564 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 12:31:40,564 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 12:31:40,613 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 12:31:40,773 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 12:31:41,714 - ERROR - Calcul du taux de taxe terminé
2024-12-01 12:31:41,759 - ERROR - Calcul du prix après remise terminé
2024-12-01 12:31:43,617 - ERROR - Nombre total de lignes : 2155.
2024-12-01 12:31:43,618 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 12:31:43,619 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 12:31:44,540 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 12:31:44,541 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 12:31:44,565 - ERROR - Détection des anomalies en cours...
2024-12-01 12:31:44,669 - ERROR - Détection des anomalies terminée.
2024-12-01 12:31:45,375 - ERROR - Total anomalies detected: 4
2024-12-01 12:31:45,375 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 12:31:45,771 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 12:31:47,500 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 12:31:47,500 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 12:31:47,947 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 12:31:48,036 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:31:48,037 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:31:48,094 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 12:31:48,095 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 12:31:48,199 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:31:48,200 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:31:51,940 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:31:51,940 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:31:52,271 - INFO - Data cleaning process completed.
2024-12-01 12:31:52,274 - INFO - Closing down clientserver connection
2024-12-01 12:34:12,918 - ERROR - Removed 0 duplicate rows
2024-12-01 12:34:12,932 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 12:34:12,933 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:34:12,934 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:34:13,331 - ERROR - Removed 0 duplicate rows
2024-12-01 12:34:13,333 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:34:13,333 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:34:13,720 - ERROR - Removed 0 duplicate rows
2024-12-01 12:34:13,722 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:34:13,722 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:34:14,122 - ERROR - Removed 0 duplicate rows
2024-12-01 12:34:14,123 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:34:14,124 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:34:14,437 - ERROR - Removed 0 duplicate rows
2024-12-01 12:34:14,438 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:34:14,439 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:34:14,885 - ERROR - Removed 0 duplicate rows
2024-12-01 12:34:14,887 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:34:14,888 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:34:15,254 - ERROR - Removed 0 duplicate rows
2024-12-01 12:34:15,255 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:34:15,256 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:34:15,257 - ERROR - Starting cleaning for transactions
2024-12-01 12:34:15,354 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:34:15,394 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 12:34:15,417 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:34:15,435 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 12:34:15,500 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 12:34:15,500 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 12:34:15,564 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:34:15,564 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:34:15,637 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:34:15,637 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:34:15,638 - INFO - Finished cleaning for transactions
2024-12-01 12:34:15,638 - ERROR - Finished cleaning for transactions
2024-12-01 12:34:15,870 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 12:34:15,872 - ERROR - Starting cleaning for clients
2024-12-01 12:34:15,914 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:34:15,926 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:34:15,940 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:34:15,941 - INFO - Finished cleaning for clients
2024-12-01 12:34:15,941 - ERROR - Finished cleaning for clients
2024-12-01 12:34:16,079 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 12:34:16,080 - ERROR - Starting cleaning for produits
2024-12-01 12:34:16,094 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:34:16,108 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:34:16,138 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 12:34:16,139 - INFO - Finished cleaning for produits
2024-12-01 12:34:16,139 - ERROR - Finished cleaning for produits
2024-12-01 12:34:16,308 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 12:34:16,309 - ERROR - Starting cleaning for magasins
2024-12-01 12:34:16,341 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:34:16,354 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:34:16,366 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:34:16,368 - INFO - Finished cleaning for magasins
2024-12-01 12:34:16,368 - ERROR - Finished cleaning for magasins
2024-12-01 12:34:16,482 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 12:34:16,483 - ERROR - Starting cleaning for exchange
2024-12-01 12:34:16,491 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:34:16,505 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:34:16,507 - INFO - Finished cleaning for exchange
2024-12-01 12:34:16,508 - ERROR - Finished cleaning for exchange
2024-12-01 12:34:16,759 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 27514 rows after removing duplicates.
2024-12-01 12:34:16,760 - ERROR - Starting cleaning for rates
2024-12-01 12:34:16,765 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:34:16,776 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:34:16,778 - INFO - Finished cleaning for rates
2024-12-01 12:34:16,778 - ERROR - Finished cleaning for rates
2024-12-01 12:34:16,917 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 12:34:16,918 - ERROR - Starting cleaning for categories
2024-12-01 12:34:16,924 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:34:16,933 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 12:34:16,934 - INFO - Finished cleaning for categories
2024-12-01 12:34:16,935 - ERROR - Finished cleaning for categories
2024-12-01 12:34:17,041 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 12:34:17,276 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 12:34:17,404 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 12:34:17,525 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 12:34:17,640 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 12:34:17,688 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 12:34:17,688 - INFO - Début des jointures et des transformations.
2024-12-01 12:34:17,740 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 12:34:19,012 - ERROR - Calcul des taxes en cours...
2024-12-01 12:34:19,014 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'id_taux', 'currency', 'ratetoeuro']
2024-12-01 12:34:19,015 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 12:34:19,016 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 12:34:19,016 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 12:34:19,055 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 12:34:19,201 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 12:34:20,098 - ERROR - Calcul du taux de taxe terminé
2024-12-01 12:34:20,145 - ERROR - Calcul du prix après remise terminé
2024-12-01 12:34:21,693 - ERROR - Nombre total de lignes : 2155.
2024-12-01 12:34:21,694 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 12:34:21,695 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 12:34:22,352 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 12:34:22,353 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 12:34:22,379 - ERROR - Détection des anomalies en cours...
2024-12-01 12:34:22,479 - ERROR - Détection des anomalies terminée.
2024-12-01 12:34:23,344 - ERROR - Total anomalies detected: 4
2024-12-01 12:34:23,345 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 12:34:23,697 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 12:34:25,252 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 12:34:25,252 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 12:34:25,675 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 12:34:25,748 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:34:25,749 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:34:25,798 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 12:34:25,799 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 12:34:25,900 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:34:25,900 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:34:29,371 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:34:29,371 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:34:29,818 - INFO - Data cleaning process completed.
2024-12-01 12:34:29,820 - INFO - Closing down clientserver connection
2024-12-01 12:35:11,568 - ERROR - Removed 0 duplicate rows
2024-12-01 12:35:11,584 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 12:35:11,585 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:35:11,586 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:35:12,122 - ERROR - Removed 0 duplicate rows
2024-12-01 12:35:12,124 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:35:12,125 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:35:12,528 - ERROR - Removed 0 duplicate rows
2024-12-01 12:35:12,530 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:35:12,530 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:35:12,897 - ERROR - Removed 0 duplicate rows
2024-12-01 12:35:12,899 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:35:12,900 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:35:13,210 - ERROR - Removed 0 duplicate rows
2024-12-01 12:35:13,211 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:35:13,211 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:35:13,903 - ERROR - Removed 0 duplicate rows
2024-12-01 12:35:13,905 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:35:13,905 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:35:14,319 - ERROR - Removed 0 duplicate rows
2024-12-01 12:35:14,322 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:35:14,323 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:35:14,323 - ERROR - Starting cleaning for transactions
2024-12-01 12:35:14,444 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:35:14,495 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 12:35:14,521 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:35:14,543 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 12:35:14,631 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 12:35:14,632 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 12:35:14,707 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:35:14,708 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:35:14,786 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:35:14,786 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:35:14,787 - INFO - Finished cleaning for transactions
2024-12-01 12:35:14,787 - ERROR - Finished cleaning for transactions
2024-12-01 12:35:15,067 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 12:35:15,068 - ERROR - Starting cleaning for clients
2024-12-01 12:35:15,114 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:35:15,127 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:35:15,141 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:35:15,143 - INFO - Finished cleaning for clients
2024-12-01 12:35:15,143 - ERROR - Finished cleaning for clients
2024-12-01 12:35:15,307 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 12:35:15,308 - ERROR - Starting cleaning for produits
2024-12-01 12:35:15,325 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:35:15,338 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:35:15,370 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 12:35:15,371 - INFO - Finished cleaning for produits
2024-12-01 12:35:15,371 - ERROR - Finished cleaning for produits
2024-12-01 12:35:15,555 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 12:35:15,556 - ERROR - Starting cleaning for magasins
2024-12-01 12:35:15,600 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:35:15,638 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:35:15,661 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:35:15,663 - INFO - Finished cleaning for magasins
2024-12-01 12:35:15,664 - ERROR - Finished cleaning for magasins
2024-12-01 12:35:15,784 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 12:35:15,785 - ERROR - Starting cleaning for exchange
2024-12-01 12:35:15,790 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:35:15,803 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:35:15,804 - INFO - Finished cleaning for exchange
2024-12-01 12:35:15,804 - ERROR - Finished cleaning for exchange
2024-12-01 12:35:16,062 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 27514 rows after removing duplicates.
2024-12-01 12:35:16,063 - ERROR - Starting cleaning for rates
2024-12-01 12:35:16,070 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:35:16,083 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:35:16,084 - INFO - Finished cleaning for rates
2024-12-01 12:35:16,085 - ERROR - Finished cleaning for rates
2024-12-01 12:35:16,240 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 12:35:16,241 - ERROR - Starting cleaning for categories
2024-12-01 12:35:16,246 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:35:16,257 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 12:35:16,258 - INFO - Finished cleaning for categories
2024-12-01 12:35:16,259 - ERROR - Finished cleaning for categories
2024-12-01 12:35:16,380 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 12:35:16,633 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 12:35:16,784 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 12:35:16,911 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 12:35:17,028 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 12:35:17,057 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 12:35:17,058 - INFO - Début des jointures et des transformations.
2024-12-01 12:35:17,110 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 12:35:18,642 - ERROR - Calcul des taxes en cours...
2024-12-01 12:35:18,643 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'id_taux', 'currency', 'ratetoeuro']
2024-12-01 12:35:18,644 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 12:35:18,645 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 12:35:18,645 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 12:35:18,690 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 12:35:18,868 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 12:35:19,867 - ERROR - Calcul du taux de taxe terminé
2024-12-01 12:35:19,913 - ERROR - Calcul du prix après remise terminé
2024-12-01 12:35:21,513 - ERROR - Nombre total de lignes : 2155.
2024-12-01 12:35:21,514 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 12:35:21,515 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 12:35:23,035 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 12:35:23,036 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 12:35:23,067 - ERROR - Détection des anomalies en cours...
2024-12-01 12:35:23,170 - ERROR - Détection des anomalies terminée.
2024-12-01 12:35:23,852 - ERROR - Total anomalies detected: 4
2024-12-01 12:35:23,852 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 12:35:24,205 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 12:35:25,696 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 12:35:25,697 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 12:35:26,092 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 12:35:26,164 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:35:26,164 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:35:26,215 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 12:35:26,215 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 12:35:26,321 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:35:26,321 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:35:30,327 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:35:30,327 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:35:30,883 - INFO - Data cleaning process completed.
2024-12-01 12:35:30,886 - INFO - Closing down clientserver connection
2024-12-01 12:46:01,941 - ERROR - Removed 0 duplicate rows
2024-12-01 12:46:01,956 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 12:46:01,957 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:46:01,957 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:46:02,387 - ERROR - Removed 0 duplicate rows
2024-12-01 12:46:02,389 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:46:02,389 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:46:02,774 - ERROR - Removed 0 duplicate rows
2024-12-01 12:46:02,776 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:46:02,776 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:46:03,178 - ERROR - Removed 0 duplicate rows
2024-12-01 12:46:03,180 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:46:03,180 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:46:03,478 - ERROR - Removed 0 duplicate rows
2024-12-01 12:46:03,480 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:46:03,481 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:46:04,003 - ERROR - Removed 0 duplicate rows
2024-12-01 12:46:04,004 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:46:04,006 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:46:04,383 - ERROR - Removed 0 duplicate rows
2024-12-01 12:46:04,385 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:46:04,385 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:46:04,386 - ERROR - Starting cleaning for transactions
2024-12-01 12:46:04,484 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:46:04,522 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 12:46:04,548 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:46:04,569 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 12:46:04,648 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 12:46:04,648 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 12:46:04,716 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:46:04,717 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:46:04,789 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:46:04,789 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:46:04,790 - INFO - Finished cleaning for transactions
2024-12-01 12:46:04,790 - ERROR - Finished cleaning for transactions
2024-12-01 12:46:05,021 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 12:46:05,022 - ERROR - Starting cleaning for clients
2024-12-01 12:46:05,060 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:46:05,074 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:46:05,089 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:46:05,091 - INFO - Finished cleaning for clients
2024-12-01 12:46:05,091 - ERROR - Finished cleaning for clients
2024-12-01 12:46:05,239 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 12:46:05,240 - ERROR - Starting cleaning for produits
2024-12-01 12:46:05,254 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:46:05,270 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:46:05,302 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 12:46:05,304 - INFO - Finished cleaning for produits
2024-12-01 12:46:05,304 - ERROR - Finished cleaning for produits
2024-12-01 12:46:05,448 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 12:46:05,449 - ERROR - Starting cleaning for magasins
2024-12-01 12:46:05,481 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:46:05,496 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:46:05,530 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:46:05,533 - INFO - Finished cleaning for magasins
2024-12-01 12:46:05,533 - ERROR - Finished cleaning for magasins
2024-12-01 12:46:05,653 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 12:46:05,654 - ERROR - Starting cleaning for exchange
2024-12-01 12:46:05,661 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:46:05,672 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:46:05,674 - INFO - Finished cleaning for exchange
2024-12-01 12:46:05,674 - ERROR - Finished cleaning for exchange
2024-12-01 12:46:05,951 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 41648 rows after removing duplicates.
2024-12-01 12:46:05,952 - ERROR - Starting cleaning for rates
2024-12-01 12:46:05,957 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:46:05,969 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:46:05,971 - INFO - Finished cleaning for rates
2024-12-01 12:46:05,971 - ERROR - Finished cleaning for rates
2024-12-01 12:46:06,116 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 12:46:06,117 - ERROR - Starting cleaning for categories
2024-12-01 12:46:06,122 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:46:06,133 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 12:46:06,134 - INFO - Finished cleaning for categories
2024-12-01 12:46:06,134 - ERROR - Finished cleaning for categories
2024-12-01 12:46:06,242 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 12:46:06,456 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 12:46:06,614 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 12:46:06,750 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 12:46:06,875 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 12:46:06,913 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 12:46:06,913 - INFO - Début des jointures et des transformations.
2024-12-01 12:46:06,961 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 12:46:08,273 - ERROR - Calcul des taxes en cours...
2024-12-01 12:46:08,275 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'id_taux', 'currency', 'ratetoeuro']
2024-12-01 12:46:08,276 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 12:46:08,276 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 12:46:08,277 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 12:46:08,318 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 12:46:08,481 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 12:46:09,402 - ERROR - Calcul du taux de taxe terminé
2024-12-01 12:46:09,455 - ERROR - Calcul du prix après remise terminé
2024-12-01 12:46:11,024 - ERROR - Nombre total de lignes : 2155.
2024-12-01 12:46:11,024 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 12:46:11,025 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 12:46:11,993 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 12:46:11,994 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 12:46:12,034 - ERROR - Détection des anomalies en cours...
2024-12-01 12:46:12,202 - ERROR - Détection des anomalies terminée.
2024-12-01 12:46:12,939 - ERROR - Total anomalies detected: 4
2024-12-01 12:46:12,940 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 12:46:13,307 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 12:46:14,958 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 12:46:14,958 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 12:46:15,373 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 12:46:15,442 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:46:15,443 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:46:15,527 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 12:46:15,528 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 12:46:15,639 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:46:15,639 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:46:19,342 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:46:19,342 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:46:19,816 - INFO - Data cleaning process completed.
2024-12-01 12:46:19,818 - INFO - Closing down clientserver connection
2024-12-01 12:49:26,598 - ERROR - Removed 0 duplicate rows
2024-12-01 12:49:26,610 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 12:49:26,611 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:49:26,611 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:49:27,071 - ERROR - Removed 0 duplicate rows
2024-12-01 12:49:27,073 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:49:27,073 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:49:27,423 - ERROR - Removed 0 duplicate rows
2024-12-01 12:49:27,426 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:49:27,426 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:49:27,837 - ERROR - Removed 0 duplicate rows
2024-12-01 12:49:27,838 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:49:27,839 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:49:28,158 - ERROR - Removed 0 duplicate rows
2024-12-01 12:49:28,160 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:49:28,161 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:49:28,717 - ERROR - Removed 0 duplicate rows
2024-12-01 12:49:28,718 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:49:28,719 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:49:29,093 - ERROR - Removed 0 duplicate rows
2024-12-01 12:49:29,094 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:49:29,095 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:49:29,095 - ERROR - Starting cleaning for transactions
2024-12-01 12:49:29,189 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:49:29,229 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 12:49:29,253 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:49:29,273 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 12:49:29,356 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 12:49:29,356 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 12:49:29,429 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:49:29,429 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:49:29,490 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:49:29,491 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:49:29,491 - INFO - Finished cleaning for transactions
2024-12-01 12:49:29,492 - ERROR - Finished cleaning for transactions
2024-12-01 12:49:29,726 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 12:49:29,727 - ERROR - Starting cleaning for clients
2024-12-01 12:49:29,764 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:49:29,779 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:49:29,792 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:49:29,793 - INFO - Finished cleaning for clients
2024-12-01 12:49:29,794 - ERROR - Finished cleaning for clients
2024-12-01 12:49:29,927 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 12:49:29,928 - ERROR - Starting cleaning for produits
2024-12-01 12:49:29,943 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:49:29,956 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:49:29,985 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 12:49:29,986 - INFO - Finished cleaning for produits
2024-12-01 12:49:29,986 - ERROR - Finished cleaning for produits
2024-12-01 12:49:30,126 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 12:49:30,126 - ERROR - Starting cleaning for magasins
2024-12-01 12:49:30,161 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:49:30,175 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:49:30,190 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:49:30,191 - INFO - Finished cleaning for magasins
2024-12-01 12:49:30,191 - ERROR - Finished cleaning for magasins
2024-12-01 12:49:30,346 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 12:49:30,347 - ERROR - Starting cleaning for exchange
2024-12-01 12:49:30,354 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:49:30,366 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:49:30,368 - INFO - Finished cleaning for exchange
2024-12-01 12:49:30,368 - ERROR - Finished cleaning for exchange
2024-12-01 12:49:30,626 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 41648 rows after removing duplicates.
2024-12-01 12:49:30,627 - ERROR - Starting cleaning for rates
2024-12-01 12:49:30,633 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:49:30,645 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:49:30,646 - INFO - Finished cleaning for rates
2024-12-01 12:49:30,646 - ERROR - Finished cleaning for rates
2024-12-01 12:49:30,789 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 12:49:30,790 - ERROR - Starting cleaning for categories
2024-12-01 12:49:30,794 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:49:30,806 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 12:49:30,807 - INFO - Finished cleaning for categories
2024-12-01 12:49:30,807 - ERROR - Finished cleaning for categories
2024-12-01 12:49:30,922 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 12:49:31,128 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 12:49:31,288 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 12:49:31,439 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 12:49:31,553 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 12:49:31,597 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 12:49:31,597 - INFO - Début des jointures et des transformations.
2024-12-01 12:49:31,644 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 12:49:32,936 - ERROR - Calcul des taxes en cours...
2024-12-01 12:49:32,938 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'id_taux', 'currency', 'ratetoeuro']
2024-12-01 12:49:32,939 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 12:49:32,940 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 12:49:32,940 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 12:49:32,981 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 12:49:33,130 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 12:49:34,023 - ERROR - Calcul du taux de taxe terminé
2024-12-01 12:49:34,067 - ERROR - Calcul du prix après remise terminé
2024-12-01 12:49:35,938 - ERROR - Nombre total de lignes : 2155.
2024-12-01 12:49:35,939 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 12:49:35,940 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 12:49:36,869 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 12:49:36,871 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 12:49:36,908 - ERROR - Détection des anomalies en cours...
2024-12-01 12:49:37,024 - ERROR - Détection des anomalies terminée.
2024-12-01 12:49:37,734 - ERROR - Total anomalies detected: 4
2024-12-01 12:49:37,734 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 12:49:38,092 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 12:49:39,640 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 12:49:39,640 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 12:49:40,087 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 12:49:40,165 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:49:40,165 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:49:40,215 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 12:49:40,215 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 12:49:40,328 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:49:40,328 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:49:44,054 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:49:44,055 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:49:44,429 - INFO - Data cleaning process completed.
2024-12-01 12:49:44,432 - INFO - Closing down clientserver connection
2024-12-01 12:50:28,108 - ERROR - Removed 0 duplicate rows
2024-12-01 12:50:28,123 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 12:50:28,125 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:50:28,125 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:50:28,575 - ERROR - Removed 0 duplicate rows
2024-12-01 12:50:28,578 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:50:28,579 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:50:28,956 - ERROR - Removed 0 duplicate rows
2024-12-01 12:50:28,958 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:50:28,958 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:50:29,309 - ERROR - Removed 0 duplicate rows
2024-12-01 12:50:29,311 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:50:29,312 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:50:29,616 - ERROR - Removed 0 duplicate rows
2024-12-01 12:50:29,618 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:50:29,619 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:50:30,168 - ERROR - Removed 0 duplicate rows
2024-12-01 12:50:30,169 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:50:30,170 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:50:30,521 - ERROR - Removed 0 duplicate rows
2024-12-01 12:50:30,523 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:50:30,523 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:50:30,524 - ERROR - Starting cleaning for transactions
2024-12-01 12:50:30,623 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:50:30,660 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 12:50:30,684 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:50:30,701 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 12:50:30,769 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 12:50:30,769 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 12:50:30,830 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:50:30,830 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:50:30,891 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:50:30,891 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:50:30,892 - INFO - Finished cleaning for transactions
2024-12-01 12:50:30,892 - ERROR - Finished cleaning for transactions
2024-12-01 12:50:31,117 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 12:50:31,118 - ERROR - Starting cleaning for clients
2024-12-01 12:50:31,159 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:50:31,169 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:50:31,182 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:50:31,183 - INFO - Finished cleaning for clients
2024-12-01 12:50:31,184 - ERROR - Finished cleaning for clients
2024-12-01 12:50:31,329 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 12:50:31,330 - ERROR - Starting cleaning for produits
2024-12-01 12:50:31,347 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:50:31,360 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:50:31,393 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 12:50:31,395 - INFO - Finished cleaning for produits
2024-12-01 12:50:31,395 - ERROR - Finished cleaning for produits
2024-12-01 12:50:31,568 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 12:50:31,568 - ERROR - Starting cleaning for magasins
2024-12-01 12:50:31,613 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:50:31,627 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:50:31,642 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:50:31,643 - INFO - Finished cleaning for magasins
2024-12-01 12:50:31,643 - ERROR - Finished cleaning for magasins
2024-12-01 12:50:31,766 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 12:50:31,767 - ERROR - Starting cleaning for exchange
2024-12-01 12:50:31,773 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:50:31,785 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:50:31,787 - INFO - Finished cleaning for exchange
2024-12-01 12:50:31,787 - ERROR - Finished cleaning for exchange
2024-12-01 12:50:32,055 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 41648 rows after removing duplicates.
2024-12-01 12:50:32,056 - ERROR - Starting cleaning for rates
2024-12-01 12:50:32,061 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:50:32,071 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:50:32,072 - INFO - Finished cleaning for rates
2024-12-01 12:50:32,072 - ERROR - Finished cleaning for rates
2024-12-01 12:50:32,215 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 12:50:32,216 - ERROR - Starting cleaning for categories
2024-12-01 12:50:32,221 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:50:32,232 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 12:50:32,233 - INFO - Finished cleaning for categories
2024-12-01 12:50:32,233 - ERROR - Finished cleaning for categories
2024-12-01 12:50:32,343 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 12:50:32,566 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 12:50:32,699 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 12:50:32,820 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 12:50:32,965 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 12:50:33,004 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 12:50:33,005 - INFO - Début des jointures et des transformations.
2024-12-01 12:50:33,052 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 12:50:34,486 - ERROR - Calcul des taxes en cours...
2024-12-01 12:50:34,488 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'id_taux', 'currency', 'ratetoeuro']
2024-12-01 12:50:34,489 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 12:50:34,489 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 12:50:34,490 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 12:50:34,532 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 12:50:34,685 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 12:50:35,614 - ERROR - Calcul du taux de taxe terminé
2024-12-01 12:50:35,655 - ERROR - Calcul du prix après remise terminé
2024-12-01 12:50:37,406 - ERROR - Nombre total de lignes : 2155.
2024-12-01 12:50:37,407 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 12:50:37,407 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 12:50:38,063 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 12:50:38,064 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 12:50:38,092 - ERROR - Détection des anomalies en cours...
2024-12-01 12:50:38,187 - ERROR - Détection des anomalies terminée.
2024-12-01 12:50:38,922 - ERROR - Total anomalies detected: 4
2024-12-01 12:50:38,922 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 12:50:39,255 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 12:50:40,708 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 12:50:40,709 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 12:50:41,107 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 12:50:41,172 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:50:41,173 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:50:41,220 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 12:50:41,220 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 12:50:41,319 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:50:41,320 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:50:44,947 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:50:44,947 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:50:45,413 - INFO - Data cleaning process completed.
2024-12-01 12:50:45,415 - INFO - Closing down clientserver connection
2024-12-01 12:51:49,465 - ERROR - Removed 0 duplicate rows
2024-12-01 12:51:49,478 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 12:51:49,479 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:51:49,479 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:51:49,981 - ERROR - Removed 0 duplicate rows
2024-12-01 12:51:49,982 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:51:49,983 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:51:50,362 - ERROR - Removed 0 duplicate rows
2024-12-01 12:51:50,364 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:51:50,365 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:51:50,713 - ERROR - Removed 0 duplicate rows
2024-12-01 12:51:50,714 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:51:50,715 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:51:51,049 - ERROR - Removed 0 duplicate rows
2024-12-01 12:51:51,050 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:51:51,051 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:51:51,572 - ERROR - Removed 0 duplicate rows
2024-12-01 12:51:51,574 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:51:51,574 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:51:51,908 - ERROR - Removed 0 duplicate rows
2024-12-01 12:51:51,910 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 12:51:51,910 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 12:51:51,911 - ERROR - Starting cleaning for transactions
2024-12-01 12:51:52,013 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:51:52,045 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 12:51:52,069 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:51:52,087 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 12:51:52,152 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 12:51:52,153 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 12:51:52,214 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:51:52,215 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 12:51:52,282 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:51:52,282 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 12:51:52,283 - INFO - Finished cleaning for transactions
2024-12-01 12:51:52,283 - ERROR - Finished cleaning for transactions
2024-12-01 12:51:52,523 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 12:51:52,524 - ERROR - Starting cleaning for clients
2024-12-01 12:51:52,562 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:51:52,575 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:51:52,589 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:51:52,591 - INFO - Finished cleaning for clients
2024-12-01 12:51:52,591 - ERROR - Finished cleaning for clients
2024-12-01 12:51:52,769 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 12:51:52,769 - ERROR - Starting cleaning for produits
2024-12-01 12:51:52,785 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:51:52,798 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 12:51:52,824 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 12:51:52,826 - INFO - Finished cleaning for produits
2024-12-01 12:51:52,826 - ERROR - Finished cleaning for produits
2024-12-01 12:51:52,961 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 12:51:52,962 - ERROR - Starting cleaning for magasins
2024-12-01 12:51:52,993 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:51:53,007 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 12:51:53,019 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:51:53,020 - INFO - Finished cleaning for magasins
2024-12-01 12:51:53,020 - ERROR - Finished cleaning for magasins
2024-12-01 12:51:53,133 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 12:51:53,133 - ERROR - Starting cleaning for exchange
2024-12-01 12:51:53,139 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:51:53,154 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:51:53,156 - INFO - Finished cleaning for exchange
2024-12-01 12:51:53,156 - ERROR - Finished cleaning for exchange
2024-12-01 12:51:53,416 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 41648 rows after removing duplicates.
2024-12-01 12:51:53,417 - ERROR - Starting cleaning for rates
2024-12-01 12:51:53,422 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:51:53,434 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 12:51:53,435 - INFO - Finished cleaning for rates
2024-12-01 12:51:53,435 - ERROR - Finished cleaning for rates
2024-12-01 12:51:53,578 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 12:51:53,578 - ERROR - Starting cleaning for categories
2024-12-01 12:51:53,583 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 12:51:53,594 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 12:51:53,595 - INFO - Finished cleaning for categories
2024-12-01 12:51:53,596 - ERROR - Finished cleaning for categories
2024-12-01 12:51:53,708 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 12:51:53,942 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 12:51:54,078 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 12:51:54,197 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 12:51:54,316 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 12:51:54,359 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 12:51:54,360 - INFO - Début des jointures et des transformations.
2024-12-01 12:51:54,406 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 12:51:55,738 - ERROR - Calcul des taxes en cours...
2024-12-01 12:51:55,740 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'id_taux', 'currency', 'ratetoeuro']
2024-12-01 12:51:55,741 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 12:51:55,741 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 12:51:55,741 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 12:51:55,778 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 12:51:55,944 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 12:51:56,844 - ERROR - Calcul du taux de taxe terminé
2024-12-01 12:51:56,892 - ERROR - Calcul du prix après remise terminé
2024-12-01 12:51:58,631 - ERROR - Nombre total de lignes : 2155.
2024-12-01 12:51:58,632 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 12:51:58,632 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 12:51:59,278 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 12:51:59,279 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 12:51:59,302 - ERROR - Détection des anomalies en cours...
2024-12-01 12:51:59,396 - ERROR - Détection des anomalies terminée.
2024-12-01 12:52:00,127 - ERROR - Total anomalies detected: 4
2024-12-01 12:52:00,128 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 12:52:00,519 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 12:52:02,085 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 12:52:02,085 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 12:52:02,663 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 12:52:02,744 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:52:02,744 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:52:02,803 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 12:52:02,803 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 12:52:02,917 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 12:52:02,918 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 12:52:06,948 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:52:06,949 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 12:52:07,504 - INFO - Data cleaning process completed.
2024-12-01 12:52:07,507 - INFO - Closing down clientserver connection
2024-12-01 13:24:27,451 - ERROR - Removed 0 duplicate rows
2024-12-01 13:24:27,480 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 13:24:27,481 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 13:24:27,482 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 13:24:27,947 - ERROR - Removed 0 duplicate rows
2024-12-01 13:24:27,949 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 13:24:27,950 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 13:24:28,376 - ERROR - Removed 0 duplicate rows
2024-12-01 13:24:28,386 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 13:24:28,386 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 13:24:28,788 - ERROR - Removed 0 duplicate rows
2024-12-01 13:24:28,800 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 13:24:28,800 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 13:24:29,101 - ERROR - Removed 0 duplicate rows
2024-12-01 13:24:29,103 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 13:24:29,103 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 13:24:29,628 - ERROR - Removed 0 duplicate rows
2024-12-01 13:24:29,628 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 13:24:29,643 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 13:24:30,079 - ERROR - Removed 0 duplicate rows
2024-12-01 13:24:30,081 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 13:24:30,083 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 13:24:30,083 - ERROR - Starting cleaning for transactions
2024-12-01 13:24:30,230 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 13:24:30,273 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 13:24:30,298 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 13:24:30,319 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 13:24:30,399 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 13:24:30,399 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 13:24:30,480 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 13:24:30,480 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 13:24:30,557 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 13:24:30,558 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 13:24:30,558 - INFO - Finished cleaning for transactions
2024-12-01 13:24:30,558 - ERROR - Finished cleaning for transactions
2024-12-01 13:24:30,840 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 13:24:30,840 - ERROR - Starting cleaning for clients
2024-12-01 13:24:30,901 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 13:24:30,921 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 13:24:30,937 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 13:24:30,939 - INFO - Finished cleaning for clients
2024-12-01 13:24:30,939 - ERROR - Finished cleaning for clients
2024-12-01 13:24:31,085 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 13:24:31,085 - ERROR - Starting cleaning for produits
2024-12-01 13:24:31,112 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 13:24:31,123 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 13:24:31,160 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 13:24:31,162 - INFO - Finished cleaning for produits
2024-12-01 13:24:31,163 - ERROR - Finished cleaning for produits
2024-12-01 13:24:31,309 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 13:24:31,310 - ERROR - Starting cleaning for magasins
2024-12-01 13:24:31,345 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 13:24:31,357 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 13:24:31,369 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 13:24:31,370 - INFO - Finished cleaning for magasins
2024-12-01 13:24:31,371 - ERROR - Finished cleaning for magasins
2024-12-01 13:24:31,489 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 13:24:31,489 - ERROR - Starting cleaning for exchange
2024-12-01 13:24:31,512 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 13:24:31,531 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 13:24:31,532 - INFO - Finished cleaning for exchange
2024-12-01 13:24:31,533 - ERROR - Finished cleaning for exchange
2024-12-01 13:24:31,834 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 27132 rows after removing duplicates.
2024-12-01 13:24:31,834 - ERROR - Starting cleaning for rates
2024-12-01 13:24:31,844 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 13:24:31,855 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 13:24:31,856 - INFO - Finished cleaning for rates
2024-12-01 13:24:31,856 - ERROR - Finished cleaning for rates
2024-12-01 13:24:32,040 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 13:24:32,041 - ERROR - Starting cleaning for categories
2024-12-01 13:24:32,047 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 13:24:32,060 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 13:24:32,061 - INFO - Finished cleaning for categories
2024-12-01 13:24:32,061 - ERROR - Finished cleaning for categories
2024-12-01 13:24:32,194 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 13:24:32,453 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 13:24:32,630 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 13:24:32,770 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 13:24:32,901 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 13:24:32,937 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 13:24:32,938 - INFO - Début des jointures et des transformations.
2024-12-01 13:24:32,993 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 13:24:34,313 - ERROR - Calcul des taxes en cours...
2024-12-01 13:24:34,314 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'id_taux', 'currency', 'ratetoeuro']
2024-12-01 13:24:34,316 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 13:24:34,317 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 13:24:34,317 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 13:24:34,366 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 13:24:34,551 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 13:24:35,469 - ERROR - Calcul du taux de taxe terminé
2024-12-01 13:24:35,519 - ERROR - Calcul du prix après remise terminé
2024-12-01 13:24:37,173 - ERROR - Nombre total de lignes : 2155.
2024-12-01 13:24:37,174 - ERROR - Nombre de taux de change manquants : 1068.
2024-12-01 13:24:37,175 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 13:24:37,868 - ERROR - Nombre de devises manquantes : 1054.
2024-12-01 13:24:37,868 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 13:24:37,907 - ERROR - Détection des anomalies en cours...
2024-12-01 13:24:38,015 - ERROR - Détection des anomalies terminée.
2024-12-01 13:24:38,634 - ERROR - Total anomalies detected: 4
2024-12-01 13:24:38,634 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 13:24:38,988 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 13:24:40,734 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 13:24:40,734 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 13:24:41,150 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 13:24:41,218 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 13:24:41,218 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 13:24:41,286 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 13:24:41,286 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 13:24:41,410 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 13:24:41,410 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 13:24:45,286 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 13:24:45,286 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 13:24:45,460 - INFO - Data cleaning process completed.
2024-12-01 13:24:45,462 - INFO - Closing down clientserver connection
2024-12-01 14:10:54,975 - ERROR - Removed 0 duplicate rows
2024-12-01 14:10:55,004 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 14:10:55,005 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 14:10:55,006 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 14:10:55,473 - ERROR - Removed 0 duplicate rows
2024-12-01 14:10:55,476 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 14:10:55,476 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 14:10:55,833 - ERROR - Removed 0 duplicate rows
2024-12-01 14:10:55,844 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 14:10:55,844 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 14:10:56,190 - ERROR - Removed 0 duplicate rows
2024-12-01 14:10:56,198 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 14:10:56,198 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 14:10:56,530 - ERROR - Removed 0 duplicate rows
2024-12-01 14:10:56,532 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 14:10:56,533 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 14:10:57,033 - ERROR - Removed 0 duplicate rows
2024-12-01 14:10:57,043 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 14:10:57,044 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 14:10:57,386 - ERROR - Removed 0 duplicate rows
2024-12-01 14:10:57,387 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 14:10:57,388 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 14:10:57,388 - ERROR - Starting cleaning for transactions
2024-12-01 14:10:57,487 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 14:10:57,528 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 14:10:57,553 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 14:10:57,573 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 14:10:57,648 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 14:10:57,649 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 14:10:57,720 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 14:10:57,720 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 14:10:57,789 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 14:10:57,789 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 14:10:57,790 - INFO - Finished cleaning for transactions
2024-12-01 14:10:57,790 - ERROR - Finished cleaning for transactions
2024-12-01 14:10:58,015 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 14:10:58,030 - ERROR - Starting cleaning for clients
2024-12-01 14:10:58,070 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 14:10:58,086 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 14:10:58,100 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 14:10:58,102 - INFO - Finished cleaning for clients
2024-12-01 14:10:58,102 - ERROR - Finished cleaning for clients
2024-12-01 14:10:58,290 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 14:10:58,291 - ERROR - Starting cleaning for produits
2024-12-01 14:10:58,308 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 14:10:58,323 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 14:10:58,351 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 14:10:58,352 - INFO - Finished cleaning for produits
2024-12-01 14:10:58,352 - ERROR - Finished cleaning for produits
2024-12-01 14:10:58,488 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 14:10:58,488 - ERROR - Starting cleaning for magasins
2024-12-01 14:10:58,531 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 14:10:58,544 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 14:10:58,555 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 14:10:58,556 - INFO - Finished cleaning for magasins
2024-12-01 14:10:58,556 - ERROR - Finished cleaning for magasins
2024-12-01 14:10:58,677 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 14:10:58,678 - ERROR - Starting cleaning for exchange
2024-12-01 14:10:58,684 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 14:10:58,698 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 14:10:58,699 - INFO - Finished cleaning for exchange
2024-12-01 14:10:58,699 - ERROR - Finished cleaning for exchange
2024-12-01 14:10:58,965 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 28130 rows after removing duplicates.
2024-12-01 14:10:58,965 - ERROR - Starting cleaning for rates
2024-12-01 14:10:58,971 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 14:10:58,976 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 14:10:58,976 - INFO - Finished cleaning for rates
2024-12-01 14:10:58,976 - ERROR - Finished cleaning for rates
2024-12-01 14:10:59,124 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 14:10:59,124 - ERROR - Starting cleaning for categories
2024-12-01 14:10:59,133 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 14:10:59,144 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 14:10:59,145 - INFO - Finished cleaning for categories
2024-12-01 14:10:59,145 - ERROR - Finished cleaning for categories
2024-12-01 14:10:59,244 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 14:10:59,471 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 14:10:59,615 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 14:10:59,741 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 14:10:59,868 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 14:10:59,898 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 14:10:59,899 - INFO - Début des jointures et des transformations.
2024-12-01 14:10:59,951 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 14:11:00,067 - ERROR - Erreur lors de la transformation et de la sauvegarde des données : [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `id_taux` cannot be resolved. Did you mean one of the following? [`ID_taxe`, `date`, `ratetoeuro`, `Country`, `currency`].
2024-12-01 14:11:00,074 - ERROR - Erreur lors de la transformation et de la sauvegarde des données : [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `id_taux` cannot be resolved. Did you mean one of the following? [`ID_taxe`, `date`, `ratetoeuro`, `Country`, `currency`].
2024-12-01 14:11:00,167 - INFO - Data cleaning process completed.
2024-12-01 14:11:00,169 - INFO - Closing down clientserver connection
2024-12-01 14:23:02,349 - ERROR - Removed 0 duplicate rows
2024-12-01 14:23:02,362 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 14:23:02,362 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 14:23:02,362 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 14:23:02,813 - ERROR - Removed 0 duplicate rows
2024-12-01 14:23:02,816 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 14:23:02,816 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 14:23:03,160 - ERROR - Removed 0 duplicate rows
2024-12-01 14:23:03,175 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 14:23:03,175 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 14:23:03,521 - ERROR - Removed 0 duplicate rows
2024-12-01 14:23:03,521 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 14:23:03,523 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 14:23:03,796 - ERROR - Removed 0 duplicate rows
2024-12-01 14:23:03,811 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 14:23:03,813 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 14:23:04,315 - ERROR - Removed 0 duplicate rows
2024-12-01 14:23:04,315 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 14:23:04,325 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 14:23:04,661 - ERROR - Removed 0 duplicate rows
2024-12-01 14:23:04,661 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 14:23:04,677 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 14:23:04,677 - ERROR - Starting cleaning for transactions
2024-12-01 14:23:04,769 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 14:23:04,816 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 14:23:04,835 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 14:23:04,853 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 14:23:04,909 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 14:23:04,909 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 14:23:04,981 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 14:23:04,981 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 14:23:05,045 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 14:23:05,046 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 14:23:05,046 - INFO - Finished cleaning for transactions
2024-12-01 14:23:05,047 - ERROR - Finished cleaning for transactions
2024-12-01 14:23:05,274 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 14:23:05,274 - ERROR - Starting cleaning for clients
2024-12-01 14:23:05,325 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 14:23:05,337 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 14:23:05,350 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 14:23:05,352 - INFO - Finished cleaning for clients
2024-12-01 14:23:05,352 - ERROR - Finished cleaning for clients
2024-12-01 14:23:05,479 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 14:23:05,479 - ERROR - Starting cleaning for produits
2024-12-01 14:23:05,506 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 14:23:05,518 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 14:23:05,552 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 14:23:05,553 - INFO - Finished cleaning for produits
2024-12-01 14:23:05,553 - ERROR - Finished cleaning for produits
2024-12-01 14:23:05,722 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 14:23:05,722 - ERROR - Starting cleaning for magasins
2024-12-01 14:23:05,763 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 14:23:05,776 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 14:23:05,788 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 14:23:05,789 - INFO - Finished cleaning for magasins
2024-12-01 14:23:05,789 - ERROR - Finished cleaning for magasins
2024-12-01 14:23:05,905 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 14:23:05,905 - ERROR - Starting cleaning for exchange
2024-12-01 14:23:05,915 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 14:23:05,926 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 14:23:05,926 - INFO - Finished cleaning for exchange
2024-12-01 14:23:05,926 - ERROR - Finished cleaning for exchange
2024-12-01 14:23:06,165 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 28130 rows after removing duplicates.
2024-12-01 14:23:06,165 - ERROR - Starting cleaning for rates
2024-12-01 14:23:06,187 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 14:23:06,197 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 14:23:06,199 - INFO - Finished cleaning for rates
2024-12-01 14:23:06,199 - ERROR - Finished cleaning for rates
2024-12-01 14:23:06,319 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 14:23:06,335 - ERROR - Starting cleaning for categories
2024-12-01 14:23:06,339 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 14:23:06,343 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 14:23:06,352 - INFO - Finished cleaning for categories
2024-12-01 14:23:06,352 - ERROR - Finished cleaning for categories
2024-12-01 14:23:06,443 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 14:23:06,690 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 14:23:06,840 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 14:23:06,956 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 14:23:07,099 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 14:23:07,143 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 14:23:07,143 - INFO - Début des jointures et des transformations.
2024-12-01 14:23:07,196 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 14:23:08,413 - ERROR - Calcul des taxes en cours...
2024-12-01 14:23:08,415 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'ID_taux', 'currency', 'ratetoeuro']
2024-12-01 14:23:08,416 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 14:23:08,416 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 14:23:08,416 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 14:23:08,467 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 14:23:08,628 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 14:23:09,442 - ERROR - Calcul du taux de taxe terminé
2024-12-01 14:23:09,490 - ERROR - Calcul du prix après remise terminé
2024-12-01 14:23:11,162 - ERROR - Nombre total de lignes : 2155.
2024-12-01 14:23:11,162 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 14:23:11,178 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 14:23:11,805 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 14:23:11,805 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 14:23:11,828 - ERROR - Détection des anomalies en cours...
2024-12-01 14:23:11,921 - ERROR - Détection des anomalies terminée.
2024-12-01 14:23:12,515 - ERROR - Total anomalies detected: 4
2024-12-01 14:23:12,515 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 14:23:12,838 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 14:23:14,322 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 14:23:14,322 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 14:23:14,804 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 14:23:14,878 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 14:23:14,878 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 14:23:14,930 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 14:23:14,930 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 14:23:15,027 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 14:23:15,027 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 14:23:18,313 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 14:23:18,313 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 14:23:18,826 - INFO - Data cleaning process completed.
2024-12-01 14:23:18,834 - INFO - Closing down clientserver connection
2024-12-01 15:02:05,676 - ERROR - Removed 0 duplicate rows
2024-12-01 15:02:05,690 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 15:02:05,691 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:02:05,691 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:02:06,151 - ERROR - Removed 0 duplicate rows
2024-12-01 15:02:06,153 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:02:06,154 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:02:06,522 - ERROR - Removed 0 duplicate rows
2024-12-01 15:02:06,534 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:02:06,534 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:02:06,852 - ERROR - Removed 0 duplicate rows
2024-12-01 15:02:06,852 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:02:06,864 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:02:07,157 - ERROR - Removed 0 duplicate rows
2024-12-01 15:02:07,159 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:02:07,159 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:02:07,660 - ERROR - Removed 0 duplicate rows
2024-12-01 15:02:07,661 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:02:07,662 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:02:07,984 - ERROR - Removed 0 duplicate rows
2024-12-01 15:02:07,984 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:02:07,995 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:02:07,995 - ERROR - Starting cleaning for transactions
2024-12-01 15:02:08,093 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:02:08,132 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 15:02:08,156 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:02:08,174 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 15:02:08,237 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 15:02:08,237 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 15:02:08,306 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:02:08,307 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:02:08,371 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:02:08,371 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:02:08,371 - INFO - Finished cleaning for transactions
2024-12-01 15:02:08,372 - ERROR - Finished cleaning for transactions
2024-12-01 15:02:08,595 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 15:02:08,595 - ERROR - Starting cleaning for clients
2024-12-01 15:02:08,638 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:02:08,653 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:02:08,670 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:02:08,671 - INFO - Finished cleaning for clients
2024-12-01 15:02:08,672 - ERROR - Finished cleaning for clients
2024-12-01 15:02:08,808 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 15:02:08,808 - ERROR - Starting cleaning for produits
2024-12-01 15:02:08,830 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:02:08,845 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:02:08,876 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 15:02:08,878 - INFO - Finished cleaning for produits
2024-12-01 15:02:08,878 - ERROR - Finished cleaning for produits
2024-12-01 15:02:09,046 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 15:02:09,046 - ERROR - Starting cleaning for magasins
2024-12-01 15:02:09,087 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:02:09,100 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:02:09,113 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:02:09,115 - INFO - Finished cleaning for magasins
2024-12-01 15:02:09,115 - ERROR - Finished cleaning for magasins
2024-12-01 15:02:09,221 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 15:02:09,221 - ERROR - Starting cleaning for exchange
2024-12-01 15:02:09,236 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:02:09,249 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:02:09,251 - INFO - Finished cleaning for exchange
2024-12-01 15:02:09,251 - ERROR - Finished cleaning for exchange
2024-12-01 15:02:09,484 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 28130 rows after removing duplicates.
2024-12-01 15:02:09,484 - ERROR - Starting cleaning for rates
2024-12-01 15:02:09,494 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:02:09,510 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:02:09,512 - INFO - Finished cleaning for rates
2024-12-01 15:02:09,512 - ERROR - Finished cleaning for rates
2024-12-01 15:02:09,666 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 15:02:09,666 - ERROR - Starting cleaning for categories
2024-12-01 15:02:09,671 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:02:09,682 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 15:02:09,684 - INFO - Finished cleaning for categories
2024-12-01 15:02:09,684 - ERROR - Finished cleaning for categories
2024-12-01 15:02:09,781 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 15:02:10,002 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 15:02:10,157 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 15:02:10,269 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 15:02:10,417 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 15:02:10,468 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 15:02:10,469 - INFO - Début des jointures et des transformations.
2024-12-01 15:02:10,516 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 15:02:11,706 - ERROR - Calcul des taxes en cours...
2024-12-01 15:02:11,707 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'ID_taux', 'currency', 'ratetoeuro']
2024-12-01 15:02:11,708 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 15:02:11,709 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 15:02:11,709 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 15:02:11,754 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 15:02:11,898 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 15:02:12,683 - ERROR - Calcul du taux de taxe terminé
2024-12-01 15:02:12,731 - ERROR - Calcul du prix après remise terminé
2024-12-01 15:02:14,143 - ERROR - Nombre total de lignes : 2155.
2024-12-01 15:02:14,143 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 15:02:14,143 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 15:02:14,759 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 15:02:14,759 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 15:02:14,788 - ERROR - Détection des anomalies en cours...
2024-12-01 15:02:14,865 - ERROR - Détection des anomalies terminée.
2024-12-01 15:02:15,488 - ERROR - Total anomalies detected: 4
2024-12-01 15:02:15,488 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 15:02:15,810 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 15:02:17,235 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 15:02:17,236 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 15:02:17,655 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 15:02:17,709 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:02:17,709 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:02:17,781 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 15:02:17,782 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 15:02:17,874 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:02:17,874 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:02:21,680 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:02:21,681 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:02:21,879 - INFO - Data cleaning process completed.
2024-12-01 15:02:21,884 - INFO - Closing down clientserver connection
2024-12-01 15:02:59,483 - ERROR - Removed 0 duplicate rows
2024-12-01 15:02:59,508 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 15:02:59,508 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:02:59,509 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:03:00,057 - ERROR - Removed 0 duplicate rows
2024-12-01 15:03:00,061 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:03:00,061 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:03:00,500 - ERROR - Removed 0 duplicate rows
2024-12-01 15:03:00,502 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:03:00,503 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:03:00,947 - ERROR - Removed 0 duplicate rows
2024-12-01 15:03:00,950 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:03:00,950 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:03:01,354 - ERROR - Removed 0 duplicate rows
2024-12-01 15:03:01,362 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:03:01,362 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:03:02,028 - ERROR - Removed 0 duplicate rows
2024-12-01 15:03:02,030 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:03:02,031 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:03:02,588 - ERROR - Removed 0 duplicate rows
2024-12-01 15:03:02,591 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:03:02,592 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:03:02,592 - ERROR - Starting cleaning for transactions
2024-12-01 15:03:02,738 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:03:02,800 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 15:03:02,836 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:03:02,872 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 15:03:02,998 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 15:03:02,998 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 15:03:03,117 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:03:03,121 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:03:03,247 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:03:03,247 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:03:03,248 - INFO - Finished cleaning for transactions
2024-12-01 15:03:03,249 - ERROR - Finished cleaning for transactions
2024-12-01 15:03:03,582 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 15:03:03,582 - ERROR - Starting cleaning for clients
2024-12-01 15:03:03,638 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:03:03,661 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:03:03,691 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:03:03,693 - INFO - Finished cleaning for clients
2024-12-01 15:03:03,693 - ERROR - Finished cleaning for clients
2024-12-01 15:03:03,913 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 15:03:03,913 - ERROR - Starting cleaning for produits
2024-12-01 15:03:03,932 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:03:03,956 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:03:04,002 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 15:03:04,004 - INFO - Finished cleaning for produits
2024-12-01 15:03:04,005 - ERROR - Finished cleaning for produits
2024-12-01 15:03:04,276 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 15:03:04,278 - ERROR - Starting cleaning for magasins
2024-12-01 15:03:04,321 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:03:04,337 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:03:04,354 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:03:04,356 - INFO - Finished cleaning for magasins
2024-12-01 15:03:04,356 - ERROR - Finished cleaning for magasins
2024-12-01 15:03:04,509 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 15:03:04,510 - ERROR - Starting cleaning for exchange
2024-12-01 15:03:04,517 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:03:04,537 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:03:04,539 - INFO - Finished cleaning for exchange
2024-12-01 15:03:04,540 - ERROR - Finished cleaning for exchange
2024-12-01 15:03:04,877 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 28130 rows after removing duplicates.
2024-12-01 15:03:04,877 - ERROR - Starting cleaning for rates
2024-12-01 15:03:04,891 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:03:04,906 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:03:04,907 - INFO - Finished cleaning for rates
2024-12-01 15:03:04,907 - ERROR - Finished cleaning for rates
2024-12-01 15:03:05,140 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 15:03:05,142 - ERROR - Starting cleaning for categories
2024-12-01 15:03:05,149 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:03:05,170 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 15:03:05,173 - INFO - Finished cleaning for categories
2024-12-01 15:03:05,173 - ERROR - Finished cleaning for categories
2024-12-01 15:03:05,326 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 15:03:05,670 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 15:03:05,862 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 15:03:06,053 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 15:03:06,452 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 15:03:06,507 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 15:03:06,507 - INFO - Début des jointures et des transformations.
2024-12-01 15:03:06,585 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 15:03:08,287 - ERROR - Calcul des taxes en cours...
2024-12-01 15:03:08,288 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'ID_taux', 'currency', 'ratetoeuro']
2024-12-01 15:03:08,289 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 15:03:08,289 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 15:03:08,290 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 15:03:08,334 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 15:03:08,526 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 15:03:09,467 - ERROR - Calcul du taux de taxe terminé
2024-12-01 15:03:09,519 - ERROR - Calcul du prix après remise terminé
2024-12-01 15:03:11,450 - ERROR - Nombre total de lignes : 2155.
2024-12-01 15:03:11,451 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 15:03:11,451 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 15:03:12,309 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 15:03:12,310 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 15:03:12,347 - ERROR - Détection des anomalies en cours...
2024-12-01 15:03:12,474 - ERROR - Détection des anomalies terminée.
2024-12-01 15:03:13,532 - ERROR - Total anomalies detected: 4
2024-12-01 15:03:13,533 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 15:03:13,990 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 15:03:16,100 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 15:03:16,100 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 15:03:16,724 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 15:03:16,859 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:03:16,859 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:03:16,945 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 15:03:16,946 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 15:03:17,131 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:03:17,131 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:03:21,355 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:03:21,355 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:03:21,956 - INFO - Data cleaning process completed.
2024-12-01 15:03:21,959 - INFO - Closing down clientserver connection
2024-12-01 15:04:57,705 - ERROR - Removed 0 duplicate rows
2024-12-01 15:04:57,719 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 15:04:57,720 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:04:57,721 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:04:58,177 - ERROR - Removed 0 duplicate rows
2024-12-01 15:04:58,190 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:04:58,190 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:04:58,545 - ERROR - Removed 0 duplicate rows
2024-12-01 15:04:58,554 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:04:58,554 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:04:58,919 - ERROR - Removed 0 duplicate rows
2024-12-01 15:04:58,921 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:04:58,921 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:04:59,218 - ERROR - Removed 0 duplicate rows
2024-12-01 15:04:59,220 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:04:59,221 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:04:59,709 - ERROR - Removed 0 duplicate rows
2024-12-01 15:04:59,710 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:04:59,711 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:05:00,060 - ERROR - Removed 0 duplicate rows
2024-12-01 15:05:00,060 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:05:00,071 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:05:00,071 - ERROR - Starting cleaning for transactions
2024-12-01 15:05:00,170 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:05:00,209 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 15:05:00,230 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:05:00,249 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 15:05:00,311 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 15:05:00,311 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 15:05:00,378 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:05:00,378 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:05:00,445 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:05:00,445 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:05:00,445 - INFO - Finished cleaning for transactions
2024-12-01 15:05:00,445 - ERROR - Finished cleaning for transactions
2024-12-01 15:05:00,690 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 15:05:00,690 - ERROR - Starting cleaning for clients
2024-12-01 15:05:00,742 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:05:00,756 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:05:00,771 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:05:00,772 - INFO - Finished cleaning for clients
2024-12-01 15:05:00,773 - ERROR - Finished cleaning for clients
2024-12-01 15:05:00,921 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 15:05:00,922 - ERROR - Starting cleaning for produits
2024-12-01 15:05:00,937 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:05:00,949 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:05:00,980 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 15:05:00,981 - INFO - Finished cleaning for produits
2024-12-01 15:05:00,981 - ERROR - Finished cleaning for produits
2024-12-01 15:05:01,115 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 15:05:01,115 - ERROR - Starting cleaning for magasins
2024-12-01 15:05:01,160 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:05:01,175 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:05:01,187 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:05:01,189 - INFO - Finished cleaning for magasins
2024-12-01 15:05:01,189 - ERROR - Finished cleaning for magasins
2024-12-01 15:05:01,338 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 15:05:01,338 - ERROR - Starting cleaning for exchange
2024-12-01 15:05:01,351 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:05:01,363 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:05:01,365 - INFO - Finished cleaning for exchange
2024-12-01 15:05:01,365 - ERROR - Finished cleaning for exchange
2024-12-01 15:05:01,579 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 28130 rows after removing duplicates.
2024-12-01 15:05:01,579 - ERROR - Starting cleaning for rates
2024-12-01 15:05:01,598 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:05:01,610 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:05:01,612 - INFO - Finished cleaning for rates
2024-12-01 15:05:01,612 - ERROR - Finished cleaning for rates
2024-12-01 15:05:01,750 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 15:05:01,750 - ERROR - Starting cleaning for categories
2024-12-01 15:05:01,756 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:05:01,768 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 15:05:01,769 - INFO - Finished cleaning for categories
2024-12-01 15:05:01,769 - ERROR - Finished cleaning for categories
2024-12-01 15:05:01,880 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 15:05:02,083 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 15:05:02,223 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 15:05:02,337 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 15:05:02,461 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 15:05:02,488 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 15:05:02,488 - INFO - Début des jointures et des transformations.
2024-12-01 15:05:02,535 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 15:05:03,692 - ERROR - Calcul des taxes en cours...
2024-12-01 15:05:03,695 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'ID_taux', 'currency', 'ratetoeuro']
2024-12-01 15:05:03,696 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 15:05:03,696 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 15:05:03,697 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 15:05:03,738 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 15:05:03,868 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 15:05:04,637 - ERROR - Calcul du taux de taxe terminé
2024-12-01 15:05:04,682 - ERROR - Calcul du prix après remise terminé
2024-12-01 15:05:06,221 - ERROR - Nombre total de lignes : 2155.
2024-12-01 15:05:06,221 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 15:05:06,221 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 15:05:06,883 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 15:05:06,883 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 15:05:06,920 - ERROR - Détection des anomalies en cours...
2024-12-01 15:05:07,006 - ERROR - Détection des anomalies terminée.
2024-12-01 15:05:07,623 - ERROR - Total anomalies detected: 4
2024-12-01 15:05:07,623 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 15:05:08,007 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 15:05:09,418 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 15:05:09,419 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 15:05:10,064 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 15:05:10,129 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:05:10,129 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:05:10,185 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 15:05:10,186 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 15:05:10,273 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:05:10,273 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:05:13,470 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:05:13,470 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:05:14,029 - INFO - Data cleaning process completed.
2024-12-01 15:05:14,034 - INFO - Closing down clientserver connection
2024-12-01 15:16:13,027 - ERROR - Removed 0 duplicate rows
2024-12-01 15:16:13,051 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 15:16:13,051 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:16:13,052 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:16:13,472 - ERROR - Removed 0 duplicate rows
2024-12-01 15:16:13,483 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:16:13,483 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:16:13,817 - ERROR - Removed 0 duplicate rows
2024-12-01 15:16:13,831 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:16:13,831 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:16:14,165 - ERROR - Removed 0 duplicate rows
2024-12-01 15:16:14,165 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:16:14,179 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:16:14,475 - ERROR - Removed 0 duplicate rows
2024-12-01 15:16:14,475 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:16:14,475 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:16:14,953 - ERROR - Removed 0 duplicate rows
2024-12-01 15:16:14,955 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:16:14,956 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:16:15,276 - ERROR - Removed 0 duplicate rows
2024-12-01 15:16:15,276 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:16:15,285 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:16:15,285 - ERROR - Starting cleaning for transactions
2024-12-01 15:16:15,389 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:16:15,426 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 15:16:15,450 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:16:15,466 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 15:16:15,525 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 15:16:15,525 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 15:16:15,595 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:16:15,595 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:16:15,650 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:16:15,650 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:16:15,650 - INFO - Finished cleaning for transactions
2024-12-01 15:16:15,650 - ERROR - Finished cleaning for transactions
2024-12-01 15:16:15,878 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 15:16:15,879 - ERROR - Starting cleaning for clients
2024-12-01 15:16:15,918 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:16:15,932 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:16:15,948 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:16:15,949 - INFO - Finished cleaning for clients
2024-12-01 15:16:15,950 - ERROR - Finished cleaning for clients
2024-12-01 15:16:16,084 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 15:16:16,084 - ERROR - Starting cleaning for produits
2024-12-01 15:16:16,099 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:16:16,112 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:16:16,142 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 15:16:16,143 - INFO - Finished cleaning for produits
2024-12-01 15:16:16,143 - ERROR - Finished cleaning for produits
2024-12-01 15:16:16,309 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 15:16:16,309 - ERROR - Starting cleaning for magasins
2024-12-01 15:16:16,344 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:16:16,356 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:16:16,370 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:16:16,371 - INFO - Finished cleaning for magasins
2024-12-01 15:16:16,371 - ERROR - Finished cleaning for magasins
2024-12-01 15:16:16,486 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 15:16:16,486 - ERROR - Starting cleaning for exchange
2024-12-01 15:16:16,494 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:16:16,508 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:16:16,510 - INFO - Finished cleaning for exchange
2024-12-01 15:16:16,510 - ERROR - Finished cleaning for exchange
2024-12-01 15:16:16,733 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 28130 rows after removing duplicates.
2024-12-01 15:16:16,733 - ERROR - Starting cleaning for rates
2024-12-01 15:16:16,746 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:16:16,759 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:16:16,761 - INFO - Finished cleaning for rates
2024-12-01 15:16:16,761 - ERROR - Finished cleaning for rates
2024-12-01 15:16:16,902 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 15:16:16,903 - ERROR - Starting cleaning for categories
2024-12-01 15:16:16,907 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:16:16,917 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 15:16:16,919 - INFO - Finished cleaning for categories
2024-12-01 15:16:16,919 - ERROR - Finished cleaning for categories
2024-12-01 15:16:17,013 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 15:16:17,234 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 15:16:17,366 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 15:16:17,520 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 15:16:17,639 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 15:16:17,672 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 15:16:17,673 - INFO - Début des jointures et des transformations.
2024-12-01 15:16:17,720 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 15:16:18,892 - ERROR - Calcul des taxes en cours...
2024-12-01 15:16:18,895 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'ID_taux', 'currency', 'ratetoeuro']
2024-12-01 15:16:18,896 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 15:16:18,896 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 15:16:18,896 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 15:16:18,936 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 15:16:19,074 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 15:16:19,898 - ERROR - Calcul du taux de taxe terminé
2024-12-01 15:16:19,941 - ERROR - Calcul du prix après remise terminé
2024-12-01 15:16:21,356 - ERROR - Nombre total de lignes : 2155.
2024-12-01 15:16:21,356 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 15:16:21,358 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 15:16:22,187 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 15:16:22,188 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 15:16:22,223 - ERROR - Détection des anomalies en cours...
2024-12-01 15:16:22,319 - ERROR - Détection des anomalies terminée.
2024-12-01 15:16:22,909 - ERROR - Total anomalies detected: 4
2024-12-01 15:16:22,909 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 15:16:23,232 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 15:16:24,642 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 15:16:24,642 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 15:16:25,019 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 15:16:25,101 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:16:25,101 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:16:25,152 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 15:16:25,152 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 15:16:25,237 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:16:25,253 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:16:28,452 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:16:28,452 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:16:28,961 - INFO - Data cleaning process completed.
2024-12-01 15:16:28,963 - INFO - Closing down clientserver connection
2024-12-01 15:20:14,489 - ERROR - Removed 0 duplicate rows
2024-12-01 15:20:14,505 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 15:20:14,506 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:20:14,506 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:20:14,952 - ERROR - Removed 0 duplicate rows
2024-12-01 15:20:14,959 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:20:14,959 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:20:15,313 - ERROR - Removed 0 duplicate rows
2024-12-01 15:20:15,315 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:20:15,315 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:20:15,653 - ERROR - Removed 0 duplicate rows
2024-12-01 15:20:15,654 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:20:15,654 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:20:15,936 - ERROR - Removed 0 duplicate rows
2024-12-01 15:20:15,936 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:20:15,944 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:20:16,419 - ERROR - Removed 0 duplicate rows
2024-12-01 15:20:16,430 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:20:16,430 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:20:16,740 - ERROR - Removed 0 duplicate rows
2024-12-01 15:20:16,740 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:20:16,751 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:20:16,751 - ERROR - Starting cleaning for transactions
2024-12-01 15:20:16,834 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:20:16,875 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 15:20:16,899 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:20:16,918 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 15:20:16,975 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 15:20:16,976 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 15:20:17,036 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:20:17,036 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:20:17,093 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:20:17,093 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:20:17,093 - INFO - Finished cleaning for transactions
2024-12-01 15:20:17,099 - ERROR - Finished cleaning for transactions
2024-12-01 15:20:17,312 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 15:20:17,312 - ERROR - Starting cleaning for clients
2024-12-01 15:20:17,362 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:20:17,376 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:20:17,388 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:20:17,389 - INFO - Finished cleaning for clients
2024-12-01 15:20:17,390 - ERROR - Finished cleaning for clients
2024-12-01 15:20:17,513 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 15:20:17,513 - ERROR - Starting cleaning for produits
2024-12-01 15:20:17,535 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:20:17,547 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:20:17,574 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 15:20:17,575 - INFO - Finished cleaning for produits
2024-12-01 15:20:17,575 - ERROR - Finished cleaning for produits
2024-12-01 15:20:17,695 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 15:20:17,695 - ERROR - Starting cleaning for magasins
2024-12-01 15:20:17,736 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:20:17,746 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:20:17,758 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:20:17,759 - INFO - Finished cleaning for magasins
2024-12-01 15:20:17,759 - ERROR - Finished cleaning for magasins
2024-12-01 15:20:17,879 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 15:20:17,879 - ERROR - Starting cleaning for exchange
2024-12-01 15:20:17,887 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:20:17,899 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:20:17,900 - INFO - Finished cleaning for exchange
2024-12-01 15:20:17,900 - ERROR - Finished cleaning for exchange
2024-12-01 15:20:18,163 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 28130 rows after removing duplicates.
2024-12-01 15:20:18,163 - ERROR - Starting cleaning for rates
2024-12-01 15:20:18,181 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:20:18,191 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:20:18,192 - INFO - Finished cleaning for rates
2024-12-01 15:20:18,192 - ERROR - Finished cleaning for rates
2024-12-01 15:20:18,319 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 15:20:18,319 - ERROR - Starting cleaning for categories
2024-12-01 15:20:18,332 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:20:18,338 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 15:20:18,338 - INFO - Finished cleaning for categories
2024-12-01 15:20:18,344 - ERROR - Finished cleaning for categories
2024-12-01 15:20:18,451 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 15:20:18,645 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 15:20:18,778 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 15:20:18,900 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 15:20:19,009 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 15:20:19,046 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 15:20:19,047 - INFO - Début des jointures et des transformations.
2024-12-01 15:20:19,093 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 15:20:20,357 - ERROR - Calcul des taxes en cours...
2024-12-01 15:20:20,360 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'ID_taux', 'currency', 'ratetoeuro']
2024-12-01 15:20:20,361 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 15:20:20,362 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 15:20:20,362 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 15:20:20,405 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 15:20:20,539 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 15:20:21,484 - ERROR - Calcul du taux de taxe terminé
2024-12-01 15:20:21,531 - ERROR - Calcul du prix après remise terminé
2024-12-01 15:20:23,359 - ERROR - Nombre total de lignes : 2155.
2024-12-01 15:20:23,359 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 15:20:23,361 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 15:20:24,157 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 15:20:24,157 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 15:20:24,183 - ERROR - Détection des anomalies en cours...
2024-12-01 15:20:24,270 - ERROR - Détection des anomalies terminée.
2024-12-01 15:20:24,896 - ERROR - Total anomalies detected: 4
2024-12-01 15:20:24,896 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 15:20:25,282 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 15:20:26,810 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 15:20:26,811 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 15:20:27,486 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 15:20:27,578 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:20:27,579 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:20:27,636 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 15:20:27,636 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 15:20:27,758 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:20:27,759 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:20:31,380 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:20:31,380 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:20:31,513 - INFO - Data cleaning process completed.
2024-12-01 15:20:31,518 - INFO - Closing down clientserver connection
2024-12-01 15:22:33,152 - ERROR - Removed 0 duplicate rows
2024-12-01 15:22:33,166 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 15:22:33,166 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:22:33,167 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:22:33,581 - ERROR - Removed 0 duplicate rows
2024-12-01 15:22:33,583 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:22:33,584 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:22:33,923 - ERROR - Removed 0 duplicate rows
2024-12-01 15:22:33,925 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:22:33,925 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:22:34,265 - ERROR - Removed 0 duplicate rows
2024-12-01 15:22:34,267 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:22:34,267 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:22:34,576 - ERROR - Removed 0 duplicate rows
2024-12-01 15:22:34,578 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:22:34,578 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:22:35,084 - ERROR - Removed 0 duplicate rows
2024-12-01 15:22:35,086 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:22:35,086 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:22:35,430 - ERROR - Removed 0 duplicate rows
2024-12-01 15:22:35,432 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:22:35,433 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:22:35,433 - ERROR - Starting cleaning for transactions
2024-12-01 15:22:35,534 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:22:35,573 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 15:22:35,597 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:22:35,617 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 15:22:35,687 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 15:22:35,687 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 15:22:35,754 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:22:35,754 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:22:35,819 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:22:35,819 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:22:35,820 - INFO - Finished cleaning for transactions
2024-12-01 15:22:35,820 - ERROR - Finished cleaning for transactions
2024-12-01 15:22:36,084 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 15:22:36,085 - ERROR - Starting cleaning for clients
2024-12-01 15:22:36,123 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:22:36,136 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:22:36,146 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:22:36,147 - INFO - Finished cleaning for clients
2024-12-01 15:22:36,147 - ERROR - Finished cleaning for clients
2024-12-01 15:22:36,282 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 15:22:36,283 - ERROR - Starting cleaning for produits
2024-12-01 15:22:36,297 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:22:36,309 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:22:36,338 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 15:22:36,341 - INFO - Finished cleaning for produits
2024-12-01 15:22:36,341 - ERROR - Finished cleaning for produits
2024-12-01 15:22:36,520 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 15:22:36,521 - ERROR - Starting cleaning for magasins
2024-12-01 15:22:36,557 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:22:36,568 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:22:36,580 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:22:36,581 - INFO - Finished cleaning for magasins
2024-12-01 15:22:36,581 - ERROR - Finished cleaning for magasins
2024-12-01 15:22:36,691 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 15:22:36,692 - ERROR - Starting cleaning for exchange
2024-12-01 15:22:36,700 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:22:36,711 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:22:36,712 - INFO - Finished cleaning for exchange
2024-12-01 15:22:36,712 - ERROR - Finished cleaning for exchange
2024-12-01 15:22:36,952 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 28130 rows after removing duplicates.
2024-12-01 15:22:36,953 - ERROR - Starting cleaning for rates
2024-12-01 15:22:36,960 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:22:36,972 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:22:36,973 - INFO - Finished cleaning for rates
2024-12-01 15:22:36,974 - ERROR - Finished cleaning for rates
2024-12-01 15:22:37,113 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 15:22:37,114 - ERROR - Starting cleaning for categories
2024-12-01 15:22:37,120 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:22:37,130 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 15:22:37,131 - INFO - Finished cleaning for categories
2024-12-01 15:22:37,132 - ERROR - Finished cleaning for categories
2024-12-01 15:22:37,235 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 15:22:37,442 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 15:22:37,582 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 15:22:37,699 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 15:22:37,838 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 15:22:37,872 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 15:22:37,873 - INFO - Début des jointures et des transformations.
2024-12-01 15:22:37,920 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 15:22:39,233 - ERROR - Calcul des taxes en cours...
2024-12-01 15:22:39,234 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'ID_taux']
2024-12-01 15:22:39,235 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 15:22:39,236 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 15:22:39,236 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 15:22:39,275 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 15:22:39,423 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 15:22:40,261 - ERROR - Calcul du taux de taxe terminé
2024-12-01 15:22:40,308 - ERROR - Calcul du prix après remise terminé
2024-12-01 15:22:40,505 - ERROR - Erreur lors de la transformation et de la sauvegarde des données : [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `ratetoeuro` cannot be resolved. Did you mean one of the following? [`ID_taux`, `Year`, `CustomerID`, `Discount`, `Freight`].;
'Filter isnull('ratetoeuro)
+- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2111, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2132, TaxID#2164, TaxeRate#2470, Country#1253, ... 3 more fields]
   +- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2111, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2132, TaxID#2164, coalesce(cast(TaxeRate#8 as double), 0.1) AS TaxeRate#2470, Country#1253, ... 2 more fields]
      +- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2111, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2132, TaxID#2164, TaxeRate#8, Country#1253, ... 2 more fields]
         +- Join LeftOuter, (ProductID#51 = ProduitID#2376)
            :- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2111, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2132, TaxID#2164, TaxeRate#8, Country#1253, Region#80]
            :  +- Join LeftOuter, (CustomerID#37 = CustomerID#74)
            :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2111, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2132, TaxID#2164, TaxeRate#8]
            :     :  +- Join LeftOuter, ((ShipCountry#1777 = TaxCountry#2159) AND (Year#2132 = cast(TaxYear#2154 as int)))
            :     :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2111, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, year(ShippedDate#2111) AS Year#2132]
            :     :     :  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, to_date(ShippedDate#966, Some(dd/MM/yyyy), Some(Europe/Paris), false) AS ShippedDate#2111, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148]
            :     :     :     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148]
            :     :     :        +- Join LeftOuter, ((ShipCountry#1777 = Country#1771) AND (cast(ShippedDate#966 as date) = date#1936))
            :     :     :           :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853]
            :     :     :           :  +- Join Inner, (ProductID#51 = ProductID#120)
            :     :     :           :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :        +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :           +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :              +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, to_date(RequiredDate#40, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                 +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                    +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                       +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                          +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                             +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, to_date(ShippedDate#41, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                   +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                      +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                         +- Project [OrderID#36, CustomerID#37, EmployeeID#38, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                            +- Project [OrderID#36, CustomerID#37, EmployeeID#38, to_date(OrderDate#39, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                               +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                                  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                                     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#44, ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :           :     :                                                        +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, coalesce(ShipAddress#45, cast(Unknown as string)) AS ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :           :     :                                                           +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :     :           :     :                                                              +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :     :           :     :                                                                 +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :     :           :     :                                                                    +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, coalesce(Freight#43, cast(0.0 as string)) AS Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                       +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#49, cast(Unknown as string)) AS ShipCountry#534, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                          +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, coalesce(ShipPostalCode#48, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                             +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, coalesce(ShipRegion#47, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#48, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                                +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                                   +- Deduplicate [Quantity#158, ShipCountry#49, UnitPrice#179, ShipCity#46, ShipVia#42, Discount#199, CustomerID#37, ShipRegion#47, ShipName#44, ShippedDate#41, ShipPostalCode#48, OrderID#36, ShipAddress#45, RequiredDate#40, Freight#43, EmployeeID#38, ProductID#51, OrderID1#50, OrderDate#39]
            :     :     :           :     :                                                                                      +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, UnitPrice#179, Quantity#158, cast(Discount#54 as float) AS Discount#199]
            :     :     :           :     :                                                                                         +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, cast(UnitPrice#52 as float) AS UnitPrice#179, Quantity#158, Discount#54]
            :     :     :           :     :                                                                                            +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, UnitPrice#52, cast(Quantity#53 as int) AS Quantity#158, Discount#54]
            :     :     :           :     :                                                                                               +- Relation [OrderID#36,CustomerID#37,EmployeeID#38,OrderDate#39,RequiredDate#40,ShippedDate#41,ShipVia#42,Freight#43,ShipName#44,ShipAddress#45,ShipCity#46,ShipRegion#47,ShipPostalCode#48,ShipCountry#49,OrderID1#50,ProductID#51,UnitPrice#52,Quantity#53,Discount#54] parquet
            :     :     :           :     +- Project [ProductID#120, SupplierID#122, Country#1796 AS MagasinCountry#1853]
            :     :     :           :        +- Join Inner, (SupplierID#122 = SupplierID#96)
            :     :     :           :           :- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :  +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :     +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :        +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1291, coalesce(UnitsInStock#126, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :           +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, coalesce(UnitPrice#125, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#126, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :              +- Deduplicate [UnitPrice#125, UnitsOnOrder#127, CategoryID#123, UnitsInStock#126, SupplierID#122, QuantityPerUnit#124, Discontinued#129, ProductID#120, ProductName#121, ReorderLevel#128]
            :     :     :           :           :                 +- Relation [ProductID#120,ProductName#121,SupplierID#122,CategoryID#123,QuantityPerUnit#124,UnitPrice#125,UnitsInStock#126,UnitsOnOrder#127,ReorderLevel#128,Discontinued#129] parquet
            :     :     :           :           +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, trim(Country#1534, None) AS Country#1796, Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :              +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, regexp_replace(Country#1383, [^a-zA-Z0-9\s], , 1) AS Country#1534, Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :                 +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, CASE WHEN RLIKE(Phone#1508, ^[0-9.\-\(\) ]+$) THEN Phone#1508 ELSE Unknown END AS Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :                    +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, coalesce(Phone#105, cast(Unknown as string)) AS Phone#1508, Fax#1483, HomePage#107]
            :     :     :           :                       +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, Phone#105, coalesce(Fax#106, cast(Unknown as string)) AS Fax#1483, HomePage#107]
            :     :     :           :                          +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, coalesce(PostalCode#103, cast(Unknown as string)) AS PostalCode#1458, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                             +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, coalesce(City#101, cast(Unknown as string)) AS City#1433, Region#102, PostalCode#103, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                +- Project [SupplierID#96, coalesce(CompanyName#97, cast(Unknown as string)) AS CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#101, Region#102, PostalCode#103, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                   +- Project [SupplierID#96, CompanyName#97, ContactName#98, ContactTitle#99, Address#100, City#101, Region#102, PostalCode#103, coalesce(Country#104, cast(Unknown as string)) AS Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                      +- Deduplicate [CompanyName#97, Country#104, Address#100, Region#102, Fax#106, Phone#105, City#101, SupplierID#96, ContactName#98, HomePage#107, ContactTitle#99, PostalCode#103]
            :     :     :           :                                         +- Relation [SupplierID#96,CompanyName#97,ContactName#98,ContactTitle#99,Address#100,City#101,Region#102,PostalCode#103,Country#104,Phone#105,Fax#106,HomePage#107] parquet
            :     :     :           +- Project [ID_taux#148, to_date(date#149, Some(yyyy-MM-dd), Some(Europe/Paris), false) AS date#1936, ratetoeuro#150, Country#1771, currency#152]
            :     :     :              +- Project [ID_taux#148, date#149, ratetoeuro#150, Country#1771, currency#152]
            :     :     :                 +- Join Inner, (Country#1771 = ShipCountry#1777)
            :     :     :                    :- Project [ID_taux#148, date#149, ratetoeuro#150, trim(Country#151, None) AS Country#1771, currency#152]
            :     :     :                    :  +- Relation [ID_taux#148,date#149,ratetoeuro#150,Country#151,currency#152] parquet
            :     :     :                    +- Deduplicate [ShipCountry#1777]
            :     :     :                       +- Project [ShipCountry#1777]
            :     :     :                          +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                             +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                   +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                      +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                         +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, to_date(RequiredDate#1946, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                            +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, RequiredDate#1946, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                               +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, RequiredDate#1946, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                  +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, RequiredDate#1946, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                     +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, RequiredDate#1946, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                        +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, RequiredDate#1946, to_date(ShippedDate#1947, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                           +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                              +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                 +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                    +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                       +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, to_date(OrderDate#1945, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                          +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#738, ShipName#1950, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                             +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#719, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                                +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#1950, ShipAddress#719, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :                                                                                   +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#571, ShipName#1950, coalesce(ShipAddress#1951, cast(Unknown as string)) AS ShipAddress#719, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :                                                                                      +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#571, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :     :                                                                                         +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#571, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :     :                                                                                            +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#571, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :     :                                                                                               +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, coalesce(Freight#1949, cast(0.0 as string)) AS Freight#571, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                  +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#1949, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#1955, cast(Unknown as string)) AS ShipCountry#534, ProductID#1957, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                     +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#1949, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#460, coalesce(ShipPostalCode#1954, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#1955, ProductID#1957, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                        +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#1949, ShipName#1950, ShipAddress#1951, ShipCity#1952, coalesce(ShipRegion#1953, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#1954, ShipCountry#1955, ProductID#1957, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                           +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#1949, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#1953, ShipPostalCode#1954, ShipCountry#1955, ProductID#1957, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                              +- Deduplicate [Quantity#158, ShipCountry#1955, UnitPrice#179, ShipCity#1952, ShipVia#1948, Discount#199, CustomerID#1943, ShipRegion#1953, ShipName#1950, ShippedDate#1947, ShipPostalCode#1954, OrderID#1942, ShipAddress#1951, RequiredDate#1946, Freight#1949, EmployeeID#1944, ProductID#1957, OrderID1#1956, OrderDate#1945]
            :     :     :                                                                                                                 +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#1949, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#1953, ShipPostalCode#1954, ShipCountry#1955, OrderID1#1956, ProductID#1957, UnitPrice#179, Quantity#158, cast(Discount#1960 as float) AS Discount#199]
            :     :     :                                                                                                                    +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#1949, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#1953, ShipPostalCode#1954, ShipCountry#1955, OrderID1#1956, ProductID#1957, cast(UnitPrice#1958 as float) AS UnitPrice#179, Quantity#158, Discount#1960]
            :     :     :                                                                                                                       +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#1949, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#1953, ShipPostalCode#1954, ShipCountry#1955, OrderID1#1956, ProductID#1957, UnitPrice#1958, cast(Quantity#1959 as int) AS Quantity#158, Discount#1960]
            :     :     :                                                                                                                          +- Relation [OrderID#1942,CustomerID#1943,EmployeeID#1944,OrderDate#1945,RequiredDate#1946,ShippedDate#1947,ShipVia#1948,Freight#1949,ShipName#1950,ShipAddress#1951,ShipCity#1952,ShipRegion#1953,ShipPostalCode#1954,ShipCountry#1955,OrderID1#1956,ProductID#1957,UnitPrice#1958,Quantity#1959,Discount#1960] parquet
            :     :     +- Project [TaxCountry#2159, TaxYear#2154, TaxID#2164, TaxeRate#8]
            :     :        +- Join LeftOuter, (TaxCountry#2159 = ShipCountry#1777)
            :     :           :- Project [ID_Taxe#0 AS TaxID#2164, TaxCountry#2159, TaxeRate#8, TaxYear#2154]
            :     :           :  +- Project [ID_Taxe#0, Country#1600 AS TaxCountry#2159, TaxeRate#8, TaxYear#2154]
            :     :           :     +- Project [ID_Taxe#0, Country#1600, TaxeRate#8, Year#3 AS TaxYear#2154]
            :     :           :        +- Project [ID_Taxe#0, regexp_replace(Country#1595, [^a-zA-Z0-9\s], , 1) AS Country#1600, TaxeRate#8, Year#3]
            :     :           :           +- Project [ID_Taxe#0, coalesce(Country#1, cast(Unknown as string)) AS Country#1595, TaxeRate#8, Year#3]
            :     :           :              +- Deduplicate [ID_Taxe#0, Country#1, TaxeRate#8, Year#3]
            :     :           :                 +- Project [ID_Taxe#0, Country#1, cast(TaxeRate#2 as float) AS TaxeRate#8, Year#3]
            :     :           :                    +- Relation [ID_Taxe#0,Country#1,TaxeRate#2,Year#3] parquet
            :     :           +- Deduplicate [ShipCountry#1777]
            :     :              +- Project [ShipCountry#1777]
            :     :                 +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#1061, ShippedDate#2111, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2225, year(ShippedDate#2111) AS Year#2132]
            :     :                    +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#1061, to_date(ShippedDate#966, Some(dd/MM/yyyy), Some(Europe/Paris), false) AS ShippedDate#2111, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2225]
            :     :                       +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2225]
            :     :                          +- Join LeftOuter, ((ShipCountry#1777 = Country#1771) AND (cast(ShippedDate#966 as date) = date#1936))
            :     :                             :- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853]
            :     :                             :  +- Join Inner, (ProductID#2199 = ProductID#2203)
            :     :                             :     :- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :  +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :     +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :        +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :           +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :              +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, to_date(RequiredDate#2188, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                 +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#2188, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                    +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#2188, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                       +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#2188, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                          +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#2188, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                             +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#2188, to_date(ShippedDate#2189, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                   +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                      +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                         +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                            +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, to_date(OrderDate#2187, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                               +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#738, ShipName#2192, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                                  +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#719, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                                     +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#2192, ShipAddress#719, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#608, Quantity#682, Discount#645]
            :     :                             :     :                                                        +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#571, ShipName#2192, coalesce(ShipAddress#2193, cast(Unknown as string)) AS ShipAddress#719, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#608, Quantity#682, Discount#645]
            :     :                             :     :                                                           +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#571, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :                             :     :                                                              +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#571, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :                             :     :                                                                 +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#571, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :                             :     :                                                                    +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, coalesce(Freight#2191, cast(0.0 as string)) AS Freight#571, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                       +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#2191, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#2197, cast(Unknown as string)) AS ShipCountry#534, ProductID#2199, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                          +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#2191, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#460, coalesce(ShipPostalCode#2196, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#2197, ProductID#2199, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                             +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#2191, ShipName#2192, ShipAddress#2193, ShipCity#2194, coalesce(ShipRegion#2195, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#2196, ShipCountry#2197, ProductID#2199, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                                +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#2191, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#2195, ShipPostalCode#2196, ShipCountry#2197, ProductID#2199, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                                   +- Deduplicate [Quantity#158, ShipCountry#2197, UnitPrice#179, ShipCity#2194, ShipVia#2190, Discount#199, CustomerID#2185, ShipRegion#2195, ShipName#2192, ShippedDate#2189, ShipPostalCode#2196, OrderID#2184, ShipAddress#2193, RequiredDate#2188, Freight#2191, EmployeeID#2186, ProductID#2199, OrderID1#2198, OrderDate#2187]
            :     :                             :     :                                                                                      +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#2191, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#2195, ShipPostalCode#2196, ShipCountry#2197, OrderID1#2198, ProductID#2199, UnitPrice#179, Quantity#158, cast(Discount#2202 as float) AS Discount#199]
            :     :                             :     :                                                                                         +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#2191, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#2195, ShipPostalCode#2196, ShipCountry#2197, OrderID1#2198, ProductID#2199, cast(UnitPrice#2200 as float) AS UnitPrice#179, Quantity#158, Discount#2202]
            :     :                             :     :                                                                                            +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#2191, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#2195, ShipPostalCode#2196, ShipCountry#2197, OrderID1#2198, ProductID#2199, UnitPrice#2200, cast(Quantity#2201 as int) AS Quantity#158, Discount#2202]
            :     :                             :     :                                                                                               +- Relation [OrderID#2184,CustomerID#2185,EmployeeID#2186,OrderDate#2187,RequiredDate#2188,ShippedDate#2189,ShipVia#2190,Freight#2191,ShipName#2192,ShipAddress#2193,ShipCity#2194,ShipRegion#2195,ShipPostalCode#2196,ShipCountry#2197,OrderID1#2198,ProductID#2199,UnitPrice#2200,Quantity#2201,Discount#2202] parquet
            :     :                             :     +- Project [ProductID#2203, SupplierID#2205, Country#1796 AS MagasinCountry#1853]
            :     :                             :        +- Join Inner, (SupplierID#2205 = SupplierID#2213)
            :     :                             :           :- Project [ProductID#2203, ProductName#2204, SupplierID#2205, CategoryID#2206, QuantityPerUnit#2207, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#2210, ReorderLevel#2211, Discontinued#2212]
            :     :                             :           :  +- Project [ProductID#2203, ProductName#2204, SupplierID#2205, CategoryID#2206, QuantityPerUnit#2207, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#2210, ReorderLevel#2211, Discontinued#2212]
            :     :                             :           :     +- Project [ProductID#2203, ProductName#2204, SupplierID#2205, CategoryID#2206, QuantityPerUnit#2207, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#2210, ReorderLevel#2211, Discontinued#2212]
            :     :                             :           :        +- Project [ProductID#2203, ProductName#2204, SupplierID#2205, CategoryID#2206, QuantityPerUnit#2207, UnitPrice#1291, coalesce(UnitsInStock#2209, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#2210, ReorderLevel#2211, Discontinued#2212]
            :     :                             :           :           +- Project [ProductID#2203, ProductName#2204, SupplierID#2205, CategoryID#2206, QuantityPerUnit#2207, coalesce(UnitPrice#2208, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#2209, UnitsOnOrder#2210, ReorderLevel#2211, Discontinued#2212]
            :     :                             :           :              +- Deduplicate [UnitPrice#2208, UnitsOnOrder#2210, CategoryID#2206, UnitsInStock#2209, SupplierID#2205, QuantityPerUnit#2207, Discontinued#2212, ProductID#2203, ProductName#2204, ReorderLevel#2211]
            :     :                             :           :                 +- Relation [ProductID#2203,ProductName#2204,SupplierID#2205,CategoryID#2206,QuantityPerUnit#2207,UnitPrice#2208,UnitsInStock#2209,UnitsOnOrder#2210,ReorderLevel#2211,Discontinued#2212] parquet
            :     :                             :           +- Project [SupplierID#2213, CompanyName#1408, ContactName#2215, ContactTitle#2216, Address#2217, City#1433, Region#2219, PostalCode#1458, trim(Country#1534, None) AS Country#1796, Phone#1521, Fax#1483, HomePage#2224]
            :     :                             :              +- Project [SupplierID#2213, CompanyName#1408, ContactName#2215, ContactTitle#2216, Address#2217, City#1433, Region#2219, PostalCode#1458, regexp_replace(Country#1383, [^a-zA-Z0-9\s], , 1) AS Country#1534, Phone#1521, Fax#1483, HomePage#2224]
            :     :                             :                 +- Project [SupplierID#2213, CompanyName#1408, ContactName#2215, ContactTitle#2216, Address#2217, City#1433, Region#2219, PostalCode#1458, Country#1383, CASE WHEN RLIKE(Phone#1508, ^[0-9.\-\(\) ]+$) THEN Phone#1508 ELSE Unknown END AS Phone#1521, Fax#1483, HomePage#2224]
            :     :                             :                    +- Project [SupplierID#2213, CompanyName#1408, ContactName#2215, ContactTitle#2216, Address#2217, City#1433, Region#2219, PostalCode#1458, Country#1383, coalesce(Phone#2222, cast(Unknown as string)) AS Phone#1508, Fax#1483, HomePage#2224]
            :     :                             :                       +- Project [SupplierID#2213, CompanyName#1408, ContactName#2215, ContactTitle#2216, Address#2217, City#1433, Region#2219, PostalCode#1458, Country#1383, Phone#2222, coalesce(Fax#2223, cast(Unknown as string)) AS Fax#1483, HomePage#2224]
            :     :                             :                          +- Project [SupplierID#2213, CompanyName#1408, ContactName#2215, ContactTitle#2216, Address#2217, City#1433, Region#2219, coalesce(PostalCode#2220, cast(Unknown as string)) AS PostalCode#1458, Country#1383, Phone#2222, Fax#2223, HomePage#2224]
            :     :                             :                             +- Project [SupplierID#2213, CompanyName#1408, ContactName#2215, ContactTitle#2216, Address#2217, coalesce(City#2218, cast(Unknown as string)) AS City#1433, Region#2219, PostalCode#2220, Country#1383, Phone#2222, Fax#2223, HomePage#2224]
            :     :                             :                                +- Project [SupplierID#2213, coalesce(CompanyName#2214, cast(Unknown as string)) AS CompanyName#1408, ContactName#2215, ContactTitle#2216, Address#2217, City#2218, Region#2219, PostalCode#2220, Country#1383, Phone#2222, Fax#2223, HomePage#2224]
            :     :                             :                                   +- Project [SupplierID#2213, CompanyName#2214, ContactName#2215, ContactTitle#2216, Address#2217, City#2218, Region#2219, PostalCode#2220, coalesce(Country#2221, cast(Unknown as string)) AS Country#1383, Phone#2222, Fax#2223, HomePage#2224]
            :     :                             :                                      +- Deduplicate [CompanyName#2214, Country#2221, Address#2217, Region#2219, Fax#2223, Phone#2222, City#2218, SupplierID#2213, ContactName#2215, HomePage#2224, ContactTitle#2216, PostalCode#2220]
            :     :                             :                                         +- Relation [SupplierID#2213,CompanyName#2214,ContactName#2215,ContactTitle#2216,Address#2217,City#2218,Region#2219,PostalCode#2220,Country#2221,Phone#2222,Fax#2223,HomePage#2224] parquet
            :     :                             +- Project [ID_taux#2225, to_date(date#2226, Some(yyyy-MM-dd), Some(Europe/Paris), false) AS date#1936, ratetoeuro#2227, Country#1771, currency#2229]
            :     :                                +- Project [ID_taux#2225, date#2226, ratetoeuro#2227, Country#1771, currency#2229]
            :     :                                   +- Join Inner, (Country#1771 = ShipCountry#1777)
            :     :                                      :- Project [ID_taux#2225, date#2226, ratetoeuro#2227, trim(Country#2228, None) AS Country#1771, currency#2229]
            :     :                                      :  +- Relation [ID_taux#2225,date#2226,ratetoeuro#2227,Country#2228,currency#2229] parquet
            :     :                                      +- Deduplicate [ShipCountry#1777]
            :     :                                         +- Project [ShipCountry#1777]
            :     :                                            +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                               +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                  +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                     +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                        +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                           +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, to_date(RequiredDate#2234, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                              +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, RequiredDate#2234, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                 +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, RequiredDate#2234, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                    +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, RequiredDate#2234, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                       +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, RequiredDate#2234, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                          +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, RequiredDate#2234, to_date(ShippedDate#2235, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                             +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                   +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                      +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                         +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, to_date(OrderDate#2233, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                            +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#738, ShipName#2238, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                               +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#719, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                                  +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#2238, ShipAddress#719, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#608, Quantity#682, Discount#645]
            :     :                                                                                                     +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#571, ShipName#2238, coalesce(ShipAddress#2239, cast(Unknown as string)) AS ShipAddress#719, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#608, Quantity#682, Discount#645]
            :     :                                                                                                        +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#571, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :                                                                                                           +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#571, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :                                                                                                              +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#571, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :                                                                                                                 +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, coalesce(Freight#2237, cast(0.0 as string)) AS Freight#571, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                    +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#2237, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#2243, cast(Unknown as string)) AS ShipCountry#534, ProductID#2245, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                       +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#2237, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#460, coalesce(ShipPostalCode#2242, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#2243, ProductID#2245, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                          +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#2237, ShipName#2238, ShipAddress#2239, ShipCity#2240, coalesce(ShipRegion#2241, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#2242, ShipCountry#2243, ProductID#2245, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                             +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#2237, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#2241, ShipPostalCode#2242, ShipCountry#2243, ProductID#2245, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                                +- Deduplicate [Quantity#158, ShipCountry#2243, UnitPrice#179, ShipCity#2240, ShipVia#2236, Discount#199, CustomerID#2231, ShipRegion#2241, ShipName#2238, ShippedDate#2235, ShipPostalCode#2242, OrderID#2230, ShipAddress#2239, RequiredDate#2234, Freight#2237, EmployeeID#2232, ProductID#2245, OrderID1#2244, OrderDate#2233]
            :     :                                                                                                                                   +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#2237, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#2241, ShipPostalCode#2242, ShipCountry#2243, OrderID1#2244, ProductID#2245, UnitPrice#179, Quantity#158, cast(Discount#2248 as float) AS Discount#199]
            :     :                                                                                                                                      +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#2237, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#2241, ShipPostalCode#2242, ShipCountry#2243, OrderID1#2244, ProductID#2245, cast(UnitPrice#2246 as float) AS UnitPrice#179, Quantity#158, Discount#2248]
            :     :                                                                                                                                         +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#2237, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#2241, ShipPostalCode#2242, ShipCountry#2243, OrderID1#2244, ProductID#2245, UnitPrice#2246, cast(Quantity#2247 as int) AS Quantity#158, Discount#2248]
            :     :                                                                                                                                            +- Relation [OrderID#2230,CustomerID#2231,EmployeeID#2232,OrderDate#2233,RequiredDate#2234,ShippedDate#2235,ShipVia#2236,Freight#2237,ShipName#2238,ShipAddress#2239,ShipCity#2240,ShipRegion#2241,ShipPostalCode#2242,ShipCountry#2243,OrderID1#2244,ProductID#2245,UnitPrice#2246,Quantity#2247,Discount#2248] parquet
            :     +- Project [CustomerID#74, Country#1253, Region#80]
            :        +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, regexp_replace(Country#1114, [^a-zA-Z0-9\s], , 1) AS Country#1253, Phone#1241, Fax#1206]
            :           +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, CASE WHEN RLIKE(Phone#1229, ^[0-9.\-\(\) ]+$) THEN Phone#1229 ELSE Unknown END AS Phone#1241, Fax#1206]
            :              +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, coalesce(Phone#83, cast(Unknown as string)) AS Phone#1229, Fax#1206]
            :                 +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, Phone#83, coalesce(Fax#84, cast(Unknown as string)) AS Fax#1206]
            :                    +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, coalesce(PostalCode#81, cast(Unknown as string)) AS PostalCode#1183, Country#1114, Phone#83, Fax#84]
            :                       +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, coalesce(City#79, cast(Unknown as string)) AS City#1160, Region#80, PostalCode#81, Country#1114, Phone#83, Fax#84]
            :                          +- Project [CustomerID#74, coalesce(CompanyName#75, cast(Unknown as string)) AS CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#79, Region#80, PostalCode#81, Country#1114, Phone#83, Fax#84]
            :                             +- Project [CustomerID#74, CompanyName#75, ContactName#76, ContactTitle#77, Address#78, City#79, Region#80, PostalCode#81, coalesce(Country#82, cast(Unknown as string)) AS Country#1114, Phone#83, Fax#84]
            :                                +- Deduplicate [CompanyName#75, Country#82, CustomerID#74, Address#78, Region#80, Fax#84, Phone#83, City#79, ContactName#76, ContactTitle#77, PostalCode#81]
            :                                   +- Relation [CustomerID#74,CompanyName#75,ContactName#76,ContactTitle#77,Address#78,City#79,Region#80,PostalCode#81,Country#82,Phone#83,Fax#84] parquet
            +- Project [ProductID#2379 AS ProduitID#2376, ProductName#2380]
               +- Project [ProductID#2379, ProductName#2380, SupplierID#2381, CategoryID#2382, QuantityPerUnit#2383, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#2386, ReorderLevel#2387, Discontinued#2388]
                  +- Project [ProductID#2379, ProductName#2380, SupplierID#2381, CategoryID#2382, QuantityPerUnit#2383, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#2386, ReorderLevel#2387, Discontinued#2388]
                     +- Project [ProductID#2379, ProductName#2380, SupplierID#2381, CategoryID#2382, QuantityPerUnit#2383, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#2386, ReorderLevel#2387, Discontinued#2388]
                        +- Project [ProductID#2379, ProductName#2380, SupplierID#2381, CategoryID#2382, QuantityPerUnit#2383, UnitPrice#1291, coalesce(UnitsInStock#2385, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#2386, ReorderLevel#2387, Discontinued#2388]
                           +- Project [ProductID#2379, ProductName#2380, SupplierID#2381, CategoryID#2382, QuantityPerUnit#2383, coalesce(UnitPrice#2384, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#2385, UnitsOnOrder#2386, ReorderLevel#2387, Discontinued#2388]
                              +- Deduplicate [UnitPrice#2384, UnitsOnOrder#2386, CategoryID#2382, UnitsInStock#2385, SupplierID#2381, QuantityPerUnit#2383, Discontinued#2388, ProductID#2379, ProductName#2380, ReorderLevel#2387]
                                 +- Relation [ProductID#2379,ProductName#2380,SupplierID#2381,CategoryID#2382,QuantityPerUnit#2383,UnitPrice#2384,UnitsInStock#2385,UnitsOnOrder#2386,ReorderLevel#2387,Discontinued#2388] parquet

2024-12-01 15:22:40,556 - ERROR - Erreur lors de la transformation et de la sauvegarde des données : [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `ratetoeuro` cannot be resolved. Did you mean one of the following? [`ID_taux`, `Year`, `CustomerID`, `Discount`, `Freight`].;
'Filter isnull('ratetoeuro)
+- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2111, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2132, TaxID#2164, TaxeRate#2470, Country#1253, ... 3 more fields]
   +- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2111, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2132, TaxID#2164, coalesce(cast(TaxeRate#8 as double), 0.1) AS TaxeRate#2470, Country#1253, ... 2 more fields]
      +- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2111, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2132, TaxID#2164, TaxeRate#8, Country#1253, ... 2 more fields]
         +- Join LeftOuter, (ProductID#51 = ProduitID#2376)
            :- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2111, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2132, TaxID#2164, TaxeRate#8, Country#1253, Region#80]
            :  +- Join LeftOuter, (CustomerID#37 = CustomerID#74)
            :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2111, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2132, TaxID#2164, TaxeRate#8]
            :     :  +- Join LeftOuter, ((ShipCountry#1777 = TaxCountry#2159) AND (Year#2132 = cast(TaxYear#2154 as int)))
            :     :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2111, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, year(ShippedDate#2111) AS Year#2132]
            :     :     :  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, to_date(ShippedDate#966, Some(dd/MM/yyyy), Some(Europe/Paris), false) AS ShippedDate#2111, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148]
            :     :     :     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148]
            :     :     :        +- Join LeftOuter, ((ShipCountry#1777 = Country#1771) AND (cast(ShippedDate#966 as date) = date#1936))
            :     :     :           :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853]
            :     :     :           :  +- Join Inner, (ProductID#51 = ProductID#120)
            :     :     :           :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :        +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :           +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :              +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, to_date(RequiredDate#40, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                 +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                    +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                       +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                          +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                             +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, to_date(ShippedDate#41, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                   +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                      +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                         +- Project [OrderID#36, CustomerID#37, EmployeeID#38, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                            +- Project [OrderID#36, CustomerID#37, EmployeeID#38, to_date(OrderDate#39, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                               +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                                  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                                     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#44, ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :           :     :                                                        +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, coalesce(ShipAddress#45, cast(Unknown as string)) AS ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :           :     :                                                           +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :     :           :     :                                                              +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :     :           :     :                                                                 +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :     :           :     :                                                                    +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, coalesce(Freight#43, cast(0.0 as string)) AS Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                       +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#49, cast(Unknown as string)) AS ShipCountry#534, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                          +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, coalesce(ShipPostalCode#48, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                             +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, coalesce(ShipRegion#47, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#48, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                                +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                                   +- Deduplicate [Quantity#158, ShipCountry#49, UnitPrice#179, ShipCity#46, ShipVia#42, Discount#199, CustomerID#37, ShipRegion#47, ShipName#44, ShippedDate#41, ShipPostalCode#48, OrderID#36, ShipAddress#45, RequiredDate#40, Freight#43, EmployeeID#38, ProductID#51, OrderID1#50, OrderDate#39]
            :     :     :           :     :                                                                                      +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, UnitPrice#179, Quantity#158, cast(Discount#54 as float) AS Discount#199]
            :     :     :           :     :                                                                                         +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, cast(UnitPrice#52 as float) AS UnitPrice#179, Quantity#158, Discount#54]
            :     :     :           :     :                                                                                            +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, UnitPrice#52, cast(Quantity#53 as int) AS Quantity#158, Discount#54]
            :     :     :           :     :                                                                                               +- Relation [OrderID#36,CustomerID#37,EmployeeID#38,OrderDate#39,RequiredDate#40,ShippedDate#41,ShipVia#42,Freight#43,ShipName#44,ShipAddress#45,ShipCity#46,ShipRegion#47,ShipPostalCode#48,ShipCountry#49,OrderID1#50,ProductID#51,UnitPrice#52,Quantity#53,Discount#54] parquet
            :     :     :           :     +- Project [ProductID#120, SupplierID#122, Country#1796 AS MagasinCountry#1853]
            :     :     :           :        +- Join Inner, (SupplierID#122 = SupplierID#96)
            :     :     :           :           :- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :  +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :     +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :        +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1291, coalesce(UnitsInStock#126, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :           +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, coalesce(UnitPrice#125, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#126, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :              +- Deduplicate [UnitPrice#125, UnitsOnOrder#127, CategoryID#123, UnitsInStock#126, SupplierID#122, QuantityPerUnit#124, Discontinued#129, ProductID#120, ProductName#121, ReorderLevel#128]
            :     :     :           :           :                 +- Relation [ProductID#120,ProductName#121,SupplierID#122,CategoryID#123,QuantityPerUnit#124,UnitPrice#125,UnitsInStock#126,UnitsOnOrder#127,ReorderLevel#128,Discontinued#129] parquet
            :     :     :           :           +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, trim(Country#1534, None) AS Country#1796, Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :              +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, regexp_replace(Country#1383, [^a-zA-Z0-9\s], , 1) AS Country#1534, Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :                 +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, CASE WHEN RLIKE(Phone#1508, ^[0-9.\-\(\) ]+$) THEN Phone#1508 ELSE Unknown END AS Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :                    +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, coalesce(Phone#105, cast(Unknown as string)) AS Phone#1508, Fax#1483, HomePage#107]
            :     :     :           :                       +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, Phone#105, coalesce(Fax#106, cast(Unknown as string)) AS Fax#1483, HomePage#107]
            :     :     :           :                          +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, coalesce(PostalCode#103, cast(Unknown as string)) AS PostalCode#1458, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                             +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, coalesce(City#101, cast(Unknown as string)) AS City#1433, Region#102, PostalCode#103, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                +- Project [SupplierID#96, coalesce(CompanyName#97, cast(Unknown as string)) AS CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#101, Region#102, PostalCode#103, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                   +- Project [SupplierID#96, CompanyName#97, ContactName#98, ContactTitle#99, Address#100, City#101, Region#102, PostalCode#103, coalesce(Country#104, cast(Unknown as string)) AS Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                      +- Deduplicate [CompanyName#97, Country#104, Address#100, Region#102, Fax#106, Phone#105, City#101, SupplierID#96, ContactName#98, HomePage#107, ContactTitle#99, PostalCode#103]
            :     :     :           :                                         +- Relation [SupplierID#96,CompanyName#97,ContactName#98,ContactTitle#99,Address#100,City#101,Region#102,PostalCode#103,Country#104,Phone#105,Fax#106,HomePage#107] parquet
            :     :     :           +- Project [ID_taux#148, to_date(date#149, Some(yyyy-MM-dd), Some(Europe/Paris), false) AS date#1936, ratetoeuro#150, Country#1771, currency#152]
            :     :     :              +- Project [ID_taux#148, date#149, ratetoeuro#150, Country#1771, currency#152]
            :     :     :                 +- Join Inner, (Country#1771 = ShipCountry#1777)
            :     :     :                    :- Project [ID_taux#148, date#149, ratetoeuro#150, trim(Country#151, None) AS Country#1771, currency#152]
            :     :     :                    :  +- Relation [ID_taux#148,date#149,ratetoeuro#150,Country#151,currency#152] parquet
            :     :     :                    +- Deduplicate [ShipCountry#1777]
            :     :     :                       +- Project [ShipCountry#1777]
            :     :     :                          +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                             +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                   +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                      +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                         +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, to_date(RequiredDate#1946, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                            +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, RequiredDate#1946, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                               +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, RequiredDate#1946, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                  +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, RequiredDate#1946, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                     +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, RequiredDate#1946, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                        +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#871, RequiredDate#1946, to_date(ShippedDate#1947, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                           +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                              +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                 +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                    +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                       +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, to_date(OrderDate#1945, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                          +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#738, ShipName#1950, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                             +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#738, ShipName#1950, ShipAddress#719, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                                +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#1950, ShipAddress#719, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :                                                                                   +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#571, ShipName#1950, coalesce(ShipAddress#1951, cast(Unknown as string)) AS ShipAddress#719, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :                                                                                      +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#571, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :     :                                                                                         +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#571, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :     :                                                                                            +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#571, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :     :                                                                                               +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, coalesce(Freight#1949, cast(0.0 as string)) AS Freight#571, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1957, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                  +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#1949, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#1955, cast(Unknown as string)) AS ShipCountry#534, ProductID#1957, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                     +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#1949, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#460, coalesce(ShipPostalCode#1954, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#1955, ProductID#1957, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                        +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#1949, ShipName#1950, ShipAddress#1951, ShipCity#1952, coalesce(ShipRegion#1953, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#1954, ShipCountry#1955, ProductID#1957, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                           +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#1949, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#1953, ShipPostalCode#1954, ShipCountry#1955, ProductID#1957, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                              +- Deduplicate [Quantity#158, ShipCountry#1955, UnitPrice#179, ShipCity#1952, ShipVia#1948, Discount#199, CustomerID#1943, ShipRegion#1953, ShipName#1950, ShippedDate#1947, ShipPostalCode#1954, OrderID#1942, ShipAddress#1951, RequiredDate#1946, Freight#1949, EmployeeID#1944, ProductID#1957, OrderID1#1956, OrderDate#1945]
            :     :     :                                                                                                                 +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#1949, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#1953, ShipPostalCode#1954, ShipCountry#1955, OrderID1#1956, ProductID#1957, UnitPrice#179, Quantity#158, cast(Discount#1960 as float) AS Discount#199]
            :     :     :                                                                                                                    +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#1949, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#1953, ShipPostalCode#1954, ShipCountry#1955, OrderID1#1956, ProductID#1957, cast(UnitPrice#1958 as float) AS UnitPrice#179, Quantity#158, Discount#1960]
            :     :     :                                                                                                                       +- Project [OrderID#1942, CustomerID#1943, EmployeeID#1944, OrderDate#1945, RequiredDate#1946, ShippedDate#1947, ShipVia#1948, Freight#1949, ShipName#1950, ShipAddress#1951, ShipCity#1952, ShipRegion#1953, ShipPostalCode#1954, ShipCountry#1955, OrderID1#1956, ProductID#1957, UnitPrice#1958, cast(Quantity#1959 as int) AS Quantity#158, Discount#1960]
            :     :     :                                                                                                                          +- Relation [OrderID#1942,CustomerID#1943,EmployeeID#1944,OrderDate#1945,RequiredDate#1946,ShippedDate#1947,ShipVia#1948,Freight#1949,ShipName#1950,ShipAddress#1951,ShipCity#1952,ShipRegion#1953,ShipPostalCode#1954,ShipCountry#1955,OrderID1#1956,ProductID#1957,UnitPrice#1958,Quantity#1959,Discount#1960] parquet
            :     :     +- Project [TaxCountry#2159, TaxYear#2154, TaxID#2164, TaxeRate#8]
            :     :        +- Join LeftOuter, (TaxCountry#2159 = ShipCountry#1777)
            :     :           :- Project [ID_Taxe#0 AS TaxID#2164, TaxCountry#2159, TaxeRate#8, TaxYear#2154]
            :     :           :  +- Project [ID_Taxe#0, Country#1600 AS TaxCountry#2159, TaxeRate#8, TaxYear#2154]
            :     :           :     +- Project [ID_Taxe#0, Country#1600, TaxeRate#8, Year#3 AS TaxYear#2154]
            :     :           :        +- Project [ID_Taxe#0, regexp_replace(Country#1595, [^a-zA-Z0-9\s], , 1) AS Country#1600, TaxeRate#8, Year#3]
            :     :           :           +- Project [ID_Taxe#0, coalesce(Country#1, cast(Unknown as string)) AS Country#1595, TaxeRate#8, Year#3]
            :     :           :              +- Deduplicate [ID_Taxe#0, Country#1, TaxeRate#8, Year#3]
            :     :           :                 +- Project [ID_Taxe#0, Country#1, cast(TaxeRate#2 as float) AS TaxeRate#8, Year#3]
            :     :           :                    +- Relation [ID_Taxe#0,Country#1,TaxeRate#2,Year#3] parquet
            :     :           +- Deduplicate [ShipCountry#1777]
            :     :              +- Project [ShipCountry#1777]
            :     :                 +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#1061, ShippedDate#2111, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2225, year(ShippedDate#2111) AS Year#2132]
            :     :                    +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#1061, to_date(ShippedDate#966, Some(dd/MM/yyyy), Some(Europe/Paris), false) AS ShippedDate#2111, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2225]
            :     :                       +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2225]
            :     :                          +- Join LeftOuter, ((ShipCountry#1777 = Country#1771) AND (cast(ShippedDate#966 as date) = date#1936))
            :     :                             :- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853]
            :     :                             :  +- Join Inner, (ProductID#2199 = ProductID#2203)
            :     :                             :     :- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :  +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :     +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :        +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :           +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :              +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, to_date(RequiredDate#2188, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                 +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#2188, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                    +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#2188, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                       +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#2188, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                          +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#2188, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                             +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#871, RequiredDate#2188, to_date(ShippedDate#2189, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                   +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                      +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                         +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                            +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, to_date(OrderDate#2187, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                               +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#738, ShipName#2192, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                                  +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#738, ShipName#2192, ShipAddress#719, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                                     +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#2192, ShipAddress#719, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#608, Quantity#682, Discount#645]
            :     :                             :     :                                                        +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#571, ShipName#2192, coalesce(ShipAddress#2193, cast(Unknown as string)) AS ShipAddress#719, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#608, Quantity#682, Discount#645]
            :     :                             :     :                                                           +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#571, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :                             :     :                                                              +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#571, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :                             :     :                                                                 +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#571, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :                             :     :                                                                    +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, coalesce(Freight#2191, cast(0.0 as string)) AS Freight#571, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2199, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                       +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#2191, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#2197, cast(Unknown as string)) AS ShipCountry#534, ProductID#2199, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                          +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#2191, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#460, coalesce(ShipPostalCode#2196, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#2197, ProductID#2199, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                             +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#2191, ShipName#2192, ShipAddress#2193, ShipCity#2194, coalesce(ShipRegion#2195, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#2196, ShipCountry#2197, ProductID#2199, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                                +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#2191, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#2195, ShipPostalCode#2196, ShipCountry#2197, ProductID#2199, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                                   +- Deduplicate [Quantity#158, ShipCountry#2197, UnitPrice#179, ShipCity#2194, ShipVia#2190, Discount#199, CustomerID#2185, ShipRegion#2195, ShipName#2192, ShippedDate#2189, ShipPostalCode#2196, OrderID#2184, ShipAddress#2193, RequiredDate#2188, Freight#2191, EmployeeID#2186, ProductID#2199, OrderID1#2198, OrderDate#2187]
            :     :                             :     :                                                                                      +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#2191, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#2195, ShipPostalCode#2196, ShipCountry#2197, OrderID1#2198, ProductID#2199, UnitPrice#179, Quantity#158, cast(Discount#2202 as float) AS Discount#199]
            :     :                             :     :                                                                                         +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#2191, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#2195, ShipPostalCode#2196, ShipCountry#2197, OrderID1#2198, ProductID#2199, cast(UnitPrice#2200 as float) AS UnitPrice#179, Quantity#158, Discount#2202]
            :     :                             :     :                                                                                            +- Project [OrderID#2184, CustomerID#2185, EmployeeID#2186, OrderDate#2187, RequiredDate#2188, ShippedDate#2189, ShipVia#2190, Freight#2191, ShipName#2192, ShipAddress#2193, ShipCity#2194, ShipRegion#2195, ShipPostalCode#2196, ShipCountry#2197, OrderID1#2198, ProductID#2199, UnitPrice#2200, cast(Quantity#2201 as int) AS Quantity#158, Discount#2202]
            :     :                             :     :                                                                                               +- Relation [OrderID#2184,CustomerID#2185,EmployeeID#2186,OrderDate#2187,RequiredDate#2188,ShippedDate#2189,ShipVia#2190,Freight#2191,ShipName#2192,ShipAddress#2193,ShipCity#2194,ShipRegion#2195,ShipPostalCode#2196,ShipCountry#2197,OrderID1#2198,ProductID#2199,UnitPrice#2200,Quantity#2201,Discount#2202] parquet
            :     :                             :     +- Project [ProductID#2203, SupplierID#2205, Country#1796 AS MagasinCountry#1853]
            :     :                             :        +- Join Inner, (SupplierID#2205 = SupplierID#2213)
            :     :                             :           :- Project [ProductID#2203, ProductName#2204, SupplierID#2205, CategoryID#2206, QuantityPerUnit#2207, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#2210, ReorderLevel#2211, Discontinued#2212]
            :     :                             :           :  +- Project [ProductID#2203, ProductName#2204, SupplierID#2205, CategoryID#2206, QuantityPerUnit#2207, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#2210, ReorderLevel#2211, Discontinued#2212]
            :     :                             :           :     +- Project [ProductID#2203, ProductName#2204, SupplierID#2205, CategoryID#2206, QuantityPerUnit#2207, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#2210, ReorderLevel#2211, Discontinued#2212]
            :     :                             :           :        +- Project [ProductID#2203, ProductName#2204, SupplierID#2205, CategoryID#2206, QuantityPerUnit#2207, UnitPrice#1291, coalesce(UnitsInStock#2209, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#2210, ReorderLevel#2211, Discontinued#2212]
            :     :                             :           :           +- Project [ProductID#2203, ProductName#2204, SupplierID#2205, CategoryID#2206, QuantityPerUnit#2207, coalesce(UnitPrice#2208, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#2209, UnitsOnOrder#2210, ReorderLevel#2211, Discontinued#2212]
            :     :                             :           :              +- Deduplicate [UnitPrice#2208, UnitsOnOrder#2210, CategoryID#2206, UnitsInStock#2209, SupplierID#2205, QuantityPerUnit#2207, Discontinued#2212, ProductID#2203, ProductName#2204, ReorderLevel#2211]
            :     :                             :           :                 +- Relation [ProductID#2203,ProductName#2204,SupplierID#2205,CategoryID#2206,QuantityPerUnit#2207,UnitPrice#2208,UnitsInStock#2209,UnitsOnOrder#2210,ReorderLevel#2211,Discontinued#2212] parquet
            :     :                             :           +- Project [SupplierID#2213, CompanyName#1408, ContactName#2215, ContactTitle#2216, Address#2217, City#1433, Region#2219, PostalCode#1458, trim(Country#1534, None) AS Country#1796, Phone#1521, Fax#1483, HomePage#2224]
            :     :                             :              +- Project [SupplierID#2213, CompanyName#1408, ContactName#2215, ContactTitle#2216, Address#2217, City#1433, Region#2219, PostalCode#1458, regexp_replace(Country#1383, [^a-zA-Z0-9\s], , 1) AS Country#1534, Phone#1521, Fax#1483, HomePage#2224]
            :     :                             :                 +- Project [SupplierID#2213, CompanyName#1408, ContactName#2215, ContactTitle#2216, Address#2217, City#1433, Region#2219, PostalCode#1458, Country#1383, CASE WHEN RLIKE(Phone#1508, ^[0-9.\-\(\) ]+$) THEN Phone#1508 ELSE Unknown END AS Phone#1521, Fax#1483, HomePage#2224]
            :     :                             :                    +- Project [SupplierID#2213, CompanyName#1408, ContactName#2215, ContactTitle#2216, Address#2217, City#1433, Region#2219, PostalCode#1458, Country#1383, coalesce(Phone#2222, cast(Unknown as string)) AS Phone#1508, Fax#1483, HomePage#2224]
            :     :                             :                       +- Project [SupplierID#2213, CompanyName#1408, ContactName#2215, ContactTitle#2216, Address#2217, City#1433, Region#2219, PostalCode#1458, Country#1383, Phone#2222, coalesce(Fax#2223, cast(Unknown as string)) AS Fax#1483, HomePage#2224]
            :     :                             :                          +- Project [SupplierID#2213, CompanyName#1408, ContactName#2215, ContactTitle#2216, Address#2217, City#1433, Region#2219, coalesce(PostalCode#2220, cast(Unknown as string)) AS PostalCode#1458, Country#1383, Phone#2222, Fax#2223, HomePage#2224]
            :     :                             :                             +- Project [SupplierID#2213, CompanyName#1408, ContactName#2215, ContactTitle#2216, Address#2217, coalesce(City#2218, cast(Unknown as string)) AS City#1433, Region#2219, PostalCode#2220, Country#1383, Phone#2222, Fax#2223, HomePage#2224]
            :     :                             :                                +- Project [SupplierID#2213, coalesce(CompanyName#2214, cast(Unknown as string)) AS CompanyName#1408, ContactName#2215, ContactTitle#2216, Address#2217, City#2218, Region#2219, PostalCode#2220, Country#1383, Phone#2222, Fax#2223, HomePage#2224]
            :     :                             :                                   +- Project [SupplierID#2213, CompanyName#2214, ContactName#2215, ContactTitle#2216, Address#2217, City#2218, Region#2219, PostalCode#2220, coalesce(Country#2221, cast(Unknown as string)) AS Country#1383, Phone#2222, Fax#2223, HomePage#2224]
            :     :                             :                                      +- Deduplicate [CompanyName#2214, Country#2221, Address#2217, Region#2219, Fax#2223, Phone#2222, City#2218, SupplierID#2213, ContactName#2215, HomePage#2224, ContactTitle#2216, PostalCode#2220]
            :     :                             :                                         +- Relation [SupplierID#2213,CompanyName#2214,ContactName#2215,ContactTitle#2216,Address#2217,City#2218,Region#2219,PostalCode#2220,Country#2221,Phone#2222,Fax#2223,HomePage#2224] parquet
            :     :                             +- Project [ID_taux#2225, to_date(date#2226, Some(yyyy-MM-dd), Some(Europe/Paris), false) AS date#1936, ratetoeuro#2227, Country#1771, currency#2229]
            :     :                                +- Project [ID_taux#2225, date#2226, ratetoeuro#2227, Country#1771, currency#2229]
            :     :                                   +- Join Inner, (Country#1771 = ShipCountry#1777)
            :     :                                      :- Project [ID_taux#2225, date#2226, ratetoeuro#2227, trim(Country#2228, None) AS Country#1771, currency#2229]
            :     :                                      :  +- Relation [ID_taux#2225,date#2226,ratetoeuro#2227,Country#2228,currency#2229] parquet
            :     :                                      +- Deduplicate [ShipCountry#1777]
            :     :                                         +- Project [ShipCountry#1777]
            :     :                                            +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                               +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                  +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                     +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                        +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                           +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, to_date(RequiredDate#2234, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                              +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, RequiredDate#2234, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                 +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, RequiredDate#2234, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                    +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, RequiredDate#2234, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                       +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, RequiredDate#2234, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                          +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#871, RequiredDate#2234, to_date(ShippedDate#2235, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                             +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                   +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                      +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                         +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, to_date(OrderDate#2233, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                            +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#738, ShipName#2238, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                               +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#738, ShipName#2238, ShipAddress#719, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                                  +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#2238, ShipAddress#719, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#608, Quantity#682, Discount#645]
            :     :                                                                                                     +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#571, ShipName#2238, coalesce(ShipAddress#2239, cast(Unknown as string)) AS ShipAddress#719, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#608, Quantity#682, Discount#645]
            :     :                                                                                                        +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#571, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :                                                                                                           +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#571, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :                                                                                                              +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#571, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :                                                                                                                 +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, coalesce(Freight#2237, cast(0.0 as string)) AS Freight#571, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2245, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                    +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#2237, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#2243, cast(Unknown as string)) AS ShipCountry#534, ProductID#2245, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                       +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#2237, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#460, coalesce(ShipPostalCode#2242, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#2243, ProductID#2245, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                          +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#2237, ShipName#2238, ShipAddress#2239, ShipCity#2240, coalesce(ShipRegion#2241, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#2242, ShipCountry#2243, ProductID#2245, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                             +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#2237, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#2241, ShipPostalCode#2242, ShipCountry#2243, ProductID#2245, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                                +- Deduplicate [Quantity#158, ShipCountry#2243, UnitPrice#179, ShipCity#2240, ShipVia#2236, Discount#199, CustomerID#2231, ShipRegion#2241, ShipName#2238, ShippedDate#2235, ShipPostalCode#2242, OrderID#2230, ShipAddress#2239, RequiredDate#2234, Freight#2237, EmployeeID#2232, ProductID#2245, OrderID1#2244, OrderDate#2233]
            :     :                                                                                                                                   +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#2237, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#2241, ShipPostalCode#2242, ShipCountry#2243, OrderID1#2244, ProductID#2245, UnitPrice#179, Quantity#158, cast(Discount#2248 as float) AS Discount#199]
            :     :                                                                                                                                      +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#2237, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#2241, ShipPostalCode#2242, ShipCountry#2243, OrderID1#2244, ProductID#2245, cast(UnitPrice#2246 as float) AS UnitPrice#179, Quantity#158, Discount#2248]
            :     :                                                                                                                                         +- Project [OrderID#2230, CustomerID#2231, EmployeeID#2232, OrderDate#2233, RequiredDate#2234, ShippedDate#2235, ShipVia#2236, Freight#2237, ShipName#2238, ShipAddress#2239, ShipCity#2240, ShipRegion#2241, ShipPostalCode#2242, ShipCountry#2243, OrderID1#2244, ProductID#2245, UnitPrice#2246, cast(Quantity#2247 as int) AS Quantity#158, Discount#2248]
            :     :                                                                                                                                            +- Relation [OrderID#2230,CustomerID#2231,EmployeeID#2232,OrderDate#2233,RequiredDate#2234,ShippedDate#2235,ShipVia#2236,Freight#2237,ShipName#2238,ShipAddress#2239,ShipCity#2240,ShipRegion#2241,ShipPostalCode#2242,ShipCountry#2243,OrderID1#2244,ProductID#2245,UnitPrice#2246,Quantity#2247,Discount#2248] parquet
            :     +- Project [CustomerID#74, Country#1253, Region#80]
            :        +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, regexp_replace(Country#1114, [^a-zA-Z0-9\s], , 1) AS Country#1253, Phone#1241, Fax#1206]
            :           +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, CASE WHEN RLIKE(Phone#1229, ^[0-9.\-\(\) ]+$) THEN Phone#1229 ELSE Unknown END AS Phone#1241, Fax#1206]
            :              +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, coalesce(Phone#83, cast(Unknown as string)) AS Phone#1229, Fax#1206]
            :                 +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, Phone#83, coalesce(Fax#84, cast(Unknown as string)) AS Fax#1206]
            :                    +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, coalesce(PostalCode#81, cast(Unknown as string)) AS PostalCode#1183, Country#1114, Phone#83, Fax#84]
            :                       +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, coalesce(City#79, cast(Unknown as string)) AS City#1160, Region#80, PostalCode#81, Country#1114, Phone#83, Fax#84]
            :                          +- Project [CustomerID#74, coalesce(CompanyName#75, cast(Unknown as string)) AS CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#79, Region#80, PostalCode#81, Country#1114, Phone#83, Fax#84]
            :                             +- Project [CustomerID#74, CompanyName#75, ContactName#76, ContactTitle#77, Address#78, City#79, Region#80, PostalCode#81, coalesce(Country#82, cast(Unknown as string)) AS Country#1114, Phone#83, Fax#84]
            :                                +- Deduplicate [CompanyName#75, Country#82, CustomerID#74, Address#78, Region#80, Fax#84, Phone#83, City#79, ContactName#76, ContactTitle#77, PostalCode#81]
            :                                   +- Relation [CustomerID#74,CompanyName#75,ContactName#76,ContactTitle#77,Address#78,City#79,Region#80,PostalCode#81,Country#82,Phone#83,Fax#84] parquet
            +- Project [ProductID#2379 AS ProduitID#2376, ProductName#2380]
               +- Project [ProductID#2379, ProductName#2380, SupplierID#2381, CategoryID#2382, QuantityPerUnit#2383, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#2386, ReorderLevel#2387, Discontinued#2388]
                  +- Project [ProductID#2379, ProductName#2380, SupplierID#2381, CategoryID#2382, QuantityPerUnit#2383, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#2386, ReorderLevel#2387, Discontinued#2388]
                     +- Project [ProductID#2379, ProductName#2380, SupplierID#2381, CategoryID#2382, QuantityPerUnit#2383, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#2386, ReorderLevel#2387, Discontinued#2388]
                        +- Project [ProductID#2379, ProductName#2380, SupplierID#2381, CategoryID#2382, QuantityPerUnit#2383, UnitPrice#1291, coalesce(UnitsInStock#2385, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#2386, ReorderLevel#2387, Discontinued#2388]
                           +- Project [ProductID#2379, ProductName#2380, SupplierID#2381, CategoryID#2382, QuantityPerUnit#2383, coalesce(UnitPrice#2384, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#2385, UnitsOnOrder#2386, ReorderLevel#2387, Discontinued#2388]
                              +- Deduplicate [UnitPrice#2384, UnitsOnOrder#2386, CategoryID#2382, UnitsInStock#2385, SupplierID#2381, QuantityPerUnit#2383, Discontinued#2388, ProductID#2379, ProductName#2380, ReorderLevel#2387]
                                 +- Relation [ProductID#2379,ProductName#2380,SupplierID#2381,CategoryID#2382,QuantityPerUnit#2383,UnitPrice#2384,UnitsInStock#2385,UnitsOnOrder#2386,ReorderLevel#2387,Discontinued#2388] parquet

2024-12-01 15:22:40,900 - INFO - Data cleaning process completed.
2024-12-01 15:22:40,903 - INFO - Closing down clientserver connection
2024-12-01 15:23:53,608 - ERROR - Removed 0 duplicate rows
2024-12-01 15:23:53,621 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 15:23:53,622 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:23:53,622 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:23:54,002 - ERROR - Removed 0 duplicate rows
2024-12-01 15:23:54,004 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:23:54,005 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:23:54,391 - ERROR - Removed 0 duplicate rows
2024-12-01 15:23:54,393 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:23:54,394 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:23:54,729 - ERROR - Removed 0 duplicate rows
2024-12-01 15:23:54,731 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:23:54,731 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:23:55,041 - ERROR - Removed 0 duplicate rows
2024-12-01 15:23:55,042 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:23:55,043 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:23:55,487 - ERROR - Removed 0 duplicate rows
2024-12-01 15:23:55,489 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:23:55,489 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:23:55,849 - ERROR - Removed 0 duplicate rows
2024-12-01 15:23:55,850 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:23:55,851 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:23:55,851 - ERROR - Starting cleaning for transactions
2024-12-01 15:23:55,946 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:23:55,977 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 15:23:55,999 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:23:56,015 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 15:23:56,077 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 15:23:56,077 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 15:23:56,138 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:23:56,139 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:23:56,200 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:23:56,201 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:23:56,201 - INFO - Finished cleaning for transactions
2024-12-01 15:23:56,202 - ERROR - Finished cleaning for transactions
2024-12-01 15:23:56,426 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 15:23:56,427 - ERROR - Starting cleaning for clients
2024-12-01 15:23:56,460 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:23:56,471 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:23:56,482 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:23:56,483 - INFO - Finished cleaning for clients
2024-12-01 15:23:56,483 - ERROR - Finished cleaning for clients
2024-12-01 15:23:56,612 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 15:23:56,613 - ERROR - Starting cleaning for produits
2024-12-01 15:23:56,626 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:23:56,639 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:23:56,669 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 15:23:56,670 - INFO - Finished cleaning for produits
2024-12-01 15:23:56,670 - ERROR - Finished cleaning for produits
2024-12-01 15:23:56,799 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 15:23:56,800 - ERROR - Starting cleaning for magasins
2024-12-01 15:23:56,832 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:23:56,843 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:23:56,879 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:23:56,880 - INFO - Finished cleaning for magasins
2024-12-01 15:23:56,881 - ERROR - Finished cleaning for magasins
2024-12-01 15:23:56,995 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 15:23:56,996 - ERROR - Starting cleaning for exchange
2024-12-01 15:23:57,002 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:23:57,014 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:23:57,016 - INFO - Finished cleaning for exchange
2024-12-01 15:23:57,016 - ERROR - Finished cleaning for exchange
2024-12-01 15:23:57,251 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 28130 rows after removing duplicates.
2024-12-01 15:23:57,252 - ERROR - Starting cleaning for rates
2024-12-01 15:23:57,257 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:23:57,268 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:23:57,270 - INFO - Finished cleaning for rates
2024-12-01 15:23:57,270 - ERROR - Finished cleaning for rates
2024-12-01 15:23:57,408 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 15:23:57,409 - ERROR - Starting cleaning for categories
2024-12-01 15:23:57,414 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:23:57,424 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 15:23:57,425 - INFO - Finished cleaning for categories
2024-12-01 15:23:57,425 - ERROR - Finished cleaning for categories
2024-12-01 15:23:57,535 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 15:23:57,750 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 15:23:57,911 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 15:23:58,025 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 15:23:58,136 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 15:23:58,162 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 15:23:58,162 - INFO - Début des jointures et des transformations.
2024-12-01 15:23:58,208 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 15:23:59,543 - ERROR - Calcul des taxes en cours...
2024-12-01 15:23:59,546 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'ID_taux']
2024-12-01 15:23:59,547 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 15:23:59,547 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 15:23:59,548 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 15:23:59,587 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 15:23:59,721 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 15:24:00,579 - ERROR - Calcul du taux de taxe terminé
2024-12-01 15:24:00,620 - ERROR - Calcul du prix après remise terminé
2024-12-01 15:24:00,787 - ERROR - Erreur lors de la transformation et de la sauvegarde des données : [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `ratetoeuro` cannot be resolved. Did you mean one of the following? [`ID_taux`, `Year`, `CustomerID`, `Discount`, `Freight`].;
'Filter isnull('ratetoeuro)
+- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#2462, Country#1253, ... 3 more fields]
   +- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, coalesce(cast(TaxeRate#8 as double), 0.1) AS TaxeRate#2462, Country#1253, ... 2 more fields]
      +- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#8, Country#1253, ... 2 more fields]
         +- Join LeftOuter, (ProductID#51 = ProduitID#2368)
            :- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#8, Country#1253, Region#80]
            :  +- Join LeftOuter, (CustomerID#37 = CustomerID#74)
            :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#8]
            :     :  +- Join LeftOuter, ((ShipCountry#1777 = TaxCountry#2151) AND (Year#2124 = cast(TaxYear#2146 as int)))
            :     :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, year(ShippedDate#2103) AS Year#2124]
            :     :     :  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, to_date(ShippedDate#966, Some(dd/MM/yyyy), Some(Europe/Paris), false) AS ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148]
            :     :     :     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148]
            :     :     :        +- Join LeftOuter, ((ShipCountry#1777 = Country#1771) AND (cast(ShippedDate#966 as date) = date#1934))
            :     :     :           :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853]
            :     :     :           :  +- Join Inner, (ProductID#51 = ProductID#120)
            :     :     :           :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :        +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :           +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :              +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, to_date(RequiredDate#40, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                 +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                    +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                       +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                          +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                             +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, to_date(ShippedDate#41, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                   +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                      +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                         +- Project [OrderID#36, CustomerID#37, EmployeeID#38, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                            +- Project [OrderID#36, CustomerID#37, EmployeeID#38, to_date(OrderDate#39, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                               +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                                  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                                     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#44, ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :           :     :                                                        +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, coalesce(ShipAddress#45, cast(Unknown as string)) AS ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :           :     :                                                           +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :     :           :     :                                                              +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :     :           :     :                                                                 +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :     :           :     :                                                                    +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, coalesce(Freight#43, cast(0.0 as string)) AS Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                       +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#49, cast(Unknown as string)) AS ShipCountry#534, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                          +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, coalesce(ShipPostalCode#48, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                             +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, coalesce(ShipRegion#47, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#48, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                                +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                                   +- Deduplicate [Quantity#158, ShipCountry#49, UnitPrice#179, ShipCity#46, ShipVia#42, Discount#199, CustomerID#37, ShipRegion#47, ShipName#44, ShippedDate#41, ShipPostalCode#48, OrderID#36, ShipAddress#45, RequiredDate#40, Freight#43, EmployeeID#38, ProductID#51, OrderID1#50, OrderDate#39]
            :     :     :           :     :                                                                                      +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, UnitPrice#179, Quantity#158, cast(Discount#54 as float) AS Discount#199]
            :     :     :           :     :                                                                                         +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, cast(UnitPrice#52 as float) AS UnitPrice#179, Quantity#158, Discount#54]
            :     :     :           :     :                                                                                            +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, UnitPrice#52, cast(Quantity#53 as int) AS Quantity#158, Discount#54]
            :     :     :           :     :                                                                                               +- Relation [OrderID#36,CustomerID#37,EmployeeID#38,OrderDate#39,RequiredDate#40,ShippedDate#41,ShipVia#42,Freight#43,ShipName#44,ShipAddress#45,ShipCity#46,ShipRegion#47,ShipPostalCode#48,ShipCountry#49,OrderID1#50,ProductID#51,UnitPrice#52,Quantity#53,Discount#54] parquet
            :     :     :           :     +- Project [ProductID#120, SupplierID#122, Country#1796 AS MagasinCountry#1853]
            :     :     :           :        +- Join Inner, (SupplierID#122 = SupplierID#96)
            :     :     :           :           :- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :  +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :     +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :        +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1291, coalesce(UnitsInStock#126, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :           +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, coalesce(UnitPrice#125, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#126, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :              +- Deduplicate [UnitPrice#125, UnitsOnOrder#127, CategoryID#123, UnitsInStock#126, SupplierID#122, QuantityPerUnit#124, Discontinued#129, ProductID#120, ProductName#121, ReorderLevel#128]
            :     :     :           :           :                 +- Relation [ProductID#120,ProductName#121,SupplierID#122,CategoryID#123,QuantityPerUnit#124,UnitPrice#125,UnitsInStock#126,UnitsOnOrder#127,ReorderLevel#128,Discontinued#129] parquet
            :     :     :           :           +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, trim(Country#1534, None) AS Country#1796, Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :              +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, regexp_replace(Country#1383, [^a-zA-Z0-9\s], , 1) AS Country#1534, Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :                 +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, CASE WHEN RLIKE(Phone#1508, ^[0-9.\-\(\) ]+$) THEN Phone#1508 ELSE Unknown END AS Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :                    +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, coalesce(Phone#105, cast(Unknown as string)) AS Phone#1508, Fax#1483, HomePage#107]
            :     :     :           :                       +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, Phone#105, coalesce(Fax#106, cast(Unknown as string)) AS Fax#1483, HomePage#107]
            :     :     :           :                          +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, coalesce(PostalCode#103, cast(Unknown as string)) AS PostalCode#1458, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                             +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, coalesce(City#101, cast(Unknown as string)) AS City#1433, Region#102, PostalCode#103, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                +- Project [SupplierID#96, coalesce(CompanyName#97, cast(Unknown as string)) AS CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#101, Region#102, PostalCode#103, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                   +- Project [SupplierID#96, CompanyName#97, ContactName#98, ContactTitle#99, Address#100, City#101, Region#102, PostalCode#103, coalesce(Country#104, cast(Unknown as string)) AS Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                      +- Deduplicate [CompanyName#97, Country#104, Address#100, Region#102, Fax#106, Phone#105, City#101, SupplierID#96, ContactName#98, HomePage#107, ContactTitle#99, PostalCode#103]
            :     :     :           :                                         +- Relation [SupplierID#96,CompanyName#97,ContactName#98,ContactTitle#99,Address#100,City#101,Region#102,PostalCode#103,Country#104,Phone#105,Fax#106,HomePage#107] parquet
            :     :     :           +- Project [ID_taux#148, to_date(date#149, Some(yyyy-MM-dd), Some(Europe/Paris), false) AS date#1934, Country#1771]
            :     :     :              +- Project [ID_taux#148, date#149, Country#1771]
            :     :     :                 +- Join Inner, (Country#1771 = ShipCountry#1777)
            :     :     :                    :- Project [ID_taux#148, date#149, ratetoeuro#150, trim(Country#151, None) AS Country#1771, currency#152]
            :     :     :                    :  +- Relation [ID_taux#148,date#149,ratetoeuro#150,Country#151,currency#152] parquet
            :     :     :                    +- Deduplicate [ShipCountry#1777]
            :     :     :                       +- Project [ShipCountry#1777]
            :     :     :                          +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                             +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                   +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                      +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                         +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, to_date(RequiredDate#1942, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                            +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                               +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                  +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                     +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                        +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, to_date(ShippedDate#1943, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                           +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                              +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                 +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                    +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                       +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, to_date(OrderDate#1941, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                          +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                             +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#719, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                                +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#1946, ShipAddress#719, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :                                                                                   +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, coalesce(ShipAddress#1947, cast(Unknown as string)) AS ShipAddress#719, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :                                                                                      +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :     :                                                                                         +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :     :                                                                                            +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :     :                                                                                               +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, coalesce(Freight#1945, cast(0.0 as string)) AS Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                  +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#1951, cast(Unknown as string)) AS ShipCountry#534, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                     +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, coalesce(ShipPostalCode#1950, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#1951, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                        +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, coalesce(ShipRegion#1949, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#1950, ShipCountry#1951, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                           +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                              +- Deduplicate [Quantity#158, ShipCountry#1951, UnitPrice#179, ShipCity#1948, ShipVia#1944, Discount#199, CustomerID#1939, ShipRegion#1949, ShipName#1946, ShippedDate#1943, ShipPostalCode#1950, OrderID#1938, ShipAddress#1947, RequiredDate#1942, Freight#1945, EmployeeID#1940, ProductID#1953, OrderID1#1952, OrderDate#1941]
            :     :     :                                                                                                                 +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, OrderID1#1952, ProductID#1953, UnitPrice#179, Quantity#158, cast(Discount#1956 as float) AS Discount#199]
            :     :     :                                                                                                                    +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, OrderID1#1952, ProductID#1953, cast(UnitPrice#1954 as float) AS UnitPrice#179, Quantity#158, Discount#1956]
            :     :     :                                                                                                                       +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, OrderID1#1952, ProductID#1953, UnitPrice#1954, cast(Quantity#1955 as int) AS Quantity#158, Discount#1956]
            :     :     :                                                                                                                          +- Relation [OrderID#1938,CustomerID#1939,EmployeeID#1940,OrderDate#1941,RequiredDate#1942,ShippedDate#1943,ShipVia#1944,Freight#1945,ShipName#1946,ShipAddress#1947,ShipCity#1948,ShipRegion#1949,ShipPostalCode#1950,ShipCountry#1951,OrderID1#1952,ProductID#1953,UnitPrice#1954,Quantity#1955,Discount#1956] parquet
            :     :     +- Project [TaxCountry#2151, TaxYear#2146, TaxID#2156, TaxeRate#8]
            :     :        +- Join LeftOuter, (TaxCountry#2151 = ShipCountry#1777)
            :     :           :- Project [ID_Taxe#0 AS TaxID#2156, TaxCountry#2151, TaxeRate#8, TaxYear#2146]
            :     :           :  +- Project [ID_Taxe#0, Country#1600 AS TaxCountry#2151, TaxeRate#8, TaxYear#2146]
            :     :           :     +- Project [ID_Taxe#0, Country#1600, TaxeRate#8, Year#3 AS TaxYear#2146]
            :     :           :        +- Project [ID_Taxe#0, regexp_replace(Country#1595, [^a-zA-Z0-9\s], , 1) AS Country#1600, TaxeRate#8, Year#3]
            :     :           :           +- Project [ID_Taxe#0, coalesce(Country#1, cast(Unknown as string)) AS Country#1595, TaxeRate#8, Year#3]
            :     :           :              +- Deduplicate [ID_Taxe#0, Country#1, TaxeRate#8, Year#3]
            :     :           :                 +- Project [ID_Taxe#0, Country#1, cast(TaxeRate#2 as float) AS TaxeRate#8, Year#3]
            :     :           :                    +- Relation [ID_Taxe#0,Country#1,TaxeRate#2,Year#3] parquet
            :     :           +- Deduplicate [ShipCountry#1777]
            :     :              +- Project [ShipCountry#1777]
            :     :                 +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2217, year(ShippedDate#2103) AS Year#2124]
            :     :                    +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, to_date(ShippedDate#966, Some(dd/MM/yyyy), Some(Europe/Paris), false) AS ShippedDate#2103, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2217]
            :     :                       +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2217]
            :     :                          +- Join LeftOuter, ((ShipCountry#1777 = Country#1771) AND (cast(ShippedDate#966 as date) = date#1934))
            :     :                             :- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853]
            :     :                             :  +- Join Inner, (ProductID#2191 = ProductID#2195)
            :     :                             :     :- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :  +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :     +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :        +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :           +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :              +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, to_date(RequiredDate#2180, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                 +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                    +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                       +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                          +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                             +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, to_date(ShippedDate#2181, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                   +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                      +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                         +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                            +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, to_date(OrderDate#2179, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                               +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                                  +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#719, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                                     +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#2184, ShipAddress#719, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, Quantity#682, Discount#645]
            :     :                             :     :                                                        +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, coalesce(ShipAddress#2185, cast(Unknown as string)) AS ShipAddress#719, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, Quantity#682, Discount#645]
            :     :                             :     :                                                           +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :                             :     :                                                              +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :                             :     :                                                                 +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :                             :     :                                                                    +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, coalesce(Freight#2183, cast(0.0 as string)) AS Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                       +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#2189, cast(Unknown as string)) AS ShipCountry#534, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                          +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, coalesce(ShipPostalCode#2188, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#2189, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                             +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, coalesce(ShipRegion#2187, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#2188, ShipCountry#2189, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                                +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                                   +- Deduplicate [Quantity#158, ShipCountry#2189, UnitPrice#179, ShipCity#2186, ShipVia#2182, Discount#199, CustomerID#2177, ShipRegion#2187, ShipName#2184, ShippedDate#2181, ShipPostalCode#2188, OrderID#2176, ShipAddress#2185, RequiredDate#2180, Freight#2183, EmployeeID#2178, ProductID#2191, OrderID1#2190, OrderDate#2179]
            :     :                             :     :                                                                                      +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, OrderID1#2190, ProductID#2191, UnitPrice#179, Quantity#158, cast(Discount#2194 as float) AS Discount#199]
            :     :                             :     :                                                                                         +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, OrderID1#2190, ProductID#2191, cast(UnitPrice#2192 as float) AS UnitPrice#179, Quantity#158, Discount#2194]
            :     :                             :     :                                                                                            +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, OrderID1#2190, ProductID#2191, UnitPrice#2192, cast(Quantity#2193 as int) AS Quantity#158, Discount#2194]
            :     :                             :     :                                                                                               +- Relation [OrderID#2176,CustomerID#2177,EmployeeID#2178,OrderDate#2179,RequiredDate#2180,ShippedDate#2181,ShipVia#2182,Freight#2183,ShipName#2184,ShipAddress#2185,ShipCity#2186,ShipRegion#2187,ShipPostalCode#2188,ShipCountry#2189,OrderID1#2190,ProductID#2191,UnitPrice#2192,Quantity#2193,Discount#2194] parquet
            :     :                             :     +- Project [ProductID#2195, SupplierID#2197, Country#1796 AS MagasinCountry#1853]
            :     :                             :        +- Join Inner, (SupplierID#2197 = SupplierID#2205)
            :     :                             :           :- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :  +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :     +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :        +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, UnitPrice#1291, coalesce(UnitsInStock#2201, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :           +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, coalesce(UnitPrice#2200, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#2201, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :              +- Deduplicate [UnitPrice#2200, UnitsOnOrder#2202, CategoryID#2198, UnitsInStock#2201, SupplierID#2197, QuantityPerUnit#2199, Discontinued#2204, ProductID#2195, ProductName#2196, ReorderLevel#2203]
            :     :                             :           :                 +- Relation [ProductID#2195,ProductName#2196,SupplierID#2197,CategoryID#2198,QuantityPerUnit#2199,UnitPrice#2200,UnitsInStock#2201,UnitsOnOrder#2202,ReorderLevel#2203,Discontinued#2204] parquet
            :     :                             :           +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, trim(Country#1534, None) AS Country#1796, Phone#1521, Fax#1483, HomePage#2216]
            :     :                             :              +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, regexp_replace(Country#1383, [^a-zA-Z0-9\s], , 1) AS Country#1534, Phone#1521, Fax#1483, HomePage#2216]
            :     :                             :                 +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, Country#1383, CASE WHEN RLIKE(Phone#1508, ^[0-9.\-\(\) ]+$) THEN Phone#1508 ELSE Unknown END AS Phone#1521, Fax#1483, HomePage#2216]
            :     :                             :                    +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, Country#1383, coalesce(Phone#2214, cast(Unknown as string)) AS Phone#1508, Fax#1483, HomePage#2216]
            :     :                             :                       +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, Country#1383, Phone#2214, coalesce(Fax#2215, cast(Unknown as string)) AS Fax#1483, HomePage#2216]
            :     :                             :                          +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, coalesce(PostalCode#2212, cast(Unknown as string)) AS PostalCode#1458, Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                             +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, coalesce(City#2210, cast(Unknown as string)) AS City#1433, Region#2211, PostalCode#2212, Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                                +- Project [SupplierID#2205, coalesce(CompanyName#2206, cast(Unknown as string)) AS CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#2210, Region#2211, PostalCode#2212, Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                                   +- Project [SupplierID#2205, CompanyName#2206, ContactName#2207, ContactTitle#2208, Address#2209, City#2210, Region#2211, PostalCode#2212, coalesce(Country#2213, cast(Unknown as string)) AS Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                                      +- Deduplicate [CompanyName#2206, Country#2213, Address#2209, Region#2211, Fax#2215, Phone#2214, City#2210, SupplierID#2205, ContactName#2207, HomePage#2216, ContactTitle#2208, PostalCode#2212]
            :     :                             :                                         +- Relation [SupplierID#2205,CompanyName#2206,ContactName#2207,ContactTitle#2208,Address#2209,City#2210,Region#2211,PostalCode#2212,Country#2213,Phone#2214,Fax#2215,HomePage#2216] parquet
            :     :                             +- Project [ID_taux#2217, to_date(date#2218, Some(yyyy-MM-dd), Some(Europe/Paris), false) AS date#1934, Country#1771]
            :     :                                +- Project [ID_taux#2217, date#2218, Country#1771]
            :     :                                   +- Join Inner, (Country#1771 = ShipCountry#1777)
            :     :                                      :- Project [ID_taux#2217, date#2218, ratetoeuro#2219, trim(Country#2220, None) AS Country#1771, currency#2221]
            :     :                                      :  +- Relation [ID_taux#2217,date#2218,ratetoeuro#2219,Country#2220,currency#2221] parquet
            :     :                                      +- Deduplicate [ShipCountry#1777]
            :     :                                         +- Project [ShipCountry#1777]
            :     :                                            +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                               +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                  +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                     +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                        +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                           +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, to_date(RequiredDate#2226, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                              +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                 +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                    +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                       +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                          +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, to_date(ShippedDate#2227, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                             +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                   +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                      +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                         +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, to_date(OrderDate#2225, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                            +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                               +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#719, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                                  +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#2230, ShipAddress#719, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, Quantity#682, Discount#645]
            :     :                                                                                                     +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, coalesce(ShipAddress#2231, cast(Unknown as string)) AS ShipAddress#719, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, Quantity#682, Discount#645]
            :     :                                                                                                        +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :                                                                                                           +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :                                                                                                              +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :                                                                                                                 +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, coalesce(Freight#2229, cast(0.0 as string)) AS Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                    +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#2235, cast(Unknown as string)) AS ShipCountry#534, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                       +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, coalesce(ShipPostalCode#2234, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#2235, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                          +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, coalesce(ShipRegion#2233, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#2234, ShipCountry#2235, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                             +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                                +- Deduplicate [Quantity#158, ShipCountry#2235, UnitPrice#179, ShipCity#2232, ShipVia#2228, Discount#199, CustomerID#2223, ShipRegion#2233, ShipName#2230, ShippedDate#2227, ShipPostalCode#2234, OrderID#2222, ShipAddress#2231, RequiredDate#2226, Freight#2229, EmployeeID#2224, ProductID#2237, OrderID1#2236, OrderDate#2225]
            :     :                                                                                                                                   +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, OrderID1#2236, ProductID#2237, UnitPrice#179, Quantity#158, cast(Discount#2240 as float) AS Discount#199]
            :     :                                                                                                                                      +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, OrderID1#2236, ProductID#2237, cast(UnitPrice#2238 as float) AS UnitPrice#179, Quantity#158, Discount#2240]
            :     :                                                                                                                                         +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, OrderID1#2236, ProductID#2237, UnitPrice#2238, cast(Quantity#2239 as int) AS Quantity#158, Discount#2240]
            :     :                                                                                                                                            +- Relation [OrderID#2222,CustomerID#2223,EmployeeID#2224,OrderDate#2225,RequiredDate#2226,ShippedDate#2227,ShipVia#2228,Freight#2229,ShipName#2230,ShipAddress#2231,ShipCity#2232,ShipRegion#2233,ShipPostalCode#2234,ShipCountry#2235,OrderID1#2236,ProductID#2237,UnitPrice#2238,Quantity#2239,Discount#2240] parquet
            :     +- Project [CustomerID#74, Country#1253, Region#80]
            :        +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, regexp_replace(Country#1114, [^a-zA-Z0-9\s], , 1) AS Country#1253, Phone#1241, Fax#1206]
            :           +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, CASE WHEN RLIKE(Phone#1229, ^[0-9.\-\(\) ]+$) THEN Phone#1229 ELSE Unknown END AS Phone#1241, Fax#1206]
            :              +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, coalesce(Phone#83, cast(Unknown as string)) AS Phone#1229, Fax#1206]
            :                 +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, Phone#83, coalesce(Fax#84, cast(Unknown as string)) AS Fax#1206]
            :                    +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, coalesce(PostalCode#81, cast(Unknown as string)) AS PostalCode#1183, Country#1114, Phone#83, Fax#84]
            :                       +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, coalesce(City#79, cast(Unknown as string)) AS City#1160, Region#80, PostalCode#81, Country#1114, Phone#83, Fax#84]
            :                          +- Project [CustomerID#74, coalesce(CompanyName#75, cast(Unknown as string)) AS CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#79, Region#80, PostalCode#81, Country#1114, Phone#83, Fax#84]
            :                             +- Project [CustomerID#74, CompanyName#75, ContactName#76, ContactTitle#77, Address#78, City#79, Region#80, PostalCode#81, coalesce(Country#82, cast(Unknown as string)) AS Country#1114, Phone#83, Fax#84]
            :                                +- Deduplicate [CompanyName#75, Country#82, CustomerID#74, Address#78, Region#80, Fax#84, Phone#83, City#79, ContactName#76, ContactTitle#77, PostalCode#81]
            :                                   +- Relation [CustomerID#74,CompanyName#75,ContactName#76,ContactTitle#77,Address#78,City#79,Region#80,PostalCode#81,Country#82,Phone#83,Fax#84] parquet
            +- Project [ProductID#2371 AS ProduitID#2368, ProductName#2372]
               +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                  +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                     +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                        +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, UnitPrice#1291, coalesce(UnitsInStock#2377, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                           +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, coalesce(UnitPrice#2376, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#2377, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                              +- Deduplicate [UnitPrice#2376, UnitsOnOrder#2378, CategoryID#2374, UnitsInStock#2377, SupplierID#2373, QuantityPerUnit#2375, Discontinued#2380, ProductID#2371, ProductName#2372, ReorderLevel#2379]
                                 +- Relation [ProductID#2371,ProductName#2372,SupplierID#2373,CategoryID#2374,QuantityPerUnit#2375,UnitPrice#2376,UnitsInStock#2377,UnitsOnOrder#2378,ReorderLevel#2379,Discontinued#2380] parquet

2024-12-01 15:24:00,835 - ERROR - Erreur lors de la transformation et de la sauvegarde des données : [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `ratetoeuro` cannot be resolved. Did you mean one of the following? [`ID_taux`, `Year`, `CustomerID`, `Discount`, `Freight`].;
'Filter isnull('ratetoeuro)
+- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#2462, Country#1253, ... 3 more fields]
   +- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, coalesce(cast(TaxeRate#8 as double), 0.1) AS TaxeRate#2462, Country#1253, ... 2 more fields]
      +- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#8, Country#1253, ... 2 more fields]
         +- Join LeftOuter, (ProductID#51 = ProduitID#2368)
            :- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#8, Country#1253, Region#80]
            :  +- Join LeftOuter, (CustomerID#37 = CustomerID#74)
            :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#8]
            :     :  +- Join LeftOuter, ((ShipCountry#1777 = TaxCountry#2151) AND (Year#2124 = cast(TaxYear#2146 as int)))
            :     :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, year(ShippedDate#2103) AS Year#2124]
            :     :     :  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, to_date(ShippedDate#966, Some(dd/MM/yyyy), Some(Europe/Paris), false) AS ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148]
            :     :     :     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148]
            :     :     :        +- Join LeftOuter, ((ShipCountry#1777 = Country#1771) AND (cast(ShippedDate#966 as date) = date#1934))
            :     :     :           :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853]
            :     :     :           :  +- Join Inner, (ProductID#51 = ProductID#120)
            :     :     :           :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :        +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :           +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :              +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, to_date(RequiredDate#40, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                 +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                    +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                       +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                          +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                             +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, to_date(ShippedDate#41, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                   +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                      +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                         +- Project [OrderID#36, CustomerID#37, EmployeeID#38, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                            +- Project [OrderID#36, CustomerID#37, EmployeeID#38, to_date(OrderDate#39, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                               +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                                  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                                     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#44, ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :           :     :                                                        +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, coalesce(ShipAddress#45, cast(Unknown as string)) AS ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :           :     :                                                           +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :     :           :     :                                                              +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :     :           :     :                                                                 +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :     :           :     :                                                                    +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, coalesce(Freight#43, cast(0.0 as string)) AS Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                       +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#49, cast(Unknown as string)) AS ShipCountry#534, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                          +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, coalesce(ShipPostalCode#48, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                             +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, coalesce(ShipRegion#47, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#48, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                                +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                                   +- Deduplicate [Quantity#158, ShipCountry#49, UnitPrice#179, ShipCity#46, ShipVia#42, Discount#199, CustomerID#37, ShipRegion#47, ShipName#44, ShippedDate#41, ShipPostalCode#48, OrderID#36, ShipAddress#45, RequiredDate#40, Freight#43, EmployeeID#38, ProductID#51, OrderID1#50, OrderDate#39]
            :     :     :           :     :                                                                                      +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, UnitPrice#179, Quantity#158, cast(Discount#54 as float) AS Discount#199]
            :     :     :           :     :                                                                                         +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, cast(UnitPrice#52 as float) AS UnitPrice#179, Quantity#158, Discount#54]
            :     :     :           :     :                                                                                            +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, UnitPrice#52, cast(Quantity#53 as int) AS Quantity#158, Discount#54]
            :     :     :           :     :                                                                                               +- Relation [OrderID#36,CustomerID#37,EmployeeID#38,OrderDate#39,RequiredDate#40,ShippedDate#41,ShipVia#42,Freight#43,ShipName#44,ShipAddress#45,ShipCity#46,ShipRegion#47,ShipPostalCode#48,ShipCountry#49,OrderID1#50,ProductID#51,UnitPrice#52,Quantity#53,Discount#54] parquet
            :     :     :           :     +- Project [ProductID#120, SupplierID#122, Country#1796 AS MagasinCountry#1853]
            :     :     :           :        +- Join Inner, (SupplierID#122 = SupplierID#96)
            :     :     :           :           :- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :  +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :     +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :        +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1291, coalesce(UnitsInStock#126, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :           +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, coalesce(UnitPrice#125, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#126, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :              +- Deduplicate [UnitPrice#125, UnitsOnOrder#127, CategoryID#123, UnitsInStock#126, SupplierID#122, QuantityPerUnit#124, Discontinued#129, ProductID#120, ProductName#121, ReorderLevel#128]
            :     :     :           :           :                 +- Relation [ProductID#120,ProductName#121,SupplierID#122,CategoryID#123,QuantityPerUnit#124,UnitPrice#125,UnitsInStock#126,UnitsOnOrder#127,ReorderLevel#128,Discontinued#129] parquet
            :     :     :           :           +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, trim(Country#1534, None) AS Country#1796, Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :              +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, regexp_replace(Country#1383, [^a-zA-Z0-9\s], , 1) AS Country#1534, Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :                 +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, CASE WHEN RLIKE(Phone#1508, ^[0-9.\-\(\) ]+$) THEN Phone#1508 ELSE Unknown END AS Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :                    +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, coalesce(Phone#105, cast(Unknown as string)) AS Phone#1508, Fax#1483, HomePage#107]
            :     :     :           :                       +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, Phone#105, coalesce(Fax#106, cast(Unknown as string)) AS Fax#1483, HomePage#107]
            :     :     :           :                          +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, coalesce(PostalCode#103, cast(Unknown as string)) AS PostalCode#1458, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                             +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, coalesce(City#101, cast(Unknown as string)) AS City#1433, Region#102, PostalCode#103, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                +- Project [SupplierID#96, coalesce(CompanyName#97, cast(Unknown as string)) AS CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#101, Region#102, PostalCode#103, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                   +- Project [SupplierID#96, CompanyName#97, ContactName#98, ContactTitle#99, Address#100, City#101, Region#102, PostalCode#103, coalesce(Country#104, cast(Unknown as string)) AS Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                      +- Deduplicate [CompanyName#97, Country#104, Address#100, Region#102, Fax#106, Phone#105, City#101, SupplierID#96, ContactName#98, HomePage#107, ContactTitle#99, PostalCode#103]
            :     :     :           :                                         +- Relation [SupplierID#96,CompanyName#97,ContactName#98,ContactTitle#99,Address#100,City#101,Region#102,PostalCode#103,Country#104,Phone#105,Fax#106,HomePage#107] parquet
            :     :     :           +- Project [ID_taux#148, to_date(date#149, Some(yyyy-MM-dd), Some(Europe/Paris), false) AS date#1934, Country#1771]
            :     :     :              +- Project [ID_taux#148, date#149, Country#1771]
            :     :     :                 +- Join Inner, (Country#1771 = ShipCountry#1777)
            :     :     :                    :- Project [ID_taux#148, date#149, ratetoeuro#150, trim(Country#151, None) AS Country#1771, currency#152]
            :     :     :                    :  +- Relation [ID_taux#148,date#149,ratetoeuro#150,Country#151,currency#152] parquet
            :     :     :                    +- Deduplicate [ShipCountry#1777]
            :     :     :                       +- Project [ShipCountry#1777]
            :     :     :                          +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                             +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                   +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                      +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                         +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, to_date(RequiredDate#1942, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                            +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                               +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                  +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                     +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                        +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, to_date(ShippedDate#1943, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                           +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                              +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                 +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                    +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                       +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, to_date(OrderDate#1941, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                          +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                             +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#719, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                                +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#1946, ShipAddress#719, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :                                                                                   +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, coalesce(ShipAddress#1947, cast(Unknown as string)) AS ShipAddress#719, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :                                                                                      +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :     :                                                                                         +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :     :                                                                                            +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :     :                                                                                               +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, coalesce(Freight#1945, cast(0.0 as string)) AS Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                  +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#1951, cast(Unknown as string)) AS ShipCountry#534, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                     +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, coalesce(ShipPostalCode#1950, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#1951, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                        +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, coalesce(ShipRegion#1949, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#1950, ShipCountry#1951, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                           +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                              +- Deduplicate [Quantity#158, ShipCountry#1951, UnitPrice#179, ShipCity#1948, ShipVia#1944, Discount#199, CustomerID#1939, ShipRegion#1949, ShipName#1946, ShippedDate#1943, ShipPostalCode#1950, OrderID#1938, ShipAddress#1947, RequiredDate#1942, Freight#1945, EmployeeID#1940, ProductID#1953, OrderID1#1952, OrderDate#1941]
            :     :     :                                                                                                                 +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, OrderID1#1952, ProductID#1953, UnitPrice#179, Quantity#158, cast(Discount#1956 as float) AS Discount#199]
            :     :     :                                                                                                                    +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, OrderID1#1952, ProductID#1953, cast(UnitPrice#1954 as float) AS UnitPrice#179, Quantity#158, Discount#1956]
            :     :     :                                                                                                                       +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, OrderID1#1952, ProductID#1953, UnitPrice#1954, cast(Quantity#1955 as int) AS Quantity#158, Discount#1956]
            :     :     :                                                                                                                          +- Relation [OrderID#1938,CustomerID#1939,EmployeeID#1940,OrderDate#1941,RequiredDate#1942,ShippedDate#1943,ShipVia#1944,Freight#1945,ShipName#1946,ShipAddress#1947,ShipCity#1948,ShipRegion#1949,ShipPostalCode#1950,ShipCountry#1951,OrderID1#1952,ProductID#1953,UnitPrice#1954,Quantity#1955,Discount#1956] parquet
            :     :     +- Project [TaxCountry#2151, TaxYear#2146, TaxID#2156, TaxeRate#8]
            :     :        +- Join LeftOuter, (TaxCountry#2151 = ShipCountry#1777)
            :     :           :- Project [ID_Taxe#0 AS TaxID#2156, TaxCountry#2151, TaxeRate#8, TaxYear#2146]
            :     :           :  +- Project [ID_Taxe#0, Country#1600 AS TaxCountry#2151, TaxeRate#8, TaxYear#2146]
            :     :           :     +- Project [ID_Taxe#0, Country#1600, TaxeRate#8, Year#3 AS TaxYear#2146]
            :     :           :        +- Project [ID_Taxe#0, regexp_replace(Country#1595, [^a-zA-Z0-9\s], , 1) AS Country#1600, TaxeRate#8, Year#3]
            :     :           :           +- Project [ID_Taxe#0, coalesce(Country#1, cast(Unknown as string)) AS Country#1595, TaxeRate#8, Year#3]
            :     :           :              +- Deduplicate [ID_Taxe#0, Country#1, TaxeRate#8, Year#3]
            :     :           :                 +- Project [ID_Taxe#0, Country#1, cast(TaxeRate#2 as float) AS TaxeRate#8, Year#3]
            :     :           :                    +- Relation [ID_Taxe#0,Country#1,TaxeRate#2,Year#3] parquet
            :     :           +- Deduplicate [ShipCountry#1777]
            :     :              +- Project [ShipCountry#1777]
            :     :                 +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2217, year(ShippedDate#2103) AS Year#2124]
            :     :                    +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, to_date(ShippedDate#966, Some(dd/MM/yyyy), Some(Europe/Paris), false) AS ShippedDate#2103, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2217]
            :     :                       +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2217]
            :     :                          +- Join LeftOuter, ((ShipCountry#1777 = Country#1771) AND (cast(ShippedDate#966 as date) = date#1934))
            :     :                             :- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853]
            :     :                             :  +- Join Inner, (ProductID#2191 = ProductID#2195)
            :     :                             :     :- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :  +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :     +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :        +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :           +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :              +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, to_date(RequiredDate#2180, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                 +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                    +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                       +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                          +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                             +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, to_date(ShippedDate#2181, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                   +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                      +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                         +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                            +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, to_date(OrderDate#2179, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                               +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                                  +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#719, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                                     +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#2184, ShipAddress#719, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, Quantity#682, Discount#645]
            :     :                             :     :                                                        +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, coalesce(ShipAddress#2185, cast(Unknown as string)) AS ShipAddress#719, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, Quantity#682, Discount#645]
            :     :                             :     :                                                           +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :                             :     :                                                              +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :                             :     :                                                                 +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :                             :     :                                                                    +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, coalesce(Freight#2183, cast(0.0 as string)) AS Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                       +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#2189, cast(Unknown as string)) AS ShipCountry#534, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                          +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, coalesce(ShipPostalCode#2188, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#2189, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                             +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, coalesce(ShipRegion#2187, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#2188, ShipCountry#2189, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                                +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                                   +- Deduplicate [Quantity#158, ShipCountry#2189, UnitPrice#179, ShipCity#2186, ShipVia#2182, Discount#199, CustomerID#2177, ShipRegion#2187, ShipName#2184, ShippedDate#2181, ShipPostalCode#2188, OrderID#2176, ShipAddress#2185, RequiredDate#2180, Freight#2183, EmployeeID#2178, ProductID#2191, OrderID1#2190, OrderDate#2179]
            :     :                             :     :                                                                                      +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, OrderID1#2190, ProductID#2191, UnitPrice#179, Quantity#158, cast(Discount#2194 as float) AS Discount#199]
            :     :                             :     :                                                                                         +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, OrderID1#2190, ProductID#2191, cast(UnitPrice#2192 as float) AS UnitPrice#179, Quantity#158, Discount#2194]
            :     :                             :     :                                                                                            +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, OrderID1#2190, ProductID#2191, UnitPrice#2192, cast(Quantity#2193 as int) AS Quantity#158, Discount#2194]
            :     :                             :     :                                                                                               +- Relation [OrderID#2176,CustomerID#2177,EmployeeID#2178,OrderDate#2179,RequiredDate#2180,ShippedDate#2181,ShipVia#2182,Freight#2183,ShipName#2184,ShipAddress#2185,ShipCity#2186,ShipRegion#2187,ShipPostalCode#2188,ShipCountry#2189,OrderID1#2190,ProductID#2191,UnitPrice#2192,Quantity#2193,Discount#2194] parquet
            :     :                             :     +- Project [ProductID#2195, SupplierID#2197, Country#1796 AS MagasinCountry#1853]
            :     :                             :        +- Join Inner, (SupplierID#2197 = SupplierID#2205)
            :     :                             :           :- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :  +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :     +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :        +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, UnitPrice#1291, coalesce(UnitsInStock#2201, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :           +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, coalesce(UnitPrice#2200, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#2201, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :              +- Deduplicate [UnitPrice#2200, UnitsOnOrder#2202, CategoryID#2198, UnitsInStock#2201, SupplierID#2197, QuantityPerUnit#2199, Discontinued#2204, ProductID#2195, ProductName#2196, ReorderLevel#2203]
            :     :                             :           :                 +- Relation [ProductID#2195,ProductName#2196,SupplierID#2197,CategoryID#2198,QuantityPerUnit#2199,UnitPrice#2200,UnitsInStock#2201,UnitsOnOrder#2202,ReorderLevel#2203,Discontinued#2204] parquet
            :     :                             :           +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, trim(Country#1534, None) AS Country#1796, Phone#1521, Fax#1483, HomePage#2216]
            :     :                             :              +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, regexp_replace(Country#1383, [^a-zA-Z0-9\s], , 1) AS Country#1534, Phone#1521, Fax#1483, HomePage#2216]
            :     :                             :                 +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, Country#1383, CASE WHEN RLIKE(Phone#1508, ^[0-9.\-\(\) ]+$) THEN Phone#1508 ELSE Unknown END AS Phone#1521, Fax#1483, HomePage#2216]
            :     :                             :                    +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, Country#1383, coalesce(Phone#2214, cast(Unknown as string)) AS Phone#1508, Fax#1483, HomePage#2216]
            :     :                             :                       +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, Country#1383, Phone#2214, coalesce(Fax#2215, cast(Unknown as string)) AS Fax#1483, HomePage#2216]
            :     :                             :                          +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, coalesce(PostalCode#2212, cast(Unknown as string)) AS PostalCode#1458, Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                             +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, coalesce(City#2210, cast(Unknown as string)) AS City#1433, Region#2211, PostalCode#2212, Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                                +- Project [SupplierID#2205, coalesce(CompanyName#2206, cast(Unknown as string)) AS CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#2210, Region#2211, PostalCode#2212, Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                                   +- Project [SupplierID#2205, CompanyName#2206, ContactName#2207, ContactTitle#2208, Address#2209, City#2210, Region#2211, PostalCode#2212, coalesce(Country#2213, cast(Unknown as string)) AS Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                                      +- Deduplicate [CompanyName#2206, Country#2213, Address#2209, Region#2211, Fax#2215, Phone#2214, City#2210, SupplierID#2205, ContactName#2207, HomePage#2216, ContactTitle#2208, PostalCode#2212]
            :     :                             :                                         +- Relation [SupplierID#2205,CompanyName#2206,ContactName#2207,ContactTitle#2208,Address#2209,City#2210,Region#2211,PostalCode#2212,Country#2213,Phone#2214,Fax#2215,HomePage#2216] parquet
            :     :                             +- Project [ID_taux#2217, to_date(date#2218, Some(yyyy-MM-dd), Some(Europe/Paris), false) AS date#1934, Country#1771]
            :     :                                +- Project [ID_taux#2217, date#2218, Country#1771]
            :     :                                   +- Join Inner, (Country#1771 = ShipCountry#1777)
            :     :                                      :- Project [ID_taux#2217, date#2218, ratetoeuro#2219, trim(Country#2220, None) AS Country#1771, currency#2221]
            :     :                                      :  +- Relation [ID_taux#2217,date#2218,ratetoeuro#2219,Country#2220,currency#2221] parquet
            :     :                                      +- Deduplicate [ShipCountry#1777]
            :     :                                         +- Project [ShipCountry#1777]
            :     :                                            +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                               +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                  +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                     +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                        +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                           +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, to_date(RequiredDate#2226, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                              +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                 +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                    +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                       +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                          +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, to_date(ShippedDate#2227, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                             +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                   +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                      +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                         +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, to_date(OrderDate#2225, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                            +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                               +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#719, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                                  +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#2230, ShipAddress#719, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, Quantity#682, Discount#645]
            :     :                                                                                                     +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, coalesce(ShipAddress#2231, cast(Unknown as string)) AS ShipAddress#719, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, Quantity#682, Discount#645]
            :     :                                                                                                        +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :                                                                                                           +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :                                                                                                              +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :                                                                                                                 +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, coalesce(Freight#2229, cast(0.0 as string)) AS Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                    +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#2235, cast(Unknown as string)) AS ShipCountry#534, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                       +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, coalesce(ShipPostalCode#2234, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#2235, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                          +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, coalesce(ShipRegion#2233, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#2234, ShipCountry#2235, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                             +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                                +- Deduplicate [Quantity#158, ShipCountry#2235, UnitPrice#179, ShipCity#2232, ShipVia#2228, Discount#199, CustomerID#2223, ShipRegion#2233, ShipName#2230, ShippedDate#2227, ShipPostalCode#2234, OrderID#2222, ShipAddress#2231, RequiredDate#2226, Freight#2229, EmployeeID#2224, ProductID#2237, OrderID1#2236, OrderDate#2225]
            :     :                                                                                                                                   +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, OrderID1#2236, ProductID#2237, UnitPrice#179, Quantity#158, cast(Discount#2240 as float) AS Discount#199]
            :     :                                                                                                                                      +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, OrderID1#2236, ProductID#2237, cast(UnitPrice#2238 as float) AS UnitPrice#179, Quantity#158, Discount#2240]
            :     :                                                                                                                                         +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, OrderID1#2236, ProductID#2237, UnitPrice#2238, cast(Quantity#2239 as int) AS Quantity#158, Discount#2240]
            :     :                                                                                                                                            +- Relation [OrderID#2222,CustomerID#2223,EmployeeID#2224,OrderDate#2225,RequiredDate#2226,ShippedDate#2227,ShipVia#2228,Freight#2229,ShipName#2230,ShipAddress#2231,ShipCity#2232,ShipRegion#2233,ShipPostalCode#2234,ShipCountry#2235,OrderID1#2236,ProductID#2237,UnitPrice#2238,Quantity#2239,Discount#2240] parquet
            :     +- Project [CustomerID#74, Country#1253, Region#80]
            :        +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, regexp_replace(Country#1114, [^a-zA-Z0-9\s], , 1) AS Country#1253, Phone#1241, Fax#1206]
            :           +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, CASE WHEN RLIKE(Phone#1229, ^[0-9.\-\(\) ]+$) THEN Phone#1229 ELSE Unknown END AS Phone#1241, Fax#1206]
            :              +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, coalesce(Phone#83, cast(Unknown as string)) AS Phone#1229, Fax#1206]
            :                 +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, Phone#83, coalesce(Fax#84, cast(Unknown as string)) AS Fax#1206]
            :                    +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, coalesce(PostalCode#81, cast(Unknown as string)) AS PostalCode#1183, Country#1114, Phone#83, Fax#84]
            :                       +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, coalesce(City#79, cast(Unknown as string)) AS City#1160, Region#80, PostalCode#81, Country#1114, Phone#83, Fax#84]
            :                          +- Project [CustomerID#74, coalesce(CompanyName#75, cast(Unknown as string)) AS CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#79, Region#80, PostalCode#81, Country#1114, Phone#83, Fax#84]
            :                             +- Project [CustomerID#74, CompanyName#75, ContactName#76, ContactTitle#77, Address#78, City#79, Region#80, PostalCode#81, coalesce(Country#82, cast(Unknown as string)) AS Country#1114, Phone#83, Fax#84]
            :                                +- Deduplicate [CompanyName#75, Country#82, CustomerID#74, Address#78, Region#80, Fax#84, Phone#83, City#79, ContactName#76, ContactTitle#77, PostalCode#81]
            :                                   +- Relation [CustomerID#74,CompanyName#75,ContactName#76,ContactTitle#77,Address#78,City#79,Region#80,PostalCode#81,Country#82,Phone#83,Fax#84] parquet
            +- Project [ProductID#2371 AS ProduitID#2368, ProductName#2372]
               +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                  +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                     +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                        +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, UnitPrice#1291, coalesce(UnitsInStock#2377, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                           +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, coalesce(UnitPrice#2376, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#2377, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                              +- Deduplicate [UnitPrice#2376, UnitsOnOrder#2378, CategoryID#2374, UnitsInStock#2377, SupplierID#2373, QuantityPerUnit#2375, Discontinued#2380, ProductID#2371, ProductName#2372, ReorderLevel#2379]
                                 +- Relation [ProductID#2371,ProductName#2372,SupplierID#2373,CategoryID#2374,QuantityPerUnit#2375,UnitPrice#2376,UnitsInStock#2377,UnitsOnOrder#2378,ReorderLevel#2379,Discontinued#2380] parquet

2024-12-01 15:24:01,352 - INFO - Data cleaning process completed.
2024-12-01 15:24:01,355 - INFO - Closing down clientserver connection
2024-12-01 15:24:46,521 - ERROR - Removed 0 duplicate rows
2024-12-01 15:24:46,534 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 15:24:46,535 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:24:46,536 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:24:47,149 - ERROR - Removed 0 duplicate rows
2024-12-01 15:24:47,151 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:24:47,152 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:24:47,546 - ERROR - Removed 0 duplicate rows
2024-12-01 15:24:47,548 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:24:47,548 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:24:47,888 - ERROR - Removed 0 duplicate rows
2024-12-01 15:24:47,889 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:24:47,890 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:24:48,181 - ERROR - Removed 0 duplicate rows
2024-12-01 15:24:48,183 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:24:48,183 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:24:48,683 - ERROR - Removed 0 duplicate rows
2024-12-01 15:24:48,684 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:24:48,685 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:24:49,022 - ERROR - Removed 0 duplicate rows
2024-12-01 15:24:49,024 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:24:49,025 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:24:49,025 - ERROR - Starting cleaning for transactions
2024-12-01 15:24:49,121 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:24:49,156 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 15:24:49,178 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:24:49,195 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 15:24:49,267 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 15:24:49,268 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 15:24:49,337 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:24:49,337 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:24:49,405 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:24:49,406 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:24:49,406 - INFO - Finished cleaning for transactions
2024-12-01 15:24:49,406 - ERROR - Finished cleaning for transactions
2024-12-01 15:24:49,645 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 15:24:49,646 - ERROR - Starting cleaning for clients
2024-12-01 15:24:49,693 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:24:49,711 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:24:49,728 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:24:49,729 - INFO - Finished cleaning for clients
2024-12-01 15:24:49,729 - ERROR - Finished cleaning for clients
2024-12-01 15:24:49,872 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 15:24:49,873 - ERROR - Starting cleaning for produits
2024-12-01 15:24:49,884 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:24:49,897 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:24:49,932 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 15:24:49,933 - INFO - Finished cleaning for produits
2024-12-01 15:24:49,933 - ERROR - Finished cleaning for produits
2024-12-01 15:24:50,109 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 15:24:50,109 - ERROR - Starting cleaning for magasins
2024-12-01 15:24:50,143 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:24:50,154 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:24:50,167 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:24:50,169 - INFO - Finished cleaning for magasins
2024-12-01 15:24:50,169 - ERROR - Finished cleaning for magasins
2024-12-01 15:24:50,281 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 15:24:50,282 - ERROR - Starting cleaning for exchange
2024-12-01 15:24:50,288 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:24:50,299 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:24:50,300 - INFO - Finished cleaning for exchange
2024-12-01 15:24:50,300 - ERROR - Finished cleaning for exchange
2024-12-01 15:24:50,534 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 28130 rows after removing duplicates.
2024-12-01 15:24:50,535 - ERROR - Starting cleaning for rates
2024-12-01 15:24:50,542 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:24:50,550 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:24:50,552 - INFO - Finished cleaning for rates
2024-12-01 15:24:50,552 - ERROR - Finished cleaning for rates
2024-12-01 15:24:50,696 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 15:24:50,697 - ERROR - Starting cleaning for categories
2024-12-01 15:24:50,702 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:24:50,713 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 15:24:50,714 - INFO - Finished cleaning for categories
2024-12-01 15:24:50,714 - ERROR - Finished cleaning for categories
2024-12-01 15:24:50,818 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 15:24:51,015 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 15:24:51,178 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 15:24:51,328 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 15:24:51,512 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 15:24:51,541 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 15:24:51,541 - INFO - Début des jointures et des transformations.
2024-12-01 15:24:51,605 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 15:24:52,990 - ERROR - Calcul des taxes en cours...
2024-12-01 15:24:52,992 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'ID_taux']
2024-12-01 15:24:52,992 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 15:24:52,993 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 15:24:52,993 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 15:24:53,035 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 15:24:53,184 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 15:24:54,231 - ERROR - Calcul du taux de taxe terminé
2024-12-01 15:24:54,277 - ERROR - Calcul du prix après remise terminé
2024-12-01 15:24:54,448 - ERROR - Erreur lors de la transformation et de la sauvegarde des données : [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `ratetoeuro` cannot be resolved. Did you mean one of the following? [`ID_taux`, `Year`, `CustomerID`, `Discount`, `Freight`].;
'Filter isnull('ratetoeuro)
+- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#2462, Country#1253, ... 3 more fields]
   +- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, coalesce(cast(TaxeRate#8 as double), 0.1) AS TaxeRate#2462, Country#1253, ... 2 more fields]
      +- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#8, Country#1253, ... 2 more fields]
         +- Join LeftOuter, (ProductID#51 = ProduitID#2368)
            :- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#8, Country#1253, Region#80]
            :  +- Join LeftOuter, (CustomerID#37 = CustomerID#74)
            :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#8]
            :     :  +- Join LeftOuter, ((ShipCountry#1777 = TaxCountry#2151) AND (Year#2124 = cast(TaxYear#2146 as int)))
            :     :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, year(ShippedDate#2103) AS Year#2124]
            :     :     :  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, to_date(ShippedDate#966, Some(dd/MM/yyyy), Some(Europe/Paris), false) AS ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148]
            :     :     :     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148]
            :     :     :        +- Join LeftOuter, ((ShipCountry#1777 = Country#1771) AND (cast(ShippedDate#966 as date) = date#1934))
            :     :     :           :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853]
            :     :     :           :  +- Join Inner, (ProductID#51 = ProductID#120)
            :     :     :           :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :        +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :           +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :              +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, to_date(RequiredDate#40, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                 +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                    +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                       +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                          +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                             +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, to_date(ShippedDate#41, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                   +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                      +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                         +- Project [OrderID#36, CustomerID#37, EmployeeID#38, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                            +- Project [OrderID#36, CustomerID#37, EmployeeID#38, to_date(OrderDate#39, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                               +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                                  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                                     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#44, ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :           :     :                                                        +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, coalesce(ShipAddress#45, cast(Unknown as string)) AS ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :           :     :                                                           +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :     :           :     :                                                              +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :     :           :     :                                                                 +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :     :           :     :                                                                    +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, coalesce(Freight#43, cast(0.0 as string)) AS Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                       +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#49, cast(Unknown as string)) AS ShipCountry#534, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                          +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, coalesce(ShipPostalCode#48, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                             +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, coalesce(ShipRegion#47, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#48, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                                +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                                   +- Deduplicate [Quantity#158, ShipCountry#49, UnitPrice#179, ShipCity#46, ShipVia#42, Discount#199, CustomerID#37, ShipRegion#47, ShipName#44, ShippedDate#41, ShipPostalCode#48, OrderID#36, ShipAddress#45, RequiredDate#40, Freight#43, EmployeeID#38, ProductID#51, OrderID1#50, OrderDate#39]
            :     :     :           :     :                                                                                      +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, UnitPrice#179, Quantity#158, cast(Discount#54 as float) AS Discount#199]
            :     :     :           :     :                                                                                         +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, cast(UnitPrice#52 as float) AS UnitPrice#179, Quantity#158, Discount#54]
            :     :     :           :     :                                                                                            +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, UnitPrice#52, cast(Quantity#53 as int) AS Quantity#158, Discount#54]
            :     :     :           :     :                                                                                               +- Relation [OrderID#36,CustomerID#37,EmployeeID#38,OrderDate#39,RequiredDate#40,ShippedDate#41,ShipVia#42,Freight#43,ShipName#44,ShipAddress#45,ShipCity#46,ShipRegion#47,ShipPostalCode#48,ShipCountry#49,OrderID1#50,ProductID#51,UnitPrice#52,Quantity#53,Discount#54] parquet
            :     :     :           :     +- Project [ProductID#120, SupplierID#122, Country#1796 AS MagasinCountry#1853]
            :     :     :           :        +- Join Inner, (SupplierID#122 = SupplierID#96)
            :     :     :           :           :- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :  +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :     +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :        +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1291, coalesce(UnitsInStock#126, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :           +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, coalesce(UnitPrice#125, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#126, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :              +- Deduplicate [UnitPrice#125, UnitsOnOrder#127, CategoryID#123, UnitsInStock#126, SupplierID#122, QuantityPerUnit#124, Discontinued#129, ProductID#120, ProductName#121, ReorderLevel#128]
            :     :     :           :           :                 +- Relation [ProductID#120,ProductName#121,SupplierID#122,CategoryID#123,QuantityPerUnit#124,UnitPrice#125,UnitsInStock#126,UnitsOnOrder#127,ReorderLevel#128,Discontinued#129] parquet
            :     :     :           :           +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, trim(Country#1534, None) AS Country#1796, Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :              +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, regexp_replace(Country#1383, [^a-zA-Z0-9\s], , 1) AS Country#1534, Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :                 +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, CASE WHEN RLIKE(Phone#1508, ^[0-9.\-\(\) ]+$) THEN Phone#1508 ELSE Unknown END AS Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :                    +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, coalesce(Phone#105, cast(Unknown as string)) AS Phone#1508, Fax#1483, HomePage#107]
            :     :     :           :                       +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, Phone#105, coalesce(Fax#106, cast(Unknown as string)) AS Fax#1483, HomePage#107]
            :     :     :           :                          +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, coalesce(PostalCode#103, cast(Unknown as string)) AS PostalCode#1458, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                             +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, coalesce(City#101, cast(Unknown as string)) AS City#1433, Region#102, PostalCode#103, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                +- Project [SupplierID#96, coalesce(CompanyName#97, cast(Unknown as string)) AS CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#101, Region#102, PostalCode#103, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                   +- Project [SupplierID#96, CompanyName#97, ContactName#98, ContactTitle#99, Address#100, City#101, Region#102, PostalCode#103, coalesce(Country#104, cast(Unknown as string)) AS Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                      +- Deduplicate [CompanyName#97, Country#104, Address#100, Region#102, Fax#106, Phone#105, City#101, SupplierID#96, ContactName#98, HomePage#107, ContactTitle#99, PostalCode#103]
            :     :     :           :                                         +- Relation [SupplierID#96,CompanyName#97,ContactName#98,ContactTitle#99,Address#100,City#101,Region#102,PostalCode#103,Country#104,Phone#105,Fax#106,HomePage#107] parquet
            :     :     :           +- Project [ID_taux#148, to_date(date#149, Some(yyyy-MM-dd), Some(Europe/Paris), false) AS date#1934, Country#1771]
            :     :     :              +- Project [ID_taux#148, date#149, Country#1771]
            :     :     :                 +- Join Inner, (Country#1771 = ShipCountry#1777)
            :     :     :                    :- Project [ID_taux#148, date#149, ratetoeuro#150, trim(Country#151, None) AS Country#1771, currency#152]
            :     :     :                    :  +- Relation [ID_taux#148,date#149,ratetoeuro#150,Country#151,currency#152] parquet
            :     :     :                    +- Deduplicate [ShipCountry#1777]
            :     :     :                       +- Project [ShipCountry#1777]
            :     :     :                          +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                             +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                   +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                      +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                         +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, to_date(RequiredDate#1942, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                            +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                               +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                  +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                     +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                        +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, to_date(ShippedDate#1943, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                           +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                              +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                 +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                    +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                       +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, to_date(OrderDate#1941, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                          +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                             +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#719, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                                +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#1946, ShipAddress#719, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :                                                                                   +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, coalesce(ShipAddress#1947, cast(Unknown as string)) AS ShipAddress#719, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :                                                                                      +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :     :                                                                                         +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :     :                                                                                            +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :     :                                                                                               +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, coalesce(Freight#1945, cast(0.0 as string)) AS Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                  +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#1951, cast(Unknown as string)) AS ShipCountry#534, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                     +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, coalesce(ShipPostalCode#1950, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#1951, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                        +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, coalesce(ShipRegion#1949, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#1950, ShipCountry#1951, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                           +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                              +- Deduplicate [Quantity#158, ShipCountry#1951, UnitPrice#179, ShipCity#1948, ShipVia#1944, Discount#199, CustomerID#1939, ShipRegion#1949, ShipName#1946, ShippedDate#1943, ShipPostalCode#1950, OrderID#1938, ShipAddress#1947, RequiredDate#1942, Freight#1945, EmployeeID#1940, ProductID#1953, OrderID1#1952, OrderDate#1941]
            :     :     :                                                                                                                 +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, OrderID1#1952, ProductID#1953, UnitPrice#179, Quantity#158, cast(Discount#1956 as float) AS Discount#199]
            :     :     :                                                                                                                    +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, OrderID1#1952, ProductID#1953, cast(UnitPrice#1954 as float) AS UnitPrice#179, Quantity#158, Discount#1956]
            :     :     :                                                                                                                       +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, OrderID1#1952, ProductID#1953, UnitPrice#1954, cast(Quantity#1955 as int) AS Quantity#158, Discount#1956]
            :     :     :                                                                                                                          +- Relation [OrderID#1938,CustomerID#1939,EmployeeID#1940,OrderDate#1941,RequiredDate#1942,ShippedDate#1943,ShipVia#1944,Freight#1945,ShipName#1946,ShipAddress#1947,ShipCity#1948,ShipRegion#1949,ShipPostalCode#1950,ShipCountry#1951,OrderID1#1952,ProductID#1953,UnitPrice#1954,Quantity#1955,Discount#1956] parquet
            :     :     +- Project [TaxCountry#2151, TaxYear#2146, TaxID#2156, TaxeRate#8]
            :     :        +- Join LeftOuter, (TaxCountry#2151 = ShipCountry#1777)
            :     :           :- Project [ID_Taxe#0 AS TaxID#2156, TaxCountry#2151, TaxeRate#8, TaxYear#2146]
            :     :           :  +- Project [ID_Taxe#0, Country#1600 AS TaxCountry#2151, TaxeRate#8, TaxYear#2146]
            :     :           :     +- Project [ID_Taxe#0, Country#1600, TaxeRate#8, Year#3 AS TaxYear#2146]
            :     :           :        +- Project [ID_Taxe#0, regexp_replace(Country#1595, [^a-zA-Z0-9\s], , 1) AS Country#1600, TaxeRate#8, Year#3]
            :     :           :           +- Project [ID_Taxe#0, coalesce(Country#1, cast(Unknown as string)) AS Country#1595, TaxeRate#8, Year#3]
            :     :           :              +- Deduplicate [ID_Taxe#0, Country#1, TaxeRate#8, Year#3]
            :     :           :                 +- Project [ID_Taxe#0, Country#1, cast(TaxeRate#2 as float) AS TaxeRate#8, Year#3]
            :     :           :                    +- Relation [ID_Taxe#0,Country#1,TaxeRate#2,Year#3] parquet
            :     :           +- Deduplicate [ShipCountry#1777]
            :     :              +- Project [ShipCountry#1777]
            :     :                 +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2217, year(ShippedDate#2103) AS Year#2124]
            :     :                    +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, to_date(ShippedDate#966, Some(dd/MM/yyyy), Some(Europe/Paris), false) AS ShippedDate#2103, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2217]
            :     :                       +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2217]
            :     :                          +- Join LeftOuter, ((ShipCountry#1777 = Country#1771) AND (cast(ShippedDate#966 as date) = date#1934))
            :     :                             :- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853]
            :     :                             :  +- Join Inner, (ProductID#2191 = ProductID#2195)
            :     :                             :     :- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :  +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :     +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :        +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :           +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :              +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, to_date(RequiredDate#2180, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                 +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                    +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                       +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                          +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                             +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, to_date(ShippedDate#2181, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                   +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                      +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                         +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                            +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, to_date(OrderDate#2179, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                               +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                                  +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#719, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                                     +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#2184, ShipAddress#719, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, Quantity#682, Discount#645]
            :     :                             :     :                                                        +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, coalesce(ShipAddress#2185, cast(Unknown as string)) AS ShipAddress#719, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, Quantity#682, Discount#645]
            :     :                             :     :                                                           +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :                             :     :                                                              +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :                             :     :                                                                 +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :                             :     :                                                                    +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, coalesce(Freight#2183, cast(0.0 as string)) AS Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                       +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#2189, cast(Unknown as string)) AS ShipCountry#534, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                          +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, coalesce(ShipPostalCode#2188, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#2189, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                             +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, coalesce(ShipRegion#2187, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#2188, ShipCountry#2189, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                                +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                                   +- Deduplicate [Quantity#158, ShipCountry#2189, UnitPrice#179, ShipCity#2186, ShipVia#2182, Discount#199, CustomerID#2177, ShipRegion#2187, ShipName#2184, ShippedDate#2181, ShipPostalCode#2188, OrderID#2176, ShipAddress#2185, RequiredDate#2180, Freight#2183, EmployeeID#2178, ProductID#2191, OrderID1#2190, OrderDate#2179]
            :     :                             :     :                                                                                      +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, OrderID1#2190, ProductID#2191, UnitPrice#179, Quantity#158, cast(Discount#2194 as float) AS Discount#199]
            :     :                             :     :                                                                                         +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, OrderID1#2190, ProductID#2191, cast(UnitPrice#2192 as float) AS UnitPrice#179, Quantity#158, Discount#2194]
            :     :                             :     :                                                                                            +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, OrderID1#2190, ProductID#2191, UnitPrice#2192, cast(Quantity#2193 as int) AS Quantity#158, Discount#2194]
            :     :                             :     :                                                                                               +- Relation [OrderID#2176,CustomerID#2177,EmployeeID#2178,OrderDate#2179,RequiredDate#2180,ShippedDate#2181,ShipVia#2182,Freight#2183,ShipName#2184,ShipAddress#2185,ShipCity#2186,ShipRegion#2187,ShipPostalCode#2188,ShipCountry#2189,OrderID1#2190,ProductID#2191,UnitPrice#2192,Quantity#2193,Discount#2194] parquet
            :     :                             :     +- Project [ProductID#2195, SupplierID#2197, Country#1796 AS MagasinCountry#1853]
            :     :                             :        +- Join Inner, (SupplierID#2197 = SupplierID#2205)
            :     :                             :           :- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :  +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :     +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :        +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, UnitPrice#1291, coalesce(UnitsInStock#2201, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :           +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, coalesce(UnitPrice#2200, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#2201, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :              +- Deduplicate [UnitPrice#2200, UnitsOnOrder#2202, CategoryID#2198, UnitsInStock#2201, SupplierID#2197, QuantityPerUnit#2199, Discontinued#2204, ProductID#2195, ProductName#2196, ReorderLevel#2203]
            :     :                             :           :                 +- Relation [ProductID#2195,ProductName#2196,SupplierID#2197,CategoryID#2198,QuantityPerUnit#2199,UnitPrice#2200,UnitsInStock#2201,UnitsOnOrder#2202,ReorderLevel#2203,Discontinued#2204] parquet
            :     :                             :           +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, trim(Country#1534, None) AS Country#1796, Phone#1521, Fax#1483, HomePage#2216]
            :     :                             :              +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, regexp_replace(Country#1383, [^a-zA-Z0-9\s], , 1) AS Country#1534, Phone#1521, Fax#1483, HomePage#2216]
            :     :                             :                 +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, Country#1383, CASE WHEN RLIKE(Phone#1508, ^[0-9.\-\(\) ]+$) THEN Phone#1508 ELSE Unknown END AS Phone#1521, Fax#1483, HomePage#2216]
            :     :                             :                    +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, Country#1383, coalesce(Phone#2214, cast(Unknown as string)) AS Phone#1508, Fax#1483, HomePage#2216]
            :     :                             :                       +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, Country#1383, Phone#2214, coalesce(Fax#2215, cast(Unknown as string)) AS Fax#1483, HomePage#2216]
            :     :                             :                          +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, coalesce(PostalCode#2212, cast(Unknown as string)) AS PostalCode#1458, Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                             +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, coalesce(City#2210, cast(Unknown as string)) AS City#1433, Region#2211, PostalCode#2212, Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                                +- Project [SupplierID#2205, coalesce(CompanyName#2206, cast(Unknown as string)) AS CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#2210, Region#2211, PostalCode#2212, Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                                   +- Project [SupplierID#2205, CompanyName#2206, ContactName#2207, ContactTitle#2208, Address#2209, City#2210, Region#2211, PostalCode#2212, coalesce(Country#2213, cast(Unknown as string)) AS Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                                      +- Deduplicate [CompanyName#2206, Country#2213, Address#2209, Region#2211, Fax#2215, Phone#2214, City#2210, SupplierID#2205, ContactName#2207, HomePage#2216, ContactTitle#2208, PostalCode#2212]
            :     :                             :                                         +- Relation [SupplierID#2205,CompanyName#2206,ContactName#2207,ContactTitle#2208,Address#2209,City#2210,Region#2211,PostalCode#2212,Country#2213,Phone#2214,Fax#2215,HomePage#2216] parquet
            :     :                             +- Project [ID_taux#2217, to_date(date#2218, Some(yyyy-MM-dd), Some(Europe/Paris), false) AS date#1934, Country#1771]
            :     :                                +- Project [ID_taux#2217, date#2218, Country#1771]
            :     :                                   +- Join Inner, (Country#1771 = ShipCountry#1777)
            :     :                                      :- Project [ID_taux#2217, date#2218, ratetoeuro#2219, trim(Country#2220, None) AS Country#1771, currency#2221]
            :     :                                      :  +- Relation [ID_taux#2217,date#2218,ratetoeuro#2219,Country#2220,currency#2221] parquet
            :     :                                      +- Deduplicate [ShipCountry#1777]
            :     :                                         +- Project [ShipCountry#1777]
            :     :                                            +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                               +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                  +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                     +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                        +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                           +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, to_date(RequiredDate#2226, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                              +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                 +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                    +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                       +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                          +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, to_date(ShippedDate#2227, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                             +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                   +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                      +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                         +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, to_date(OrderDate#2225, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                            +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                               +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#719, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                                  +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#2230, ShipAddress#719, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, Quantity#682, Discount#645]
            :     :                                                                                                     +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, coalesce(ShipAddress#2231, cast(Unknown as string)) AS ShipAddress#719, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, Quantity#682, Discount#645]
            :     :                                                                                                        +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :                                                                                                           +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :                                                                                                              +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :                                                                                                                 +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, coalesce(Freight#2229, cast(0.0 as string)) AS Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                    +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#2235, cast(Unknown as string)) AS ShipCountry#534, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                       +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, coalesce(ShipPostalCode#2234, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#2235, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                          +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, coalesce(ShipRegion#2233, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#2234, ShipCountry#2235, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                             +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                                +- Deduplicate [Quantity#158, ShipCountry#2235, UnitPrice#179, ShipCity#2232, ShipVia#2228, Discount#199, CustomerID#2223, ShipRegion#2233, ShipName#2230, ShippedDate#2227, ShipPostalCode#2234, OrderID#2222, ShipAddress#2231, RequiredDate#2226, Freight#2229, EmployeeID#2224, ProductID#2237, OrderID1#2236, OrderDate#2225]
            :     :                                                                                                                                   +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, OrderID1#2236, ProductID#2237, UnitPrice#179, Quantity#158, cast(Discount#2240 as float) AS Discount#199]
            :     :                                                                                                                                      +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, OrderID1#2236, ProductID#2237, cast(UnitPrice#2238 as float) AS UnitPrice#179, Quantity#158, Discount#2240]
            :     :                                                                                                                                         +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, OrderID1#2236, ProductID#2237, UnitPrice#2238, cast(Quantity#2239 as int) AS Quantity#158, Discount#2240]
            :     :                                                                                                                                            +- Relation [OrderID#2222,CustomerID#2223,EmployeeID#2224,OrderDate#2225,RequiredDate#2226,ShippedDate#2227,ShipVia#2228,Freight#2229,ShipName#2230,ShipAddress#2231,ShipCity#2232,ShipRegion#2233,ShipPostalCode#2234,ShipCountry#2235,OrderID1#2236,ProductID#2237,UnitPrice#2238,Quantity#2239,Discount#2240] parquet
            :     +- Project [CustomerID#74, Country#1253, Region#80]
            :        +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, regexp_replace(Country#1114, [^a-zA-Z0-9\s], , 1) AS Country#1253, Phone#1241, Fax#1206]
            :           +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, CASE WHEN RLIKE(Phone#1229, ^[0-9.\-\(\) ]+$) THEN Phone#1229 ELSE Unknown END AS Phone#1241, Fax#1206]
            :              +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, coalesce(Phone#83, cast(Unknown as string)) AS Phone#1229, Fax#1206]
            :                 +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, Phone#83, coalesce(Fax#84, cast(Unknown as string)) AS Fax#1206]
            :                    +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, coalesce(PostalCode#81, cast(Unknown as string)) AS PostalCode#1183, Country#1114, Phone#83, Fax#84]
            :                       +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, coalesce(City#79, cast(Unknown as string)) AS City#1160, Region#80, PostalCode#81, Country#1114, Phone#83, Fax#84]
            :                          +- Project [CustomerID#74, coalesce(CompanyName#75, cast(Unknown as string)) AS CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#79, Region#80, PostalCode#81, Country#1114, Phone#83, Fax#84]
            :                             +- Project [CustomerID#74, CompanyName#75, ContactName#76, ContactTitle#77, Address#78, City#79, Region#80, PostalCode#81, coalesce(Country#82, cast(Unknown as string)) AS Country#1114, Phone#83, Fax#84]
            :                                +- Deduplicate [CompanyName#75, Country#82, CustomerID#74, Address#78, Region#80, Fax#84, Phone#83, City#79, ContactName#76, ContactTitle#77, PostalCode#81]
            :                                   +- Relation [CustomerID#74,CompanyName#75,ContactName#76,ContactTitle#77,Address#78,City#79,Region#80,PostalCode#81,Country#82,Phone#83,Fax#84] parquet
            +- Project [ProductID#2371 AS ProduitID#2368, ProductName#2372]
               +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                  +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                     +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                        +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, UnitPrice#1291, coalesce(UnitsInStock#2377, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                           +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, coalesce(UnitPrice#2376, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#2377, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                              +- Deduplicate [UnitPrice#2376, UnitsOnOrder#2378, CategoryID#2374, UnitsInStock#2377, SupplierID#2373, QuantityPerUnit#2375, Discontinued#2380, ProductID#2371, ProductName#2372, ReorderLevel#2379]
                                 +- Relation [ProductID#2371,ProductName#2372,SupplierID#2373,CategoryID#2374,QuantityPerUnit#2375,UnitPrice#2376,UnitsInStock#2377,UnitsOnOrder#2378,ReorderLevel#2379,Discontinued#2380] parquet

2024-12-01 15:24:54,493 - ERROR - Erreur lors de la transformation et de la sauvegarde des données : [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `ratetoeuro` cannot be resolved. Did you mean one of the following? [`ID_taux`, `Year`, `CustomerID`, `Discount`, `Freight`].;
'Filter isnull('ratetoeuro)
+- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#2462, Country#1253, ... 3 more fields]
   +- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, coalesce(cast(TaxeRate#8 as double), 0.1) AS TaxeRate#2462, Country#1253, ... 2 more fields]
      +- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#8, Country#1253, ... 2 more fields]
         +- Join LeftOuter, (ProductID#51 = ProduitID#2368)
            :- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#8, Country#1253, Region#80]
            :  +- Join LeftOuter, (CustomerID#37 = CustomerID#74)
            :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#8]
            :     :  +- Join LeftOuter, ((ShipCountry#1777 = TaxCountry#2151) AND (Year#2124 = cast(TaxYear#2146 as int)))
            :     :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, year(ShippedDate#2103) AS Year#2124]
            :     :     :  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, to_date(ShippedDate#966, Some(dd/MM/yyyy), Some(Europe/Paris), false) AS ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148]
            :     :     :     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148]
            :     :     :        +- Join LeftOuter, ((ShipCountry#1777 = Country#1771) AND (cast(ShippedDate#966 as date) = date#1934))
            :     :     :           :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853]
            :     :     :           :  +- Join Inner, (ProductID#51 = ProductID#120)
            :     :     :           :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :        +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :           +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :              +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, to_date(RequiredDate#40, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                 +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                    +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                       +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                          +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                             +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, to_date(ShippedDate#41, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                   +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                      +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                         +- Project [OrderID#36, CustomerID#37, EmployeeID#38, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                            +- Project [OrderID#36, CustomerID#37, EmployeeID#38, to_date(OrderDate#39, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                               +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                                  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                                     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#44, ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :           :     :                                                        +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, coalesce(ShipAddress#45, cast(Unknown as string)) AS ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :           :     :                                                           +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :     :           :     :                                                              +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :     :           :     :                                                                 +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :     :           :     :                                                                    +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, coalesce(Freight#43, cast(0.0 as string)) AS Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                       +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#49, cast(Unknown as string)) AS ShipCountry#534, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                          +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, coalesce(ShipPostalCode#48, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                             +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, coalesce(ShipRegion#47, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#48, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                                +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                                   +- Deduplicate [Quantity#158, ShipCountry#49, UnitPrice#179, ShipCity#46, ShipVia#42, Discount#199, CustomerID#37, ShipRegion#47, ShipName#44, ShippedDate#41, ShipPostalCode#48, OrderID#36, ShipAddress#45, RequiredDate#40, Freight#43, EmployeeID#38, ProductID#51, OrderID1#50, OrderDate#39]
            :     :     :           :     :                                                                                      +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, UnitPrice#179, Quantity#158, cast(Discount#54 as float) AS Discount#199]
            :     :     :           :     :                                                                                         +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, cast(UnitPrice#52 as float) AS UnitPrice#179, Quantity#158, Discount#54]
            :     :     :           :     :                                                                                            +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, UnitPrice#52, cast(Quantity#53 as int) AS Quantity#158, Discount#54]
            :     :     :           :     :                                                                                               +- Relation [OrderID#36,CustomerID#37,EmployeeID#38,OrderDate#39,RequiredDate#40,ShippedDate#41,ShipVia#42,Freight#43,ShipName#44,ShipAddress#45,ShipCity#46,ShipRegion#47,ShipPostalCode#48,ShipCountry#49,OrderID1#50,ProductID#51,UnitPrice#52,Quantity#53,Discount#54] parquet
            :     :     :           :     +- Project [ProductID#120, SupplierID#122, Country#1796 AS MagasinCountry#1853]
            :     :     :           :        +- Join Inner, (SupplierID#122 = SupplierID#96)
            :     :     :           :           :- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :  +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :     +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :        +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1291, coalesce(UnitsInStock#126, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :           +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, coalesce(UnitPrice#125, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#126, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :              +- Deduplicate [UnitPrice#125, UnitsOnOrder#127, CategoryID#123, UnitsInStock#126, SupplierID#122, QuantityPerUnit#124, Discontinued#129, ProductID#120, ProductName#121, ReorderLevel#128]
            :     :     :           :           :                 +- Relation [ProductID#120,ProductName#121,SupplierID#122,CategoryID#123,QuantityPerUnit#124,UnitPrice#125,UnitsInStock#126,UnitsOnOrder#127,ReorderLevel#128,Discontinued#129] parquet
            :     :     :           :           +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, trim(Country#1534, None) AS Country#1796, Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :              +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, regexp_replace(Country#1383, [^a-zA-Z0-9\s], , 1) AS Country#1534, Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :                 +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, CASE WHEN RLIKE(Phone#1508, ^[0-9.\-\(\) ]+$) THEN Phone#1508 ELSE Unknown END AS Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :                    +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, coalesce(Phone#105, cast(Unknown as string)) AS Phone#1508, Fax#1483, HomePage#107]
            :     :     :           :                       +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, Phone#105, coalesce(Fax#106, cast(Unknown as string)) AS Fax#1483, HomePage#107]
            :     :     :           :                          +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, coalesce(PostalCode#103, cast(Unknown as string)) AS PostalCode#1458, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                             +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, coalesce(City#101, cast(Unknown as string)) AS City#1433, Region#102, PostalCode#103, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                +- Project [SupplierID#96, coalesce(CompanyName#97, cast(Unknown as string)) AS CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#101, Region#102, PostalCode#103, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                   +- Project [SupplierID#96, CompanyName#97, ContactName#98, ContactTitle#99, Address#100, City#101, Region#102, PostalCode#103, coalesce(Country#104, cast(Unknown as string)) AS Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                      +- Deduplicate [CompanyName#97, Country#104, Address#100, Region#102, Fax#106, Phone#105, City#101, SupplierID#96, ContactName#98, HomePage#107, ContactTitle#99, PostalCode#103]
            :     :     :           :                                         +- Relation [SupplierID#96,CompanyName#97,ContactName#98,ContactTitle#99,Address#100,City#101,Region#102,PostalCode#103,Country#104,Phone#105,Fax#106,HomePage#107] parquet
            :     :     :           +- Project [ID_taux#148, to_date(date#149, Some(yyyy-MM-dd), Some(Europe/Paris), false) AS date#1934, Country#1771]
            :     :     :              +- Project [ID_taux#148, date#149, Country#1771]
            :     :     :                 +- Join Inner, (Country#1771 = ShipCountry#1777)
            :     :     :                    :- Project [ID_taux#148, date#149, ratetoeuro#150, trim(Country#151, None) AS Country#1771, currency#152]
            :     :     :                    :  +- Relation [ID_taux#148,date#149,ratetoeuro#150,Country#151,currency#152] parquet
            :     :     :                    +- Deduplicate [ShipCountry#1777]
            :     :     :                       +- Project [ShipCountry#1777]
            :     :     :                          +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                             +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                   +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                      +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                         +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, to_date(RequiredDate#1942, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                            +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                               +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                  +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                     +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                        +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, to_date(ShippedDate#1943, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                           +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                              +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                 +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                    +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                       +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, to_date(OrderDate#1941, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                          +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                             +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#719, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                                +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#1946, ShipAddress#719, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :                                                                                   +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, coalesce(ShipAddress#1947, cast(Unknown as string)) AS ShipAddress#719, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :                                                                                      +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :     :                                                                                         +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :     :                                                                                            +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :     :                                                                                               +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, coalesce(Freight#1945, cast(0.0 as string)) AS Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                  +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#1951, cast(Unknown as string)) AS ShipCountry#534, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                     +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, coalesce(ShipPostalCode#1950, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#1951, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                        +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, coalesce(ShipRegion#1949, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#1950, ShipCountry#1951, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                           +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                              +- Deduplicate [Quantity#158, ShipCountry#1951, UnitPrice#179, ShipCity#1948, ShipVia#1944, Discount#199, CustomerID#1939, ShipRegion#1949, ShipName#1946, ShippedDate#1943, ShipPostalCode#1950, OrderID#1938, ShipAddress#1947, RequiredDate#1942, Freight#1945, EmployeeID#1940, ProductID#1953, OrderID1#1952, OrderDate#1941]
            :     :     :                                                                                                                 +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, OrderID1#1952, ProductID#1953, UnitPrice#179, Quantity#158, cast(Discount#1956 as float) AS Discount#199]
            :     :     :                                                                                                                    +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, OrderID1#1952, ProductID#1953, cast(UnitPrice#1954 as float) AS UnitPrice#179, Quantity#158, Discount#1956]
            :     :     :                                                                                                                       +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, OrderID1#1952, ProductID#1953, UnitPrice#1954, cast(Quantity#1955 as int) AS Quantity#158, Discount#1956]
            :     :     :                                                                                                                          +- Relation [OrderID#1938,CustomerID#1939,EmployeeID#1940,OrderDate#1941,RequiredDate#1942,ShippedDate#1943,ShipVia#1944,Freight#1945,ShipName#1946,ShipAddress#1947,ShipCity#1948,ShipRegion#1949,ShipPostalCode#1950,ShipCountry#1951,OrderID1#1952,ProductID#1953,UnitPrice#1954,Quantity#1955,Discount#1956] parquet
            :     :     +- Project [TaxCountry#2151, TaxYear#2146, TaxID#2156, TaxeRate#8]
            :     :        +- Join LeftOuter, (TaxCountry#2151 = ShipCountry#1777)
            :     :           :- Project [ID_Taxe#0 AS TaxID#2156, TaxCountry#2151, TaxeRate#8, TaxYear#2146]
            :     :           :  +- Project [ID_Taxe#0, Country#1600 AS TaxCountry#2151, TaxeRate#8, TaxYear#2146]
            :     :           :     +- Project [ID_Taxe#0, Country#1600, TaxeRate#8, Year#3 AS TaxYear#2146]
            :     :           :        +- Project [ID_Taxe#0, regexp_replace(Country#1595, [^a-zA-Z0-9\s], , 1) AS Country#1600, TaxeRate#8, Year#3]
            :     :           :           +- Project [ID_Taxe#0, coalesce(Country#1, cast(Unknown as string)) AS Country#1595, TaxeRate#8, Year#3]
            :     :           :              +- Deduplicate [ID_Taxe#0, Country#1, TaxeRate#8, Year#3]
            :     :           :                 +- Project [ID_Taxe#0, Country#1, cast(TaxeRate#2 as float) AS TaxeRate#8, Year#3]
            :     :           :                    +- Relation [ID_Taxe#0,Country#1,TaxeRate#2,Year#3] parquet
            :     :           +- Deduplicate [ShipCountry#1777]
            :     :              +- Project [ShipCountry#1777]
            :     :                 +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2217, year(ShippedDate#2103) AS Year#2124]
            :     :                    +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, to_date(ShippedDate#966, Some(dd/MM/yyyy), Some(Europe/Paris), false) AS ShippedDate#2103, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2217]
            :     :                       +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2217]
            :     :                          +- Join LeftOuter, ((ShipCountry#1777 = Country#1771) AND (cast(ShippedDate#966 as date) = date#1934))
            :     :                             :- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853]
            :     :                             :  +- Join Inner, (ProductID#2191 = ProductID#2195)
            :     :                             :     :- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :  +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :     +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :        +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :           +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :              +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, to_date(RequiredDate#2180, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                 +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                    +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                       +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                          +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                             +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, to_date(ShippedDate#2181, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                   +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                      +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                         +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                            +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, to_date(OrderDate#2179, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                               +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                                  +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#719, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                                     +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#2184, ShipAddress#719, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, Quantity#682, Discount#645]
            :     :                             :     :                                                        +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, coalesce(ShipAddress#2185, cast(Unknown as string)) AS ShipAddress#719, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, Quantity#682, Discount#645]
            :     :                             :     :                                                           +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :                             :     :                                                              +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :                             :     :                                                                 +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :                             :     :                                                                    +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, coalesce(Freight#2183, cast(0.0 as string)) AS Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                       +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#2189, cast(Unknown as string)) AS ShipCountry#534, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                          +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, coalesce(ShipPostalCode#2188, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#2189, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                             +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, coalesce(ShipRegion#2187, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#2188, ShipCountry#2189, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                                +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                                   +- Deduplicate [Quantity#158, ShipCountry#2189, UnitPrice#179, ShipCity#2186, ShipVia#2182, Discount#199, CustomerID#2177, ShipRegion#2187, ShipName#2184, ShippedDate#2181, ShipPostalCode#2188, OrderID#2176, ShipAddress#2185, RequiredDate#2180, Freight#2183, EmployeeID#2178, ProductID#2191, OrderID1#2190, OrderDate#2179]
            :     :                             :     :                                                                                      +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, OrderID1#2190, ProductID#2191, UnitPrice#179, Quantity#158, cast(Discount#2194 as float) AS Discount#199]
            :     :                             :     :                                                                                         +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, OrderID1#2190, ProductID#2191, cast(UnitPrice#2192 as float) AS UnitPrice#179, Quantity#158, Discount#2194]
            :     :                             :     :                                                                                            +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, OrderID1#2190, ProductID#2191, UnitPrice#2192, cast(Quantity#2193 as int) AS Quantity#158, Discount#2194]
            :     :                             :     :                                                                                               +- Relation [OrderID#2176,CustomerID#2177,EmployeeID#2178,OrderDate#2179,RequiredDate#2180,ShippedDate#2181,ShipVia#2182,Freight#2183,ShipName#2184,ShipAddress#2185,ShipCity#2186,ShipRegion#2187,ShipPostalCode#2188,ShipCountry#2189,OrderID1#2190,ProductID#2191,UnitPrice#2192,Quantity#2193,Discount#2194] parquet
            :     :                             :     +- Project [ProductID#2195, SupplierID#2197, Country#1796 AS MagasinCountry#1853]
            :     :                             :        +- Join Inner, (SupplierID#2197 = SupplierID#2205)
            :     :                             :           :- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :  +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :     +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :        +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, UnitPrice#1291, coalesce(UnitsInStock#2201, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :           +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, coalesce(UnitPrice#2200, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#2201, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :              +- Deduplicate [UnitPrice#2200, UnitsOnOrder#2202, CategoryID#2198, UnitsInStock#2201, SupplierID#2197, QuantityPerUnit#2199, Discontinued#2204, ProductID#2195, ProductName#2196, ReorderLevel#2203]
            :     :                             :           :                 +- Relation [ProductID#2195,ProductName#2196,SupplierID#2197,CategoryID#2198,QuantityPerUnit#2199,UnitPrice#2200,UnitsInStock#2201,UnitsOnOrder#2202,ReorderLevel#2203,Discontinued#2204] parquet
            :     :                             :           +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, trim(Country#1534, None) AS Country#1796, Phone#1521, Fax#1483, HomePage#2216]
            :     :                             :              +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, regexp_replace(Country#1383, [^a-zA-Z0-9\s], , 1) AS Country#1534, Phone#1521, Fax#1483, HomePage#2216]
            :     :                             :                 +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, Country#1383, CASE WHEN RLIKE(Phone#1508, ^[0-9.\-\(\) ]+$) THEN Phone#1508 ELSE Unknown END AS Phone#1521, Fax#1483, HomePage#2216]
            :     :                             :                    +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, Country#1383, coalesce(Phone#2214, cast(Unknown as string)) AS Phone#1508, Fax#1483, HomePage#2216]
            :     :                             :                       +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, Country#1383, Phone#2214, coalesce(Fax#2215, cast(Unknown as string)) AS Fax#1483, HomePage#2216]
            :     :                             :                          +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, coalesce(PostalCode#2212, cast(Unknown as string)) AS PostalCode#1458, Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                             +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, coalesce(City#2210, cast(Unknown as string)) AS City#1433, Region#2211, PostalCode#2212, Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                                +- Project [SupplierID#2205, coalesce(CompanyName#2206, cast(Unknown as string)) AS CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#2210, Region#2211, PostalCode#2212, Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                                   +- Project [SupplierID#2205, CompanyName#2206, ContactName#2207, ContactTitle#2208, Address#2209, City#2210, Region#2211, PostalCode#2212, coalesce(Country#2213, cast(Unknown as string)) AS Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                                      +- Deduplicate [CompanyName#2206, Country#2213, Address#2209, Region#2211, Fax#2215, Phone#2214, City#2210, SupplierID#2205, ContactName#2207, HomePage#2216, ContactTitle#2208, PostalCode#2212]
            :     :                             :                                         +- Relation [SupplierID#2205,CompanyName#2206,ContactName#2207,ContactTitle#2208,Address#2209,City#2210,Region#2211,PostalCode#2212,Country#2213,Phone#2214,Fax#2215,HomePage#2216] parquet
            :     :                             +- Project [ID_taux#2217, to_date(date#2218, Some(yyyy-MM-dd), Some(Europe/Paris), false) AS date#1934, Country#1771]
            :     :                                +- Project [ID_taux#2217, date#2218, Country#1771]
            :     :                                   +- Join Inner, (Country#1771 = ShipCountry#1777)
            :     :                                      :- Project [ID_taux#2217, date#2218, ratetoeuro#2219, trim(Country#2220, None) AS Country#1771, currency#2221]
            :     :                                      :  +- Relation [ID_taux#2217,date#2218,ratetoeuro#2219,Country#2220,currency#2221] parquet
            :     :                                      +- Deduplicate [ShipCountry#1777]
            :     :                                         +- Project [ShipCountry#1777]
            :     :                                            +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                               +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                  +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                     +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                        +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                           +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, to_date(RequiredDate#2226, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                              +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                 +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                    +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                       +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                          +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, to_date(ShippedDate#2227, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                             +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                   +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                      +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                         +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, to_date(OrderDate#2225, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                            +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                               +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#719, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                                  +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#2230, ShipAddress#719, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, Quantity#682, Discount#645]
            :     :                                                                                                     +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, coalesce(ShipAddress#2231, cast(Unknown as string)) AS ShipAddress#719, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, Quantity#682, Discount#645]
            :     :                                                                                                        +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :                                                                                                           +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :                                                                                                              +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :                                                                                                                 +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, coalesce(Freight#2229, cast(0.0 as string)) AS Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                    +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#2235, cast(Unknown as string)) AS ShipCountry#534, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                       +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, coalesce(ShipPostalCode#2234, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#2235, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                          +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, coalesce(ShipRegion#2233, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#2234, ShipCountry#2235, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                             +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                                +- Deduplicate [Quantity#158, ShipCountry#2235, UnitPrice#179, ShipCity#2232, ShipVia#2228, Discount#199, CustomerID#2223, ShipRegion#2233, ShipName#2230, ShippedDate#2227, ShipPostalCode#2234, OrderID#2222, ShipAddress#2231, RequiredDate#2226, Freight#2229, EmployeeID#2224, ProductID#2237, OrderID1#2236, OrderDate#2225]
            :     :                                                                                                                                   +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, OrderID1#2236, ProductID#2237, UnitPrice#179, Quantity#158, cast(Discount#2240 as float) AS Discount#199]
            :     :                                                                                                                                      +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, OrderID1#2236, ProductID#2237, cast(UnitPrice#2238 as float) AS UnitPrice#179, Quantity#158, Discount#2240]
            :     :                                                                                                                                         +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, OrderID1#2236, ProductID#2237, UnitPrice#2238, cast(Quantity#2239 as int) AS Quantity#158, Discount#2240]
            :     :                                                                                                                                            +- Relation [OrderID#2222,CustomerID#2223,EmployeeID#2224,OrderDate#2225,RequiredDate#2226,ShippedDate#2227,ShipVia#2228,Freight#2229,ShipName#2230,ShipAddress#2231,ShipCity#2232,ShipRegion#2233,ShipPostalCode#2234,ShipCountry#2235,OrderID1#2236,ProductID#2237,UnitPrice#2238,Quantity#2239,Discount#2240] parquet
            :     +- Project [CustomerID#74, Country#1253, Region#80]
            :        +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, regexp_replace(Country#1114, [^a-zA-Z0-9\s], , 1) AS Country#1253, Phone#1241, Fax#1206]
            :           +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, CASE WHEN RLIKE(Phone#1229, ^[0-9.\-\(\) ]+$) THEN Phone#1229 ELSE Unknown END AS Phone#1241, Fax#1206]
            :              +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, coalesce(Phone#83, cast(Unknown as string)) AS Phone#1229, Fax#1206]
            :                 +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, Phone#83, coalesce(Fax#84, cast(Unknown as string)) AS Fax#1206]
            :                    +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, coalesce(PostalCode#81, cast(Unknown as string)) AS PostalCode#1183, Country#1114, Phone#83, Fax#84]
            :                       +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, coalesce(City#79, cast(Unknown as string)) AS City#1160, Region#80, PostalCode#81, Country#1114, Phone#83, Fax#84]
            :                          +- Project [CustomerID#74, coalesce(CompanyName#75, cast(Unknown as string)) AS CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#79, Region#80, PostalCode#81, Country#1114, Phone#83, Fax#84]
            :                             +- Project [CustomerID#74, CompanyName#75, ContactName#76, ContactTitle#77, Address#78, City#79, Region#80, PostalCode#81, coalesce(Country#82, cast(Unknown as string)) AS Country#1114, Phone#83, Fax#84]
            :                                +- Deduplicate [CompanyName#75, Country#82, CustomerID#74, Address#78, Region#80, Fax#84, Phone#83, City#79, ContactName#76, ContactTitle#77, PostalCode#81]
            :                                   +- Relation [CustomerID#74,CompanyName#75,ContactName#76,ContactTitle#77,Address#78,City#79,Region#80,PostalCode#81,Country#82,Phone#83,Fax#84] parquet
            +- Project [ProductID#2371 AS ProduitID#2368, ProductName#2372]
               +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                  +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                     +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                        +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, UnitPrice#1291, coalesce(UnitsInStock#2377, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                           +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, coalesce(UnitPrice#2376, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#2377, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                              +- Deduplicate [UnitPrice#2376, UnitsOnOrder#2378, CategoryID#2374, UnitsInStock#2377, SupplierID#2373, QuantityPerUnit#2375, Discontinued#2380, ProductID#2371, ProductName#2372, ReorderLevel#2379]
                                 +- Relation [ProductID#2371,ProductName#2372,SupplierID#2373,CategoryID#2374,QuantityPerUnit#2375,UnitPrice#2376,UnitsInStock#2377,UnitsOnOrder#2378,ReorderLevel#2379,Discontinued#2380] parquet

2024-12-01 15:24:55,102 - INFO - Data cleaning process completed.
2024-12-01 15:24:55,105 - INFO - Closing down clientserver connection
2024-12-01 15:25:18,011 - ERROR - Removed 0 duplicate rows
2024-12-01 15:25:18,025 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 15:25:18,026 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:25:18,027 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:25:18,492 - ERROR - Removed 0 duplicate rows
2024-12-01 15:25:18,494 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:25:18,495 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:25:18,857 - ERROR - Removed 0 duplicate rows
2024-12-01 15:25:18,858 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:25:18,859 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:25:19,187 - ERROR - Removed 0 duplicate rows
2024-12-01 15:25:19,189 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:25:19,189 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:25:19,518 - ERROR - Removed 0 duplicate rows
2024-12-01 15:25:19,520 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:25:19,521 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:25:20,069 - ERROR - Removed 0 duplicate rows
2024-12-01 15:25:20,071 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:25:20,071 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:25:20,415 - ERROR - Removed 0 duplicate rows
2024-12-01 15:25:20,417 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:25:20,417 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:25:20,418 - ERROR - Starting cleaning for transactions
2024-12-01 15:25:20,530 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:25:20,570 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 15:25:20,600 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:25:20,622 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 15:25:20,694 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 15:25:20,694 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 15:25:20,766 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:25:20,766 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:25:20,837 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:25:20,837 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:25:20,838 - INFO - Finished cleaning for transactions
2024-12-01 15:25:20,838 - ERROR - Finished cleaning for transactions
2024-12-01 15:25:21,070 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 15:25:21,071 - ERROR - Starting cleaning for clients
2024-12-01 15:25:21,115 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:25:21,131 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:25:21,148 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:25:21,149 - INFO - Finished cleaning for clients
2024-12-01 15:25:21,150 - ERROR - Finished cleaning for clients
2024-12-01 15:25:21,327 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 15:25:21,328 - ERROR - Starting cleaning for produits
2024-12-01 15:25:21,344 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:25:21,357 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:25:21,386 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 15:25:21,388 - INFO - Finished cleaning for produits
2024-12-01 15:25:21,388 - ERROR - Finished cleaning for produits
2024-12-01 15:25:21,526 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 15:25:21,526 - ERROR - Starting cleaning for magasins
2024-12-01 15:25:21,559 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:25:21,571 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:25:21,585 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:25:21,586 - INFO - Finished cleaning for magasins
2024-12-01 15:25:21,587 - ERROR - Finished cleaning for magasins
2024-12-01 15:25:21,704 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 15:25:21,704 - ERROR - Starting cleaning for exchange
2024-12-01 15:25:21,710 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:25:21,723 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:25:21,724 - INFO - Finished cleaning for exchange
2024-12-01 15:25:21,724 - ERROR - Finished cleaning for exchange
2024-12-01 15:25:21,978 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 28130 rows after removing duplicates.
2024-12-01 15:25:21,978 - ERROR - Starting cleaning for rates
2024-12-01 15:25:21,983 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:25:21,992 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:25:21,993 - INFO - Finished cleaning for rates
2024-12-01 15:25:21,993 - ERROR - Finished cleaning for rates
2024-12-01 15:25:22,137 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 15:25:22,138 - ERROR - Starting cleaning for categories
2024-12-01 15:25:22,143 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:25:22,155 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 15:25:22,156 - INFO - Finished cleaning for categories
2024-12-01 15:25:22,156 - ERROR - Finished cleaning for categories
2024-12-01 15:25:22,263 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 15:25:22,473 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 15:25:22,642 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 15:25:22,761 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 15:25:22,880 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 15:25:22,908 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 15:25:22,909 - INFO - Début des jointures et des transformations.
2024-12-01 15:25:22,959 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 15:25:24,338 - ERROR - Calcul des taxes en cours...
2024-12-01 15:25:24,340 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'ID_taux']
2024-12-01 15:25:24,340 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 15:25:24,341 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 15:25:24,341 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 15:25:24,387 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 15:25:24,536 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 15:25:25,515 - ERROR - Calcul du taux de taxe terminé
2024-12-01 15:25:25,562 - ERROR - Calcul du prix après remise terminé
2024-12-01 15:25:25,748 - ERROR - Erreur lors de la transformation et de la sauvegarde des données : [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `ratetoeuro` cannot be resolved. Did you mean one of the following? [`ID_taux`, `Year`, `CustomerID`, `Discount`, `Freight`].;
'Filter isnull('ratetoeuro)
+- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#2462, Country#1253, ... 3 more fields]
   +- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, coalesce(cast(TaxeRate#8 as double), 0.1) AS TaxeRate#2462, Country#1253, ... 2 more fields]
      +- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#8, Country#1253, ... 2 more fields]
         +- Join LeftOuter, (ProductID#51 = ProduitID#2368)
            :- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#8, Country#1253, Region#80]
            :  +- Join LeftOuter, (CustomerID#37 = CustomerID#74)
            :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#8]
            :     :  +- Join LeftOuter, ((ShipCountry#1777 = TaxCountry#2151) AND (Year#2124 = cast(TaxYear#2146 as int)))
            :     :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, year(ShippedDate#2103) AS Year#2124]
            :     :     :  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, to_date(ShippedDate#966, Some(dd/MM/yyyy), Some(Europe/Paris), false) AS ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148]
            :     :     :     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148]
            :     :     :        +- Join LeftOuter, ((ShipCountry#1777 = Country#1771) AND (cast(ShippedDate#966 as date) = date#1934))
            :     :     :           :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853]
            :     :     :           :  +- Join Inner, (ProductID#51 = ProductID#120)
            :     :     :           :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :        +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :           +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :              +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, to_date(RequiredDate#40, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                 +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                    +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                       +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                          +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                             +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, to_date(ShippedDate#41, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                   +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                      +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                         +- Project [OrderID#36, CustomerID#37, EmployeeID#38, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                            +- Project [OrderID#36, CustomerID#37, EmployeeID#38, to_date(OrderDate#39, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                               +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                                  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                                     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#44, ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :           :     :                                                        +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, coalesce(ShipAddress#45, cast(Unknown as string)) AS ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :           :     :                                                           +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :     :           :     :                                                              +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :     :           :     :                                                                 +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :     :           :     :                                                                    +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, coalesce(Freight#43, cast(0.0 as string)) AS Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                       +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#49, cast(Unknown as string)) AS ShipCountry#534, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                          +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, coalesce(ShipPostalCode#48, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                             +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, coalesce(ShipRegion#47, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#48, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                                +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                                   +- Deduplicate [Quantity#158, ShipCountry#49, UnitPrice#179, ShipCity#46, ShipVia#42, Discount#199, CustomerID#37, ShipRegion#47, ShipName#44, ShippedDate#41, ShipPostalCode#48, OrderID#36, ShipAddress#45, RequiredDate#40, Freight#43, EmployeeID#38, ProductID#51, OrderID1#50, OrderDate#39]
            :     :     :           :     :                                                                                      +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, UnitPrice#179, Quantity#158, cast(Discount#54 as float) AS Discount#199]
            :     :     :           :     :                                                                                         +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, cast(UnitPrice#52 as float) AS UnitPrice#179, Quantity#158, Discount#54]
            :     :     :           :     :                                                                                            +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, UnitPrice#52, cast(Quantity#53 as int) AS Quantity#158, Discount#54]
            :     :     :           :     :                                                                                               +- Relation [OrderID#36,CustomerID#37,EmployeeID#38,OrderDate#39,RequiredDate#40,ShippedDate#41,ShipVia#42,Freight#43,ShipName#44,ShipAddress#45,ShipCity#46,ShipRegion#47,ShipPostalCode#48,ShipCountry#49,OrderID1#50,ProductID#51,UnitPrice#52,Quantity#53,Discount#54] parquet
            :     :     :           :     +- Project [ProductID#120, SupplierID#122, Country#1796 AS MagasinCountry#1853]
            :     :     :           :        +- Join Inner, (SupplierID#122 = SupplierID#96)
            :     :     :           :           :- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :  +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :     +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :        +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1291, coalesce(UnitsInStock#126, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :           +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, coalesce(UnitPrice#125, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#126, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :              +- Deduplicate [UnitPrice#125, UnitsOnOrder#127, CategoryID#123, UnitsInStock#126, SupplierID#122, QuantityPerUnit#124, Discontinued#129, ProductID#120, ProductName#121, ReorderLevel#128]
            :     :     :           :           :                 +- Relation [ProductID#120,ProductName#121,SupplierID#122,CategoryID#123,QuantityPerUnit#124,UnitPrice#125,UnitsInStock#126,UnitsOnOrder#127,ReorderLevel#128,Discontinued#129] parquet
            :     :     :           :           +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, trim(Country#1534, None) AS Country#1796, Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :              +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, regexp_replace(Country#1383, [^a-zA-Z0-9\s], , 1) AS Country#1534, Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :                 +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, CASE WHEN RLIKE(Phone#1508, ^[0-9.\-\(\) ]+$) THEN Phone#1508 ELSE Unknown END AS Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :                    +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, coalesce(Phone#105, cast(Unknown as string)) AS Phone#1508, Fax#1483, HomePage#107]
            :     :     :           :                       +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, Phone#105, coalesce(Fax#106, cast(Unknown as string)) AS Fax#1483, HomePage#107]
            :     :     :           :                          +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, coalesce(PostalCode#103, cast(Unknown as string)) AS PostalCode#1458, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                             +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, coalesce(City#101, cast(Unknown as string)) AS City#1433, Region#102, PostalCode#103, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                +- Project [SupplierID#96, coalesce(CompanyName#97, cast(Unknown as string)) AS CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#101, Region#102, PostalCode#103, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                   +- Project [SupplierID#96, CompanyName#97, ContactName#98, ContactTitle#99, Address#100, City#101, Region#102, PostalCode#103, coalesce(Country#104, cast(Unknown as string)) AS Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                      +- Deduplicate [CompanyName#97, Country#104, Address#100, Region#102, Fax#106, Phone#105, City#101, SupplierID#96, ContactName#98, HomePage#107, ContactTitle#99, PostalCode#103]
            :     :     :           :                                         +- Relation [SupplierID#96,CompanyName#97,ContactName#98,ContactTitle#99,Address#100,City#101,Region#102,PostalCode#103,Country#104,Phone#105,Fax#106,HomePage#107] parquet
            :     :     :           +- Project [ID_taux#148, to_date(date#149, Some(yyyy-MM-dd), Some(Europe/Paris), false) AS date#1934, Country#1771]
            :     :     :              +- Project [ID_taux#148, date#149, Country#1771]
            :     :     :                 +- Join Inner, (Country#1771 = ShipCountry#1777)
            :     :     :                    :- Project [ID_taux#148, date#149, ratetoeuro#150, trim(Country#151, None) AS Country#1771, currency#152]
            :     :     :                    :  +- Relation [ID_taux#148,date#149,ratetoeuro#150,Country#151,currency#152] parquet
            :     :     :                    +- Deduplicate [ShipCountry#1777]
            :     :     :                       +- Project [ShipCountry#1777]
            :     :     :                          +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                             +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                   +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                      +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                         +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, to_date(RequiredDate#1942, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                            +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                               +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                  +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                     +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                        +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, to_date(ShippedDate#1943, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                           +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                              +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                 +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                    +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                       +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, to_date(OrderDate#1941, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                          +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                             +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#719, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                                +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#1946, ShipAddress#719, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :                                                                                   +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, coalesce(ShipAddress#1947, cast(Unknown as string)) AS ShipAddress#719, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :                                                                                      +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :     :                                                                                         +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :     :                                                                                            +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :     :                                                                                               +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, coalesce(Freight#1945, cast(0.0 as string)) AS Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                  +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#1951, cast(Unknown as string)) AS ShipCountry#534, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                     +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, coalesce(ShipPostalCode#1950, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#1951, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                        +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, coalesce(ShipRegion#1949, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#1950, ShipCountry#1951, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                           +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                              +- Deduplicate [Quantity#158, ShipCountry#1951, UnitPrice#179, ShipCity#1948, ShipVia#1944, Discount#199, CustomerID#1939, ShipRegion#1949, ShipName#1946, ShippedDate#1943, ShipPostalCode#1950, OrderID#1938, ShipAddress#1947, RequiredDate#1942, Freight#1945, EmployeeID#1940, ProductID#1953, OrderID1#1952, OrderDate#1941]
            :     :     :                                                                                                                 +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, OrderID1#1952, ProductID#1953, UnitPrice#179, Quantity#158, cast(Discount#1956 as float) AS Discount#199]
            :     :     :                                                                                                                    +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, OrderID1#1952, ProductID#1953, cast(UnitPrice#1954 as float) AS UnitPrice#179, Quantity#158, Discount#1956]
            :     :     :                                                                                                                       +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, OrderID1#1952, ProductID#1953, UnitPrice#1954, cast(Quantity#1955 as int) AS Quantity#158, Discount#1956]
            :     :     :                                                                                                                          +- Relation [OrderID#1938,CustomerID#1939,EmployeeID#1940,OrderDate#1941,RequiredDate#1942,ShippedDate#1943,ShipVia#1944,Freight#1945,ShipName#1946,ShipAddress#1947,ShipCity#1948,ShipRegion#1949,ShipPostalCode#1950,ShipCountry#1951,OrderID1#1952,ProductID#1953,UnitPrice#1954,Quantity#1955,Discount#1956] parquet
            :     :     +- Project [TaxCountry#2151, TaxYear#2146, TaxID#2156, TaxeRate#8]
            :     :        +- Join LeftOuter, (TaxCountry#2151 = ShipCountry#1777)
            :     :           :- Project [ID_Taxe#0 AS TaxID#2156, TaxCountry#2151, TaxeRate#8, TaxYear#2146]
            :     :           :  +- Project [ID_Taxe#0, Country#1600 AS TaxCountry#2151, TaxeRate#8, TaxYear#2146]
            :     :           :     +- Project [ID_Taxe#0, Country#1600, TaxeRate#8, Year#3 AS TaxYear#2146]
            :     :           :        +- Project [ID_Taxe#0, regexp_replace(Country#1595, [^a-zA-Z0-9\s], , 1) AS Country#1600, TaxeRate#8, Year#3]
            :     :           :           +- Project [ID_Taxe#0, coalesce(Country#1, cast(Unknown as string)) AS Country#1595, TaxeRate#8, Year#3]
            :     :           :              +- Deduplicate [ID_Taxe#0, Country#1, TaxeRate#8, Year#3]
            :     :           :                 +- Project [ID_Taxe#0, Country#1, cast(TaxeRate#2 as float) AS TaxeRate#8, Year#3]
            :     :           :                    +- Relation [ID_Taxe#0,Country#1,TaxeRate#2,Year#3] parquet
            :     :           +- Deduplicate [ShipCountry#1777]
            :     :              +- Project [ShipCountry#1777]
            :     :                 +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2217, year(ShippedDate#2103) AS Year#2124]
            :     :                    +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, to_date(ShippedDate#966, Some(dd/MM/yyyy), Some(Europe/Paris), false) AS ShippedDate#2103, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2217]
            :     :                       +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2217]
            :     :                          +- Join LeftOuter, ((ShipCountry#1777 = Country#1771) AND (cast(ShippedDate#966 as date) = date#1934))
            :     :                             :- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853]
            :     :                             :  +- Join Inner, (ProductID#2191 = ProductID#2195)
            :     :                             :     :- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :  +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :     +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :        +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :           +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :              +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, to_date(RequiredDate#2180, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                 +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                    +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                       +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                          +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                             +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, to_date(ShippedDate#2181, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                   +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                      +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                         +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                            +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, to_date(OrderDate#2179, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                               +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                                  +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#719, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                                     +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#2184, ShipAddress#719, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, Quantity#682, Discount#645]
            :     :                             :     :                                                        +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, coalesce(ShipAddress#2185, cast(Unknown as string)) AS ShipAddress#719, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, Quantity#682, Discount#645]
            :     :                             :     :                                                           +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :                             :     :                                                              +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :                             :     :                                                                 +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :                             :     :                                                                    +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, coalesce(Freight#2183, cast(0.0 as string)) AS Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                       +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#2189, cast(Unknown as string)) AS ShipCountry#534, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                          +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, coalesce(ShipPostalCode#2188, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#2189, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                             +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, coalesce(ShipRegion#2187, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#2188, ShipCountry#2189, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                                +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                                   +- Deduplicate [Quantity#158, ShipCountry#2189, UnitPrice#179, ShipCity#2186, ShipVia#2182, Discount#199, CustomerID#2177, ShipRegion#2187, ShipName#2184, ShippedDate#2181, ShipPostalCode#2188, OrderID#2176, ShipAddress#2185, RequiredDate#2180, Freight#2183, EmployeeID#2178, ProductID#2191, OrderID1#2190, OrderDate#2179]
            :     :                             :     :                                                                                      +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, OrderID1#2190, ProductID#2191, UnitPrice#179, Quantity#158, cast(Discount#2194 as float) AS Discount#199]
            :     :                             :     :                                                                                         +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, OrderID1#2190, ProductID#2191, cast(UnitPrice#2192 as float) AS UnitPrice#179, Quantity#158, Discount#2194]
            :     :                             :     :                                                                                            +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, OrderID1#2190, ProductID#2191, UnitPrice#2192, cast(Quantity#2193 as int) AS Quantity#158, Discount#2194]
            :     :                             :     :                                                                                               +- Relation [OrderID#2176,CustomerID#2177,EmployeeID#2178,OrderDate#2179,RequiredDate#2180,ShippedDate#2181,ShipVia#2182,Freight#2183,ShipName#2184,ShipAddress#2185,ShipCity#2186,ShipRegion#2187,ShipPostalCode#2188,ShipCountry#2189,OrderID1#2190,ProductID#2191,UnitPrice#2192,Quantity#2193,Discount#2194] parquet
            :     :                             :     +- Project [ProductID#2195, SupplierID#2197, Country#1796 AS MagasinCountry#1853]
            :     :                             :        +- Join Inner, (SupplierID#2197 = SupplierID#2205)
            :     :                             :           :- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :  +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :     +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :        +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, UnitPrice#1291, coalesce(UnitsInStock#2201, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :           +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, coalesce(UnitPrice#2200, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#2201, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :              +- Deduplicate [UnitPrice#2200, UnitsOnOrder#2202, CategoryID#2198, UnitsInStock#2201, SupplierID#2197, QuantityPerUnit#2199, Discontinued#2204, ProductID#2195, ProductName#2196, ReorderLevel#2203]
            :     :                             :           :                 +- Relation [ProductID#2195,ProductName#2196,SupplierID#2197,CategoryID#2198,QuantityPerUnit#2199,UnitPrice#2200,UnitsInStock#2201,UnitsOnOrder#2202,ReorderLevel#2203,Discontinued#2204] parquet
            :     :                             :           +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, trim(Country#1534, None) AS Country#1796, Phone#1521, Fax#1483, HomePage#2216]
            :     :                             :              +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, regexp_replace(Country#1383, [^a-zA-Z0-9\s], , 1) AS Country#1534, Phone#1521, Fax#1483, HomePage#2216]
            :     :                             :                 +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, Country#1383, CASE WHEN RLIKE(Phone#1508, ^[0-9.\-\(\) ]+$) THEN Phone#1508 ELSE Unknown END AS Phone#1521, Fax#1483, HomePage#2216]
            :     :                             :                    +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, Country#1383, coalesce(Phone#2214, cast(Unknown as string)) AS Phone#1508, Fax#1483, HomePage#2216]
            :     :                             :                       +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, Country#1383, Phone#2214, coalesce(Fax#2215, cast(Unknown as string)) AS Fax#1483, HomePage#2216]
            :     :                             :                          +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, coalesce(PostalCode#2212, cast(Unknown as string)) AS PostalCode#1458, Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                             +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, coalesce(City#2210, cast(Unknown as string)) AS City#1433, Region#2211, PostalCode#2212, Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                                +- Project [SupplierID#2205, coalesce(CompanyName#2206, cast(Unknown as string)) AS CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#2210, Region#2211, PostalCode#2212, Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                                   +- Project [SupplierID#2205, CompanyName#2206, ContactName#2207, ContactTitle#2208, Address#2209, City#2210, Region#2211, PostalCode#2212, coalesce(Country#2213, cast(Unknown as string)) AS Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                                      +- Deduplicate [CompanyName#2206, Country#2213, Address#2209, Region#2211, Fax#2215, Phone#2214, City#2210, SupplierID#2205, ContactName#2207, HomePage#2216, ContactTitle#2208, PostalCode#2212]
            :     :                             :                                         +- Relation [SupplierID#2205,CompanyName#2206,ContactName#2207,ContactTitle#2208,Address#2209,City#2210,Region#2211,PostalCode#2212,Country#2213,Phone#2214,Fax#2215,HomePage#2216] parquet
            :     :                             +- Project [ID_taux#2217, to_date(date#2218, Some(yyyy-MM-dd), Some(Europe/Paris), false) AS date#1934, Country#1771]
            :     :                                +- Project [ID_taux#2217, date#2218, Country#1771]
            :     :                                   +- Join Inner, (Country#1771 = ShipCountry#1777)
            :     :                                      :- Project [ID_taux#2217, date#2218, ratetoeuro#2219, trim(Country#2220, None) AS Country#1771, currency#2221]
            :     :                                      :  +- Relation [ID_taux#2217,date#2218,ratetoeuro#2219,Country#2220,currency#2221] parquet
            :     :                                      +- Deduplicate [ShipCountry#1777]
            :     :                                         +- Project [ShipCountry#1777]
            :     :                                            +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                               +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                  +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                     +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                        +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                           +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, to_date(RequiredDate#2226, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                              +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                 +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                    +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                       +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                          +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, to_date(ShippedDate#2227, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                             +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                   +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                      +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                         +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, to_date(OrderDate#2225, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                            +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                               +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#719, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                                  +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#2230, ShipAddress#719, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, Quantity#682, Discount#645]
            :     :                                                                                                     +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, coalesce(ShipAddress#2231, cast(Unknown as string)) AS ShipAddress#719, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, Quantity#682, Discount#645]
            :     :                                                                                                        +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :                                                                                                           +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :                                                                                                              +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :                                                                                                                 +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, coalesce(Freight#2229, cast(0.0 as string)) AS Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                    +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#2235, cast(Unknown as string)) AS ShipCountry#534, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                       +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, coalesce(ShipPostalCode#2234, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#2235, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                          +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, coalesce(ShipRegion#2233, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#2234, ShipCountry#2235, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                             +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                                +- Deduplicate [Quantity#158, ShipCountry#2235, UnitPrice#179, ShipCity#2232, ShipVia#2228, Discount#199, CustomerID#2223, ShipRegion#2233, ShipName#2230, ShippedDate#2227, ShipPostalCode#2234, OrderID#2222, ShipAddress#2231, RequiredDate#2226, Freight#2229, EmployeeID#2224, ProductID#2237, OrderID1#2236, OrderDate#2225]
            :     :                                                                                                                                   +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, OrderID1#2236, ProductID#2237, UnitPrice#179, Quantity#158, cast(Discount#2240 as float) AS Discount#199]
            :     :                                                                                                                                      +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, OrderID1#2236, ProductID#2237, cast(UnitPrice#2238 as float) AS UnitPrice#179, Quantity#158, Discount#2240]
            :     :                                                                                                                                         +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, OrderID1#2236, ProductID#2237, UnitPrice#2238, cast(Quantity#2239 as int) AS Quantity#158, Discount#2240]
            :     :                                                                                                                                            +- Relation [OrderID#2222,CustomerID#2223,EmployeeID#2224,OrderDate#2225,RequiredDate#2226,ShippedDate#2227,ShipVia#2228,Freight#2229,ShipName#2230,ShipAddress#2231,ShipCity#2232,ShipRegion#2233,ShipPostalCode#2234,ShipCountry#2235,OrderID1#2236,ProductID#2237,UnitPrice#2238,Quantity#2239,Discount#2240] parquet
            :     +- Project [CustomerID#74, Country#1253, Region#80]
            :        +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, regexp_replace(Country#1114, [^a-zA-Z0-9\s], , 1) AS Country#1253, Phone#1241, Fax#1206]
            :           +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, CASE WHEN RLIKE(Phone#1229, ^[0-9.\-\(\) ]+$) THEN Phone#1229 ELSE Unknown END AS Phone#1241, Fax#1206]
            :              +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, coalesce(Phone#83, cast(Unknown as string)) AS Phone#1229, Fax#1206]
            :                 +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, Phone#83, coalesce(Fax#84, cast(Unknown as string)) AS Fax#1206]
            :                    +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, coalesce(PostalCode#81, cast(Unknown as string)) AS PostalCode#1183, Country#1114, Phone#83, Fax#84]
            :                       +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, coalesce(City#79, cast(Unknown as string)) AS City#1160, Region#80, PostalCode#81, Country#1114, Phone#83, Fax#84]
            :                          +- Project [CustomerID#74, coalesce(CompanyName#75, cast(Unknown as string)) AS CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#79, Region#80, PostalCode#81, Country#1114, Phone#83, Fax#84]
            :                             +- Project [CustomerID#74, CompanyName#75, ContactName#76, ContactTitle#77, Address#78, City#79, Region#80, PostalCode#81, coalesce(Country#82, cast(Unknown as string)) AS Country#1114, Phone#83, Fax#84]
            :                                +- Deduplicate [CompanyName#75, Country#82, CustomerID#74, Address#78, Region#80, Fax#84, Phone#83, City#79, ContactName#76, ContactTitle#77, PostalCode#81]
            :                                   +- Relation [CustomerID#74,CompanyName#75,ContactName#76,ContactTitle#77,Address#78,City#79,Region#80,PostalCode#81,Country#82,Phone#83,Fax#84] parquet
            +- Project [ProductID#2371 AS ProduitID#2368, ProductName#2372]
               +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                  +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                     +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                        +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, UnitPrice#1291, coalesce(UnitsInStock#2377, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                           +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, coalesce(UnitPrice#2376, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#2377, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                              +- Deduplicate [UnitPrice#2376, UnitsOnOrder#2378, CategoryID#2374, UnitsInStock#2377, SupplierID#2373, QuantityPerUnit#2375, Discontinued#2380, ProductID#2371, ProductName#2372, ReorderLevel#2379]
                                 +- Relation [ProductID#2371,ProductName#2372,SupplierID#2373,CategoryID#2374,QuantityPerUnit#2375,UnitPrice#2376,UnitsInStock#2377,UnitsOnOrder#2378,ReorderLevel#2379,Discontinued#2380] parquet

2024-12-01 15:25:25,801 - ERROR - Erreur lors de la transformation et de la sauvegarde des données : [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `ratetoeuro` cannot be resolved. Did you mean one of the following? [`ID_taux`, `Year`, `CustomerID`, `Discount`, `Freight`].;
'Filter isnull('ratetoeuro)
+- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#2462, Country#1253, ... 3 more fields]
   +- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, coalesce(cast(TaxeRate#8 as double), 0.1) AS TaxeRate#2462, Country#1253, ... 2 more fields]
      +- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#8, Country#1253, ... 2 more fields]
         +- Join LeftOuter, (ProductID#51 = ProduitID#2368)
            :- Project [CustomerID#37, OrderID#36, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#8, Country#1253, Region#80]
            :  +- Join LeftOuter, (CustomerID#37 = CustomerID#74)
            :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, Year#2124, TaxID#2156, TaxeRate#8]
            :     :  +- Join LeftOuter, ((ShipCountry#1777 = TaxCountry#2151) AND (Year#2124 = cast(TaxYear#2146 as int)))
            :     :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148, year(ShippedDate#2103) AS Year#2124]
            :     :     :  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, to_date(ShippedDate#966, Some(dd/MM/yyyy), Some(Europe/Paris), false) AS ShippedDate#2103, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148]
            :     :     :     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#148]
            :     :     :        +- Join LeftOuter, ((ShipCountry#1777 = Country#1771) AND (cast(ShippedDate#966 as date) = date#1934))
            :     :     :           :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853]
            :     :     :           :  +- Join Inner, (ProductID#51 = ProductID#120)
            :     :     :           :     :- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :        +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :           +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :              +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, to_date(RequiredDate#40, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                 +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                    +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                       +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                          +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                             +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#871, RequiredDate#40, to_date(ShippedDate#41, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                   +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                      +- Project [OrderID#36, CustomerID#37, EmployeeID#38, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                         +- Project [OrderID#36, CustomerID#37, EmployeeID#38, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                            +- Project [OrderID#36, CustomerID#37, EmployeeID#38, to_date(OrderDate#39, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                               +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                                  +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#738, ShipName#44, ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :     :           :     :                                                     +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#44, ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :           :     :                                                        +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, coalesce(ShipAddress#45, cast(Unknown as string)) AS ShipAddress#719, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :           :     :                                                           +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :     :           :     :                                                              +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :     :           :     :                                                                 +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :     :           :     :                                                                    +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, coalesce(Freight#43, cast(0.0 as string)) AS Freight#571, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                       +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#49, cast(Unknown as string)) AS ShipCountry#534, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                          +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#460, coalesce(ShipPostalCode#48, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                             +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, coalesce(ShipRegion#47, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#48, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                                +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, ProductID#51, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :           :     :                                                                                   +- Deduplicate [Quantity#158, ShipCountry#49, UnitPrice#179, ShipCity#46, ShipVia#42, Discount#199, CustomerID#37, ShipRegion#47, ShipName#44, ShippedDate#41, ShipPostalCode#48, OrderID#36, ShipAddress#45, RequiredDate#40, Freight#43, EmployeeID#38, ProductID#51, OrderID1#50, OrderDate#39]
            :     :     :           :     :                                                                                      +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, UnitPrice#179, Quantity#158, cast(Discount#54 as float) AS Discount#199]
            :     :     :           :     :                                                                                         +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, cast(UnitPrice#52 as float) AS UnitPrice#179, Quantity#158, Discount#54]
            :     :     :           :     :                                                                                            +- Project [OrderID#36, CustomerID#37, EmployeeID#38, OrderDate#39, RequiredDate#40, ShippedDate#41, ShipVia#42, Freight#43, ShipName#44, ShipAddress#45, ShipCity#46, ShipRegion#47, ShipPostalCode#48, ShipCountry#49, OrderID1#50, ProductID#51, UnitPrice#52, cast(Quantity#53 as int) AS Quantity#158, Discount#54]
            :     :     :           :     :                                                                                               +- Relation [OrderID#36,CustomerID#37,EmployeeID#38,OrderDate#39,RequiredDate#40,ShippedDate#41,ShipVia#42,Freight#43,ShipName#44,ShipAddress#45,ShipCity#46,ShipRegion#47,ShipPostalCode#48,ShipCountry#49,OrderID1#50,ProductID#51,UnitPrice#52,Quantity#53,Discount#54] parquet
            :     :     :           :     +- Project [ProductID#120, SupplierID#122, Country#1796 AS MagasinCountry#1853]
            :     :     :           :        +- Join Inner, (SupplierID#122 = SupplierID#96)
            :     :     :           :           :- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :  +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :     +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :        +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, UnitPrice#1291, coalesce(UnitsInStock#126, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :           +- Project [ProductID#120, ProductName#121, SupplierID#122, CategoryID#123, QuantityPerUnit#124, coalesce(UnitPrice#125, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#126, UnitsOnOrder#127, ReorderLevel#128, Discontinued#129]
            :     :     :           :           :              +- Deduplicate [UnitPrice#125, UnitsOnOrder#127, CategoryID#123, UnitsInStock#126, SupplierID#122, QuantityPerUnit#124, Discontinued#129, ProductID#120, ProductName#121, ReorderLevel#128]
            :     :     :           :           :                 +- Relation [ProductID#120,ProductName#121,SupplierID#122,CategoryID#123,QuantityPerUnit#124,UnitPrice#125,UnitsInStock#126,UnitsOnOrder#127,ReorderLevel#128,Discontinued#129] parquet
            :     :     :           :           +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, trim(Country#1534, None) AS Country#1796, Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :              +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, regexp_replace(Country#1383, [^a-zA-Z0-9\s], , 1) AS Country#1534, Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :                 +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, CASE WHEN RLIKE(Phone#1508, ^[0-9.\-\(\) ]+$) THEN Phone#1508 ELSE Unknown END AS Phone#1521, Fax#1483, HomePage#107]
            :     :     :           :                    +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, coalesce(Phone#105, cast(Unknown as string)) AS Phone#1508, Fax#1483, HomePage#107]
            :     :     :           :                       +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, PostalCode#1458, Country#1383, Phone#105, coalesce(Fax#106, cast(Unknown as string)) AS Fax#1483, HomePage#107]
            :     :     :           :                          +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#1433, Region#102, coalesce(PostalCode#103, cast(Unknown as string)) AS PostalCode#1458, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                             +- Project [SupplierID#96, CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, coalesce(City#101, cast(Unknown as string)) AS City#1433, Region#102, PostalCode#103, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                +- Project [SupplierID#96, coalesce(CompanyName#97, cast(Unknown as string)) AS CompanyName#1408, ContactName#98, ContactTitle#99, Address#100, City#101, Region#102, PostalCode#103, Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                   +- Project [SupplierID#96, CompanyName#97, ContactName#98, ContactTitle#99, Address#100, City#101, Region#102, PostalCode#103, coalesce(Country#104, cast(Unknown as string)) AS Country#1383, Phone#105, Fax#106, HomePage#107]
            :     :     :           :                                      +- Deduplicate [CompanyName#97, Country#104, Address#100, Region#102, Fax#106, Phone#105, City#101, SupplierID#96, ContactName#98, HomePage#107, ContactTitle#99, PostalCode#103]
            :     :     :           :                                         +- Relation [SupplierID#96,CompanyName#97,ContactName#98,ContactTitle#99,Address#100,City#101,Region#102,PostalCode#103,Country#104,Phone#105,Fax#106,HomePage#107] parquet
            :     :     :           +- Project [ID_taux#148, to_date(date#149, Some(yyyy-MM-dd), Some(Europe/Paris), false) AS date#1934, Country#1771]
            :     :     :              +- Project [ID_taux#148, date#149, Country#1771]
            :     :     :                 +- Join Inner, (Country#1771 = ShipCountry#1777)
            :     :     :                    :- Project [ID_taux#148, date#149, ratetoeuro#150, trim(Country#151, None) AS Country#1771, currency#152]
            :     :     :                    :  +- Relation [ID_taux#148,date#149,ratetoeuro#150,Country#151,currency#152] parquet
            :     :     :                    +- Deduplicate [ShipCountry#1777]
            :     :     :                       +- Project [ShipCountry#1777]
            :     :     :                          +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                             +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                   +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                      +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                         +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, to_date(RequiredDate#1942, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                            +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                               +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                  +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                     +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                        +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#871, RequiredDate#1942, to_date(ShippedDate#1943, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                           +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                              +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                 +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                    +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                       +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, to_date(OrderDate#1941, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                          +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                             +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#738, ShipName#1946, ShipAddress#719, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :     :                                                                                +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#1946, ShipAddress#719, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :                                                                                   +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, coalesce(ShipAddress#1947, cast(Unknown as string)) AS ShipAddress#719, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, Quantity#682, Discount#645]
            :     :     :                                                                                      +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :     :                                                                                         +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :     :                                                                                            +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :     :                                                                                               +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, coalesce(Freight#1945, cast(0.0 as string)) AS Freight#571, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                  +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#1951, cast(Unknown as string)) AS ShipCountry#534, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                     +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#460, coalesce(ShipPostalCode#1950, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#1951, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                        +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, coalesce(ShipRegion#1949, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#1950, ShipCountry#1951, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                           +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, ProductID#1953, UnitPrice#179, Quantity#158, Discount#199]
            :     :     :                                                                                                              +- Deduplicate [Quantity#158, ShipCountry#1951, UnitPrice#179, ShipCity#1948, ShipVia#1944, Discount#199, CustomerID#1939, ShipRegion#1949, ShipName#1946, ShippedDate#1943, ShipPostalCode#1950, OrderID#1938, ShipAddress#1947, RequiredDate#1942, Freight#1945, EmployeeID#1940, ProductID#1953, OrderID1#1952, OrderDate#1941]
            :     :     :                                                                                                                 +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, OrderID1#1952, ProductID#1953, UnitPrice#179, Quantity#158, cast(Discount#1956 as float) AS Discount#199]
            :     :     :                                                                                                                    +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, OrderID1#1952, ProductID#1953, cast(UnitPrice#1954 as float) AS UnitPrice#179, Quantity#158, Discount#1956]
            :     :     :                                                                                                                       +- Project [OrderID#1938, CustomerID#1939, EmployeeID#1940, OrderDate#1941, RequiredDate#1942, ShippedDate#1943, ShipVia#1944, Freight#1945, ShipName#1946, ShipAddress#1947, ShipCity#1948, ShipRegion#1949, ShipPostalCode#1950, ShipCountry#1951, OrderID1#1952, ProductID#1953, UnitPrice#1954, cast(Quantity#1955 as int) AS Quantity#158, Discount#1956]
            :     :     :                                                                                                                          +- Relation [OrderID#1938,CustomerID#1939,EmployeeID#1940,OrderDate#1941,RequiredDate#1942,ShippedDate#1943,ShipVia#1944,Freight#1945,ShipName#1946,ShipAddress#1947,ShipCity#1948,ShipRegion#1949,ShipPostalCode#1950,ShipCountry#1951,OrderID1#1952,ProductID#1953,UnitPrice#1954,Quantity#1955,Discount#1956] parquet
            :     :     +- Project [TaxCountry#2151, TaxYear#2146, TaxID#2156, TaxeRate#8]
            :     :        +- Join LeftOuter, (TaxCountry#2151 = ShipCountry#1777)
            :     :           :- Project [ID_Taxe#0 AS TaxID#2156, TaxCountry#2151, TaxeRate#8, TaxYear#2146]
            :     :           :  +- Project [ID_Taxe#0, Country#1600 AS TaxCountry#2151, TaxeRate#8, TaxYear#2146]
            :     :           :     +- Project [ID_Taxe#0, Country#1600, TaxeRate#8, Year#3 AS TaxYear#2146]
            :     :           :        +- Project [ID_Taxe#0, regexp_replace(Country#1595, [^a-zA-Z0-9\s], , 1) AS Country#1600, TaxeRate#8, Year#3]
            :     :           :           +- Project [ID_Taxe#0, coalesce(Country#1, cast(Unknown as string)) AS Country#1595, TaxeRate#8, Year#3]
            :     :           :              +- Deduplicate [ID_Taxe#0, Country#1, TaxeRate#8, Year#3]
            :     :           :                 +- Project [ID_Taxe#0, Country#1, cast(TaxeRate#2 as float) AS TaxeRate#8, Year#3]
            :     :           :                    +- Relation [ID_Taxe#0,Country#1,TaxeRate#2,Year#3] parquet
            :     :           +- Deduplicate [ShipCountry#1777]
            :     :              +- Project [ShipCountry#1777]
            :     :                 +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#2103, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2217, year(ShippedDate#2103) AS Year#2124]
            :     :                    +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, to_date(ShippedDate#966, Some(dd/MM/yyyy), Some(Europe/Paris), false) AS ShippedDate#2103, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2217]
            :     :                       +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853, ID_taux#2217]
            :     :                          +- Join LeftOuter, ((ShipCountry#1777 = Country#1771) AND (cast(ShippedDate#966 as date) = date#1934))
            :     :                             :- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645, MagasinCountry#1853]
            :     :                             :  +- Join Inner, (ProductID#2191 = ProductID#2195)
            :     :                             :     :- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :  +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :     +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :        +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :           +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :              +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, to_date(RequiredDate#2180, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                 +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                    +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                       +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                          +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                             +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#871, RequiredDate#2180, to_date(ShippedDate#2181, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                   +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                      +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                         +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                            +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, to_date(OrderDate#2179, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                               +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                                  +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#738, ShipName#2184, ShipAddress#719, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :                             :     :                                                     +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#2184, ShipAddress#719, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, Quantity#682, Discount#645]
            :     :                             :     :                                                        +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, coalesce(ShipAddress#2185, cast(Unknown as string)) AS ShipAddress#719, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, Quantity#682, Discount#645]
            :     :                             :     :                                                           +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :                             :     :                                                              +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :                             :     :                                                                 +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :                             :     :                                                                    +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, coalesce(Freight#2183, cast(0.0 as string)) AS Freight#571, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                       +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#2189, cast(Unknown as string)) AS ShipCountry#534, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                          +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#460, coalesce(ShipPostalCode#2188, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#2189, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                             +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, coalesce(ShipRegion#2187, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#2188, ShipCountry#2189, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                                +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, ProductID#2191, UnitPrice#179, Quantity#158, Discount#199]
            :     :                             :     :                                                                                   +- Deduplicate [Quantity#158, ShipCountry#2189, UnitPrice#179, ShipCity#2186, ShipVia#2182, Discount#199, CustomerID#2177, ShipRegion#2187, ShipName#2184, ShippedDate#2181, ShipPostalCode#2188, OrderID#2176, ShipAddress#2185, RequiredDate#2180, Freight#2183, EmployeeID#2178, ProductID#2191, OrderID1#2190, OrderDate#2179]
            :     :                             :     :                                                                                      +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, OrderID1#2190, ProductID#2191, UnitPrice#179, Quantity#158, cast(Discount#2194 as float) AS Discount#199]
            :     :                             :     :                                                                                         +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, OrderID1#2190, ProductID#2191, cast(UnitPrice#2192 as float) AS UnitPrice#179, Quantity#158, Discount#2194]
            :     :                             :     :                                                                                            +- Project [OrderID#2176, CustomerID#2177, EmployeeID#2178, OrderDate#2179, RequiredDate#2180, ShippedDate#2181, ShipVia#2182, Freight#2183, ShipName#2184, ShipAddress#2185, ShipCity#2186, ShipRegion#2187, ShipPostalCode#2188, ShipCountry#2189, OrderID1#2190, ProductID#2191, UnitPrice#2192, cast(Quantity#2193 as int) AS Quantity#158, Discount#2194]
            :     :                             :     :                                                                                               +- Relation [OrderID#2176,CustomerID#2177,EmployeeID#2178,OrderDate#2179,RequiredDate#2180,ShippedDate#2181,ShipVia#2182,Freight#2183,ShipName#2184,ShipAddress#2185,ShipCity#2186,ShipRegion#2187,ShipPostalCode#2188,ShipCountry#2189,OrderID1#2190,ProductID#2191,UnitPrice#2192,Quantity#2193,Discount#2194] parquet
            :     :                             :     +- Project [ProductID#2195, SupplierID#2197, Country#1796 AS MagasinCountry#1853]
            :     :                             :        +- Join Inner, (SupplierID#2197 = SupplierID#2205)
            :     :                             :           :- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :  +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :     +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :        +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, UnitPrice#1291, coalesce(UnitsInStock#2201, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :           +- Project [ProductID#2195, ProductName#2196, SupplierID#2197, CategoryID#2198, QuantityPerUnit#2199, coalesce(UnitPrice#2200, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#2201, UnitsOnOrder#2202, ReorderLevel#2203, Discontinued#2204]
            :     :                             :           :              +- Deduplicate [UnitPrice#2200, UnitsOnOrder#2202, CategoryID#2198, UnitsInStock#2201, SupplierID#2197, QuantityPerUnit#2199, Discontinued#2204, ProductID#2195, ProductName#2196, ReorderLevel#2203]
            :     :                             :           :                 +- Relation [ProductID#2195,ProductName#2196,SupplierID#2197,CategoryID#2198,QuantityPerUnit#2199,UnitPrice#2200,UnitsInStock#2201,UnitsOnOrder#2202,ReorderLevel#2203,Discontinued#2204] parquet
            :     :                             :           +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, trim(Country#1534, None) AS Country#1796, Phone#1521, Fax#1483, HomePage#2216]
            :     :                             :              +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, regexp_replace(Country#1383, [^a-zA-Z0-9\s], , 1) AS Country#1534, Phone#1521, Fax#1483, HomePage#2216]
            :     :                             :                 +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, Country#1383, CASE WHEN RLIKE(Phone#1508, ^[0-9.\-\(\) ]+$) THEN Phone#1508 ELSE Unknown END AS Phone#1521, Fax#1483, HomePage#2216]
            :     :                             :                    +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, Country#1383, coalesce(Phone#2214, cast(Unknown as string)) AS Phone#1508, Fax#1483, HomePage#2216]
            :     :                             :                       +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, PostalCode#1458, Country#1383, Phone#2214, coalesce(Fax#2215, cast(Unknown as string)) AS Fax#1483, HomePage#2216]
            :     :                             :                          +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#1433, Region#2211, coalesce(PostalCode#2212, cast(Unknown as string)) AS PostalCode#1458, Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                             +- Project [SupplierID#2205, CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, coalesce(City#2210, cast(Unknown as string)) AS City#1433, Region#2211, PostalCode#2212, Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                                +- Project [SupplierID#2205, coalesce(CompanyName#2206, cast(Unknown as string)) AS CompanyName#1408, ContactName#2207, ContactTitle#2208, Address#2209, City#2210, Region#2211, PostalCode#2212, Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                                   +- Project [SupplierID#2205, CompanyName#2206, ContactName#2207, ContactTitle#2208, Address#2209, City#2210, Region#2211, PostalCode#2212, coalesce(Country#2213, cast(Unknown as string)) AS Country#1383, Phone#2214, Fax#2215, HomePage#2216]
            :     :                             :                                      +- Deduplicate [CompanyName#2206, Country#2213, Address#2209, Region#2211, Fax#2215, Phone#2214, City#2210, SupplierID#2205, ContactName#2207, HomePage#2216, ContactTitle#2208, PostalCode#2212]
            :     :                             :                                         +- Relation [SupplierID#2205,CompanyName#2206,ContactName#2207,ContactTitle#2208,Address#2209,City#2210,Region#2211,PostalCode#2212,Country#2213,Phone#2214,Fax#2215,HomePage#2216] parquet
            :     :                             +- Project [ID_taux#2217, to_date(date#2218, Some(yyyy-MM-dd), Some(Europe/Paris), false) AS date#1934, Country#1771]
            :     :                                +- Project [ID_taux#2217, date#2218, Country#1771]
            :     :                                   +- Join Inner, (Country#1771 = ShipCountry#1777)
            :     :                                      :- Project [ID_taux#2217, date#2218, ratetoeuro#2219, trim(Country#2220, None) AS Country#1771, currency#2221]
            :     :                                      :  +- Relation [ID_taux#2217,date#2218,ratetoeuro#2219,Country#2220,currency#2221] parquet
            :     :                                      +- Deduplicate [ShipCountry#1777]
            :     :                                         +- Project [ShipCountry#1777]
            :     :                                            +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#1061, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, trim(ShipCountry#534, None) AS ShipCountry#1777, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                               +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, regexp_replace(RequiredDate#1042, 1998, 2024, 1) AS RequiredDate#1061, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                  +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, regexp_replace(RequiredDate#1023, 1997, 2023, 1) AS RequiredDate#1042, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                     +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, regexp_replace(RequiredDate#1004, 1996, 2022, 1) AS RequiredDate#1023, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                        +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, date_format(cast(RequiredDate#985 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS RequiredDate#1004, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                           +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, to_date(RequiredDate#2226, Some(MM/dd/yy), Some(Europe/Paris), false) AS RequiredDate#985, ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                              +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, regexp_replace(ShippedDate#947, 1998, 2024, 1) AS ShippedDate#966, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                 +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, regexp_replace(ShippedDate#928, 1997, 2023, 1) AS ShippedDate#947, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                    +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, regexp_replace(ShippedDate#909, 1996, 2022, 1) AS ShippedDate#928, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                       +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, date_format(cast(ShippedDate#890 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS ShippedDate#909, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                          +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#871, RequiredDate#2226, to_date(ShippedDate#2227, Some(MM/dd/yy), Some(Europe/Paris), false) AS ShippedDate#890, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                             +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, regexp_replace(OrderDate#852, 1998, 2024, 1) AS OrderDate#871, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, regexp_replace(OrderDate#833, 1997, 2023, 1) AS OrderDate#852, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                   +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, regexp_replace(OrderDate#814, 1996, 2022, 1) AS OrderDate#833, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                      +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, date_format(cast(OrderDate#795 as timestamp), dd/MM/yyyy, Some(Europe/Paris)) AS OrderDate#814, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                         +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, to_date(OrderDate#2225, Some(MM/dd/yy), Some(Europe/Paris), false) AS OrderDate#795, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                            +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, regexp_replace(ShipAddress#719, [^a-zA-Z0-9\s], , 1) AS ShipAddress#776, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                               +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#738, ShipName#2230, ShipAddress#719, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, CASE WHEN (UnitPrice#608 < cast(0 as float)) THEN 0.0 ELSE cast(UnitPrice#608 as double) END AS UnitPrice#757, Quantity#682, Discount#645]
            :     :                                                                                                  +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, CASE WHEN (cast(Freight#571 as int) < 0) THEN cast(0.0 as string) ELSE Freight#571 END AS Freight#738, ShipName#2230, ShipAddress#719, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, Quantity#682, Discount#645]
            :     :                                                                                                     +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, coalesce(ShipAddress#2231, cast(Unknown as string)) AS ShipAddress#719, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, Quantity#682, Discount#645]
            :     :                                                                                                        +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, coalesce(Quantity#158, cast(1 as int)) AS Quantity#682, Discount#645]
            :     :                                                                                                           +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#608, Quantity#158, coalesce(nanvl(Discount#199, cast(null as float)), cast(0.0 as float)) AS Discount#645]
            :     :                                                                                                              +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, coalesce(nanvl(UnitPrice#179, cast(null as float)), cast(0.0 as float)) AS UnitPrice#608, Quantity#158, Discount#199]
            :     :                                                                                                                 +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, coalesce(Freight#2229, cast(0.0 as string)) AS Freight#571, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, ShipCountry#534, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                    +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, ShipPostalCode#497, coalesce(ShipCountry#2235, cast(Unknown as string)) AS ShipCountry#534, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                       +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#460, coalesce(ShipPostalCode#2234, cast(Unknown as string)) AS ShipPostalCode#497, ShipCountry#2235, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                          +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, coalesce(ShipRegion#2233, cast(Unknown as string)) AS ShipRegion#460, ShipPostalCode#2234, ShipCountry#2235, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                             +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, ProductID#2237, UnitPrice#179, Quantity#158, Discount#199]
            :     :                                                                                                                                +- Deduplicate [Quantity#158, ShipCountry#2235, UnitPrice#179, ShipCity#2232, ShipVia#2228, Discount#199, CustomerID#2223, ShipRegion#2233, ShipName#2230, ShippedDate#2227, ShipPostalCode#2234, OrderID#2222, ShipAddress#2231, RequiredDate#2226, Freight#2229, EmployeeID#2224, ProductID#2237, OrderID1#2236, OrderDate#2225]
            :     :                                                                                                                                   +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, OrderID1#2236, ProductID#2237, UnitPrice#179, Quantity#158, cast(Discount#2240 as float) AS Discount#199]
            :     :                                                                                                                                      +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, OrderID1#2236, ProductID#2237, cast(UnitPrice#2238 as float) AS UnitPrice#179, Quantity#158, Discount#2240]
            :     :                                                                                                                                         +- Project [OrderID#2222, CustomerID#2223, EmployeeID#2224, OrderDate#2225, RequiredDate#2226, ShippedDate#2227, ShipVia#2228, Freight#2229, ShipName#2230, ShipAddress#2231, ShipCity#2232, ShipRegion#2233, ShipPostalCode#2234, ShipCountry#2235, OrderID1#2236, ProductID#2237, UnitPrice#2238, cast(Quantity#2239 as int) AS Quantity#158, Discount#2240]
            :     :                                                                                                                                            +- Relation [OrderID#2222,CustomerID#2223,EmployeeID#2224,OrderDate#2225,RequiredDate#2226,ShippedDate#2227,ShipVia#2228,Freight#2229,ShipName#2230,ShipAddress#2231,ShipCity#2232,ShipRegion#2233,ShipPostalCode#2234,ShipCountry#2235,OrderID1#2236,ProductID#2237,UnitPrice#2238,Quantity#2239,Discount#2240] parquet
            :     +- Project [CustomerID#74, Country#1253, Region#80]
            :        +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, regexp_replace(Country#1114, [^a-zA-Z0-9\s], , 1) AS Country#1253, Phone#1241, Fax#1206]
            :           +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, CASE WHEN RLIKE(Phone#1229, ^[0-9.\-\(\) ]+$) THEN Phone#1229 ELSE Unknown END AS Phone#1241, Fax#1206]
            :              +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, coalesce(Phone#83, cast(Unknown as string)) AS Phone#1229, Fax#1206]
            :                 +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, PostalCode#1183, Country#1114, Phone#83, coalesce(Fax#84, cast(Unknown as string)) AS Fax#1206]
            :                    +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#1160, Region#80, coalesce(PostalCode#81, cast(Unknown as string)) AS PostalCode#1183, Country#1114, Phone#83, Fax#84]
            :                       +- Project [CustomerID#74, CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, coalesce(City#79, cast(Unknown as string)) AS City#1160, Region#80, PostalCode#81, Country#1114, Phone#83, Fax#84]
            :                          +- Project [CustomerID#74, coalesce(CompanyName#75, cast(Unknown as string)) AS CompanyName#1137, ContactName#76, ContactTitle#77, Address#78, City#79, Region#80, PostalCode#81, Country#1114, Phone#83, Fax#84]
            :                             +- Project [CustomerID#74, CompanyName#75, ContactName#76, ContactTitle#77, Address#78, City#79, Region#80, PostalCode#81, coalesce(Country#82, cast(Unknown as string)) AS Country#1114, Phone#83, Fax#84]
            :                                +- Deduplicate [CompanyName#75, Country#82, CustomerID#74, Address#78, Region#80, Fax#84, Phone#83, City#79, ContactName#76, ContactTitle#77, PostalCode#81]
            :                                   +- Relation [CustomerID#74,CompanyName#75,ContactName#76,ContactTitle#77,Address#78,City#79,Region#80,PostalCode#81,Country#82,Phone#83,Fax#84] parquet
            +- Project [ProductID#2371 AS ProduitID#2368, ProductName#2372]
               +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, UnitPrice#1323, CASE WHEN isnull(UnitsInStock#1334) THEN cast(0 as string) ELSE UnitsInStock#1334 END AS UnitsInStock#1345, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                  +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, UnitPrice#1323, CASE WHEN RLIKE(UnitsInStock#1312, ^\d+$) THEN UnitsInStock#1312 ELSE cast(cast(regexp_replace(UnitsInStock#1312, [^0-9], , 1) as int) as string) END AS UnitsInStock#1334, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                     +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, CASE WHEN (cast(UnitPrice#1291 as int) < 0) THEN cast(0.0 as string) ELSE UnitPrice#1291 END AS UnitPrice#1323, UnitsInStock#1312, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                        +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, UnitPrice#1291, coalesce(UnitsInStock#2377, cast(0 as string)) AS UnitsInStock#1312, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                           +- Project [ProductID#2371, ProductName#2372, SupplierID#2373, CategoryID#2374, QuantityPerUnit#2375, coalesce(UnitPrice#2376, cast(0.0 as string)) AS UnitPrice#1291, UnitsInStock#2377, UnitsOnOrder#2378, ReorderLevel#2379, Discontinued#2380]
                              +- Deduplicate [UnitPrice#2376, UnitsOnOrder#2378, CategoryID#2374, UnitsInStock#2377, SupplierID#2373, QuantityPerUnit#2375, Discontinued#2380, ProductID#2371, ProductName#2372, ReorderLevel#2379]
                                 +- Relation [ProductID#2371,ProductName#2372,SupplierID#2373,CategoryID#2374,QuantityPerUnit#2375,UnitPrice#2376,UnitsInStock#2377,UnitsOnOrder#2378,ReorderLevel#2379,Discontinued#2380] parquet

2024-12-01 15:25:26,400 - INFO - Data cleaning process completed.
2024-12-01 15:25:26,402 - INFO - Closing down clientserver connection
2024-12-01 15:28:19,680 - ERROR - Removed 0 duplicate rows
2024-12-01 15:28:19,696 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 15:28:19,696 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:28:19,697 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:28:20,159 - ERROR - Removed 0 duplicate rows
2024-12-01 15:28:20,161 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:28:20,162 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:28:20,597 - ERROR - Removed 0 duplicate rows
2024-12-01 15:28:20,600 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:28:20,601 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:28:20,985 - ERROR - Removed 0 duplicate rows
2024-12-01 15:28:20,987 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:28:20,988 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:28:21,310 - ERROR - Removed 0 duplicate rows
2024-12-01 15:28:21,312 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:28:21,313 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:28:21,858 - ERROR - Removed 0 duplicate rows
2024-12-01 15:28:21,860 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:28:21,860 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:28:22,275 - ERROR - Removed 0 duplicate rows
2024-12-01 15:28:22,277 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:28:22,278 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:28:22,279 - ERROR - Starting cleaning for transactions
2024-12-01 15:28:22,400 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:28:22,447 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 15:28:22,474 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:28:22,495 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 15:28:22,583 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 15:28:22,584 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 15:28:22,671 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:28:22,671 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:28:22,751 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:28:22,752 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:28:22,753 - INFO - Finished cleaning for transactions
2024-12-01 15:28:22,753 - ERROR - Finished cleaning for transactions
2024-12-01 15:28:23,062 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 15:28:23,062 - ERROR - Starting cleaning for clients
2024-12-01 15:28:23,110 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:28:23,127 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:28:23,153 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:28:23,155 - INFO - Finished cleaning for clients
2024-12-01 15:28:23,155 - ERROR - Finished cleaning for clients
2024-12-01 15:28:23,326 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 15:28:23,327 - ERROR - Starting cleaning for produits
2024-12-01 15:28:23,344 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:28:23,366 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:28:23,421 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 15:28:23,423 - INFO - Finished cleaning for produits
2024-12-01 15:28:23,424 - ERROR - Finished cleaning for produits
2024-12-01 15:28:23,646 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 15:28:23,647 - ERROR - Starting cleaning for magasins
2024-12-01 15:28:23,707 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:28:23,723 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:28:23,748 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:28:23,750 - INFO - Finished cleaning for magasins
2024-12-01 15:28:23,750 - ERROR - Finished cleaning for magasins
2024-12-01 15:28:23,928 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 15:28:23,930 - ERROR - Starting cleaning for exchange
2024-12-01 15:28:23,938 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:28:23,960 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:28:23,961 - INFO - Finished cleaning for exchange
2024-12-01 15:28:23,961 - ERROR - Finished cleaning for exchange
2024-12-01 15:28:24,330 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 28130 rows after removing duplicates.
2024-12-01 15:28:24,331 - ERROR - Starting cleaning for rates
2024-12-01 15:28:24,337 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:28:24,357 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:28:24,359 - INFO - Finished cleaning for rates
2024-12-01 15:28:24,359 - ERROR - Finished cleaning for rates
2024-12-01 15:28:24,543 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 15:28:24,545 - ERROR - Starting cleaning for categories
2024-12-01 15:28:24,551 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:28:24,568 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 15:28:24,569 - INFO - Finished cleaning for categories
2024-12-01 15:28:24,569 - ERROR - Finished cleaning for categories
2024-12-01 15:28:24,702 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 15:28:24,985 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 15:28:25,157 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 15:28:25,295 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 15:28:25,425 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 15:28:25,455 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 15:28:25,456 - INFO - Début des jointures et des transformations.
2024-12-01 15:28:25,516 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 15:28:27,202 - ERROR - Calcul des taxes en cours...
2024-12-01 15:28:27,205 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'ID_taux', 'currency', 'ratetoeuro']
2024-12-01 15:28:27,207 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 15:28:27,208 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 15:28:27,208 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 15:28:27,270 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 15:28:27,459 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 15:28:28,678 - ERROR - Calcul du taux de taxe terminé
2024-12-01 15:28:28,745 - ERROR - Calcul du prix après remise terminé
2024-12-01 15:28:31,065 - ERROR - Nombre total de lignes : 2155.
2024-12-01 15:28:31,067 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 15:28:31,067 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 15:28:31,918 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 15:28:31,919 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 15:28:31,951 - ERROR - Détection des anomalies en cours...
2024-12-01 15:28:32,074 - ERROR - Détection des anomalies terminée.
2024-12-01 15:28:32,930 - ERROR - Total anomalies detected: 4
2024-12-01 15:28:32,931 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 15:28:33,350 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 15:28:35,210 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 15:28:35,210 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 15:28:36,010 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 15:28:36,096 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:28:36,096 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:28:36,181 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 15:28:36,181 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 15:28:36,341 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:28:36,341 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:28:40,369 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:28:40,369 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:28:40,688 - INFO - Data cleaning process completed.
2024-12-01 15:28:40,690 - INFO - Closing down clientserver connection
2024-12-01 15:39:54,557 - ERROR - Removed 0 duplicate rows
2024-12-01 15:39:54,572 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 15:39:54,573 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:39:54,574 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:39:55,014 - ERROR - Removed 0 duplicate rows
2024-12-01 15:39:55,016 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:39:55,017 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:39:55,363 - ERROR - Removed 0 duplicate rows
2024-12-01 15:39:55,365 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:39:55,365 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:39:55,720 - ERROR - Removed 0 duplicate rows
2024-12-01 15:39:55,722 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:39:55,722 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:39:56,013 - ERROR - Removed 0 duplicate rows
2024-12-01 15:39:56,014 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:39:56,015 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:39:56,497 - ERROR - Removed 0 duplicate rows
2024-12-01 15:39:56,499 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:39:56,499 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:39:56,826 - ERROR - Removed 0 duplicate rows
2024-12-01 15:39:56,828 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:39:56,828 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:39:56,828 - ERROR - Starting cleaning for transactions
2024-12-01 15:39:56,929 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:39:56,965 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 15:39:56,991 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:39:57,012 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 15:39:57,080 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 15:39:57,080 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 15:39:57,153 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:39:57,153 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:39:57,214 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:39:57,215 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:39:57,215 - INFO - Finished cleaning for transactions
2024-12-01 15:39:57,215 - ERROR - Finished cleaning for transactions
2024-12-01 15:39:57,443 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 15:39:57,444 - ERROR - Starting cleaning for clients
2024-12-01 15:39:57,486 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:39:57,501 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:39:57,518 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:39:57,520 - INFO - Finished cleaning for clients
2024-12-01 15:39:57,520 - ERROR - Finished cleaning for clients
2024-12-01 15:39:57,657 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 15:39:57,658 - ERROR - Starting cleaning for produits
2024-12-01 15:39:57,673 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:39:57,685 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:39:57,714 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 15:39:57,715 - INFO - Finished cleaning for produits
2024-12-01 15:39:57,716 - ERROR - Finished cleaning for produits
2024-12-01 15:39:57,885 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 15:39:57,886 - ERROR - Starting cleaning for magasins
2024-12-01 15:39:57,924 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:39:57,935 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:39:57,945 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:39:57,946 - INFO - Finished cleaning for magasins
2024-12-01 15:39:57,947 - ERROR - Finished cleaning for magasins
2024-12-01 15:39:58,063 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 15:39:58,063 - ERROR - Starting cleaning for exchange
2024-12-01 15:39:58,069 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:39:58,084 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:39:58,085 - INFO - Finished cleaning for exchange
2024-12-01 15:39:58,086 - ERROR - Finished cleaning for exchange
2024-12-01 15:39:58,320 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 28130 rows after removing duplicates.
2024-12-01 15:39:58,321 - ERROR - Starting cleaning for rates
2024-12-01 15:39:58,326 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:39:58,339 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:39:58,340 - INFO - Finished cleaning for rates
2024-12-01 15:39:58,340 - ERROR - Finished cleaning for rates
2024-12-01 15:39:58,477 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 15:39:58,477 - ERROR - Starting cleaning for categories
2024-12-01 15:39:58,482 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:39:58,494 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 15:39:58,495 - INFO - Finished cleaning for categories
2024-12-01 15:39:58,495 - ERROR - Finished cleaning for categories
2024-12-01 15:39:58,598 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 15:39:58,810 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 15:39:58,935 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 15:39:59,053 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 15:39:59,192 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 15:39:59,235 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 15:39:59,235 - INFO - Début des jointures et des transformations.
2024-12-01 15:39:59,285 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 15:40:00,514 - ERROR - Calcul des taxes en cours...
2024-12-01 15:40:00,515 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'ID_taux', 'currency', 'ratetoeuro']
2024-12-01 15:40:00,516 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 15:40:00,517 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 15:40:00,518 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 15:40:00,556 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 15:40:00,692 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 15:40:01,430 - ERROR - Calcul du taux de taxe terminé
2024-12-01 15:40:01,472 - ERROR - Calcul du prix après remise terminé
2024-12-01 15:40:03,055 - ERROR - Nombre total de lignes : 2155.
2024-12-01 15:40:03,056 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 15:40:03,057 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 15:40:03,674 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 15:40:03,675 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 15:40:03,703 - ERROR - Détection des anomalies en cours...
2024-12-01 15:40:03,797 - ERROR - Détection des anomalies terminée.
2024-12-01 15:40:04,396 - ERROR - Total anomalies detected: 4
2024-12-01 15:40:04,397 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 15:40:04,716 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 15:40:06,098 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 15:40:06,098 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 15:40:06,589 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 15:40:06,660 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:40:06,660 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:40:06,711 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 15:40:06,712 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 15:40:06,830 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:40:06,831 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:40:10,183 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:40:10,183 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:40:10,539 - INFO - Data cleaning process completed.
2024-12-01 15:40:10,541 - INFO - Closing down clientserver connection
2024-12-01 15:41:20,022 - ERROR - Removed 0 duplicate rows
2024-12-01 15:41:20,038 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 15:41:20,039 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:41:20,040 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:41:20,503 - ERROR - Removed 0 duplicate rows
2024-12-01 15:41:20,505 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:41:20,506 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:41:20,851 - ERROR - Removed 0 duplicate rows
2024-12-01 15:41:20,852 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:41:20,853 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:41:21,211 - ERROR - Removed 0 duplicate rows
2024-12-01 15:41:21,213 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:41:21,214 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:41:21,502 - ERROR - Removed 0 duplicate rows
2024-12-01 15:41:21,503 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:41:21,504 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:41:21,987 - ERROR - Removed 0 duplicate rows
2024-12-01 15:41:21,989 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:41:21,989 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:41:22,312 - ERROR - Removed 0 duplicate rows
2024-12-01 15:41:22,314 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:41:22,314 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:41:22,315 - ERROR - Starting cleaning for transactions
2024-12-01 15:41:22,439 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:41:22,477 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 15:41:22,498 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:41:22,515 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 15:41:22,577 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 15:41:22,578 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 15:41:22,635 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:41:22,635 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:41:22,699 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:41:22,699 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:41:22,700 - INFO - Finished cleaning for transactions
2024-12-01 15:41:22,700 - ERROR - Finished cleaning for transactions
2024-12-01 15:41:22,937 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 15:41:22,937 - ERROR - Starting cleaning for clients
2024-12-01 15:41:22,980 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:41:22,993 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:41:23,005 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:41:23,006 - INFO - Finished cleaning for clients
2024-12-01 15:41:23,006 - ERROR - Finished cleaning for clients
2024-12-01 15:41:23,144 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 15:41:23,145 - ERROR - Starting cleaning for produits
2024-12-01 15:41:23,159 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:41:23,171 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:41:23,202 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 15:41:23,203 - INFO - Finished cleaning for produits
2024-12-01 15:41:23,203 - ERROR - Finished cleaning for produits
2024-12-01 15:41:23,386 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 15:41:23,387 - ERROR - Starting cleaning for magasins
2024-12-01 15:41:23,417 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:41:23,427 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:41:23,438 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:41:23,440 - INFO - Finished cleaning for magasins
2024-12-01 15:41:23,440 - ERROR - Finished cleaning for magasins
2024-12-01 15:41:23,575 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 15:41:23,575 - ERROR - Starting cleaning for exchange
2024-12-01 15:41:23,583 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:41:23,595 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:41:23,597 - INFO - Finished cleaning for exchange
2024-12-01 15:41:23,597 - ERROR - Finished cleaning for exchange
2024-12-01 15:41:23,841 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 28130 rows after removing duplicates.
2024-12-01 15:41:23,842 - ERROR - Starting cleaning for rates
2024-12-01 15:41:23,848 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:41:23,861 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:41:23,862 - INFO - Finished cleaning for rates
2024-12-01 15:41:23,863 - ERROR - Finished cleaning for rates
2024-12-01 15:41:24,004 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 15:41:24,005 - ERROR - Starting cleaning for categories
2024-12-01 15:41:24,010 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:41:24,020 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 15:41:24,022 - INFO - Finished cleaning for categories
2024-12-01 15:41:24,022 - ERROR - Finished cleaning for categories
2024-12-01 15:41:24,127 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 15:41:24,330 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 15:41:24,464 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 15:41:24,582 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 15:41:24,734 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 15:41:24,780 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 15:41:24,780 - INFO - Début des jointures et des transformations.
2024-12-01 15:41:24,826 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 15:41:25,990 - ERROR - Calcul des taxes en cours...
2024-12-01 15:41:25,991 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'ID_taux', 'currency', 'ratetoeuro']
2024-12-01 15:41:25,992 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 15:41:25,992 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 15:41:25,993 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 15:41:26,034 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 15:41:26,174 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 15:41:26,957 - ERROR - Calcul du taux de taxe terminé
2024-12-01 15:41:27,004 - ERROR - Calcul du prix après remise terminé
2024-12-01 15:41:28,407 - ERROR - Nombre total de lignes : 2155.
2024-12-01 15:41:28,408 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 15:41:28,408 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 15:41:29,023 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 15:41:29,024 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 15:41:29,046 - ERROR - Détection des anomalies en cours...
2024-12-01 15:41:29,144 - ERROR - Détection des anomalies terminée.
2024-12-01 15:41:29,946 - ERROR - Total anomalies detected: 4
2024-12-01 15:41:29,946 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 15:41:30,270 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 15:41:31,652 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 15:41:31,652 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 15:41:32,074 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 15:41:32,135 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:41:32,135 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:41:32,184 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 15:41:32,184 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 15:41:32,284 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:41:32,284 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:41:35,461 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:41:35,461 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:41:35,760 - INFO - Data cleaning process completed.
2024-12-01 15:41:35,763 - INFO - Closing down clientserver connection
2024-12-01 15:42:28,937 - ERROR - Removed 0 duplicate rows
2024-12-01 15:42:28,953 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 15:42:28,954 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:42:28,954 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:42:29,411 - ERROR - Removed 0 duplicate rows
2024-12-01 15:42:29,413 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:42:29,413 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:42:29,772 - ERROR - Removed 0 duplicate rows
2024-12-01 15:42:29,774 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:42:29,774 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:42:30,156 - ERROR - Removed 0 duplicate rows
2024-12-01 15:42:30,156 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:42:30,158 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:42:30,451 - ERROR - Removed 0 duplicate rows
2024-12-01 15:42:30,453 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:42:30,453 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:42:30,951 - ERROR - Removed 0 duplicate rows
2024-12-01 15:42:30,953 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:42:30,953 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:42:31,279 - ERROR - Removed 0 duplicate rows
2024-12-01 15:42:31,281 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:42:31,281 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:42:31,282 - ERROR - Starting cleaning for transactions
2024-12-01 15:42:31,380 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:42:31,420 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 15:42:31,443 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:42:31,467 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 15:42:31,541 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 15:42:31,541 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 15:42:31,601 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:42:31,602 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:42:31,663 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:42:31,664 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:42:31,664 - INFO - Finished cleaning for transactions
2024-12-01 15:42:31,664 - ERROR - Finished cleaning for transactions
2024-12-01 15:42:31,894 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 15:42:31,894 - ERROR - Starting cleaning for clients
2024-12-01 15:42:31,935 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:42:31,946 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:42:31,962 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:42:31,963 - INFO - Finished cleaning for clients
2024-12-01 15:42:31,963 - ERROR - Finished cleaning for clients
2024-12-01 15:42:32,102 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 15:42:32,103 - ERROR - Starting cleaning for produits
2024-12-01 15:42:32,118 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:42:32,131 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:42:32,164 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 15:42:32,165 - INFO - Finished cleaning for produits
2024-12-01 15:42:32,165 - ERROR - Finished cleaning for produits
2024-12-01 15:42:32,332 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 15:42:32,332 - ERROR - Starting cleaning for magasins
2024-12-01 15:42:32,380 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:42:32,391 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:42:32,404 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:42:32,405 - INFO - Finished cleaning for magasins
2024-12-01 15:42:32,405 - ERROR - Finished cleaning for magasins
2024-12-01 15:42:32,523 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 15:42:32,523 - ERROR - Starting cleaning for exchange
2024-12-01 15:42:32,531 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:42:32,547 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:42:32,548 - INFO - Finished cleaning for exchange
2024-12-01 15:42:32,548 - ERROR - Finished cleaning for exchange
2024-12-01 15:42:32,771 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 28130 rows after removing duplicates.
2024-12-01 15:42:32,772 - ERROR - Starting cleaning for rates
2024-12-01 15:42:32,777 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:42:32,788 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:42:32,790 - INFO - Finished cleaning for rates
2024-12-01 15:42:32,790 - ERROR - Finished cleaning for rates
2024-12-01 15:42:32,927 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 15:42:32,927 - ERROR - Starting cleaning for categories
2024-12-01 15:42:32,932 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:42:32,942 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 15:42:32,943 - INFO - Finished cleaning for categories
2024-12-01 15:42:32,943 - ERROR - Finished cleaning for categories
2024-12-01 15:42:33,055 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 15:42:33,262 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 15:42:33,392 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 15:42:33,511 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 15:42:33,623 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 15:42:33,697 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 15:42:33,698 - INFO - Début des jointures et des transformations.
2024-12-01 15:42:33,747 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 15:42:34,883 - ERROR - Calcul des taxes en cours...
2024-12-01 15:42:34,884 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'ID_taux', 'currency', 'ratetoeuro']
2024-12-01 15:42:34,886 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 15:42:34,886 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 15:42:34,887 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 15:42:34,928 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 15:42:35,095 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 15:42:35,828 - ERROR - Calcul du taux de taxe terminé
2024-12-01 15:42:35,869 - ERROR - Calcul du prix après remise terminé
2024-12-01 15:42:37,400 - ERROR - Nombre total de lignes : 2155.
2024-12-01 15:42:37,401 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 15:42:37,401 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 15:42:37,998 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 15:42:37,999 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 15:42:38,027 - ERROR - Détection des anomalies en cours...
2024-12-01 15:42:38,119 - ERROR - Détection des anomalies terminée.
2024-12-01 15:42:38,739 - ERROR - Total anomalies detected: 4
2024-12-01 15:42:38,740 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 15:42:39,054 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 15:42:40,439 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 15:42:40,440 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 15:42:40,887 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 15:42:40,951 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:42:40,951 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:42:41,002 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 15:42:41,002 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 15:42:41,101 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:42:41,102 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:42:44,284 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:42:44,284 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:42:44,726 - INFO - Data cleaning process completed.
2024-12-01 15:42:44,729 - INFO - Closing down clientserver connection
2024-12-01 15:44:50,685 - ERROR - Removed 0 duplicate rows
2024-12-01 15:44:50,700 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 15:44:50,701 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:44:50,702 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:44:51,119 - ERROR - Removed 0 duplicate rows
2024-12-01 15:44:51,121 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:44:51,121 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:44:51,467 - ERROR - Removed 0 duplicate rows
2024-12-01 15:44:51,469 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:44:51,470 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:44:51,829 - ERROR - Removed 0 duplicate rows
2024-12-01 15:44:51,831 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:44:51,831 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:44:52,129 - ERROR - Removed 0 duplicate rows
2024-12-01 15:44:52,130 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:44:52,131 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:44:52,592 - ERROR - Removed 0 duplicate rows
2024-12-01 15:44:52,594 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:44:52,594 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:44:52,952 - ERROR - Removed 0 duplicate rows
2024-12-01 15:44:52,953 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:44:52,954 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:44:52,954 - ERROR - Starting cleaning for transactions
2024-12-01 15:44:53,057 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:44:53,095 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 15:44:53,118 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:44:53,142 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 15:44:53,215 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 15:44:53,215 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 15:44:53,288 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:44:53,289 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:44:53,357 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:44:53,357 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:44:53,358 - INFO - Finished cleaning for transactions
2024-12-01 15:44:53,358 - ERROR - Finished cleaning for transactions
2024-12-01 15:44:53,604 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 15:44:53,604 - ERROR - Starting cleaning for clients
2024-12-01 15:44:53,650 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:44:53,663 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:44:53,677 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:44:53,678 - INFO - Finished cleaning for clients
2024-12-01 15:44:53,679 - ERROR - Finished cleaning for clients
2024-12-01 15:44:53,856 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 15:44:53,857 - ERROR - Starting cleaning for produits
2024-12-01 15:44:53,870 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:44:53,882 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:44:53,911 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 15:44:53,912 - INFO - Finished cleaning for produits
2024-12-01 15:44:53,914 - ERROR - Finished cleaning for produits
2024-12-01 15:44:54,051 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 15:44:54,052 - ERROR - Starting cleaning for magasins
2024-12-01 15:44:54,086 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:44:54,096 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:44:54,106 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:44:54,107 - INFO - Finished cleaning for magasins
2024-12-01 15:44:54,108 - ERROR - Finished cleaning for magasins
2024-12-01 15:44:54,225 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 15:44:54,226 - ERROR - Starting cleaning for exchange
2024-12-01 15:44:54,233 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:44:54,247 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:44:54,248 - INFO - Finished cleaning for exchange
2024-12-01 15:44:54,249 - ERROR - Finished cleaning for exchange
2024-12-01 15:44:54,472 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 28130 rows after removing duplicates.
2024-12-01 15:44:54,473 - ERROR - Starting cleaning for rates
2024-12-01 15:44:54,477 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:44:54,489 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:44:54,491 - INFO - Finished cleaning for rates
2024-12-01 15:44:54,491 - ERROR - Finished cleaning for rates
2024-12-01 15:44:54,634 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 15:44:54,635 - ERROR - Starting cleaning for categories
2024-12-01 15:44:54,639 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:44:54,650 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 15:44:54,651 - INFO - Finished cleaning for categories
2024-12-01 15:44:54,651 - ERROR - Finished cleaning for categories
2024-12-01 15:44:54,770 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 15:44:54,967 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 15:44:55,100 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 15:44:55,220 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 15:44:55,332 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 15:44:55,373 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 15:44:55,374 - INFO - Début des jointures et des transformations.
2024-12-01 15:44:55,438 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 15:44:56,598 - ERROR - Calcul des taxes en cours...
2024-12-01 15:44:56,600 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'ID_taux', 'currency', 'ratetoeuro']
2024-12-01 15:44:56,601 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 15:44:56,601 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 15:44:56,601 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 15:44:56,642 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 15:44:56,788 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 15:44:57,574 - ERROR - Calcul du taux de taxe terminé
2024-12-01 15:44:57,618 - ERROR - Calcul du prix après remise terminé
2024-12-01 15:44:58,992 - ERROR - Nombre total de lignes : 2155.
2024-12-01 15:44:58,992 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 15:44:58,993 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 15:44:59,620 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 15:44:59,621 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 15:44:59,647 - ERROR - Détection des anomalies en cours...
2024-12-01 15:44:59,746 - ERROR - Détection des anomalies terminée.
2024-12-01 15:45:00,350 - ERROR - Total anomalies detected: 4
2024-12-01 15:45:00,351 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 15:45:00,668 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 15:45:02,086 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 15:45:02,086 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 15:45:02,519 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 15:45:02,587 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:45:02,587 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:45:02,639 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 15:45:02,639 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 15:45:02,741 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:45:02,742 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:45:06,271 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:45:06,271 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:45:06,525 - INFO - Data cleaning process completed.
2024-12-01 15:45:06,527 - INFO - Closing down clientserver connection
2024-12-01 15:48:01,140 - ERROR - Removed 0 duplicate rows
2024-12-01 15:48:01,155 - ERROR - Dropped duplicate columns ['OrderID1'] for base name 'OrderID'
2024-12-01 15:48:01,155 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:48:01,156 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:48:01,590 - ERROR - Removed 0 duplicate rows
2024-12-01 15:48:01,592 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:48:01,593 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:48:01,973 - ERROR - Removed 0 duplicate rows
2024-12-01 15:48:01,975 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:48:01,976 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:48:02,313 - ERROR - Removed 0 duplicate rows
2024-12-01 15:48:02,315 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:48:02,315 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:48:02,606 - ERROR - Removed 0 duplicate rows
2024-12-01 15:48:02,608 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:48:02,608 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:48:03,102 - ERROR - Removed 0 duplicate rows
2024-12-01 15:48:03,104 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:48:03,104 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:48:03,437 - ERROR - Removed 0 duplicate rows
2024-12-01 15:48:03,439 - ERROR - Finished cleaning duplicate rows and columns
2024-12-01 15:48:03,439 - INFO - TRANSFORMATION: Clean Duplicates | STATUS: SUCCESS | DETAILS: Removed 0 duplicate rows.
2024-12-01 15:48:03,439 - ERROR - Starting cleaning for transactions
2024-12-01 15:48:03,534 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:48:03,570 - ERROR - Set negative values in 'Freight' to 0.0
2024-12-01 15:48:03,591 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:48:03,608 - ERROR - Cleaned 'ShipAddress' by removing special characters
2024-12-01 15:48:03,681 - INFO - Cleaned and reformatted 'OrderDate'
2024-12-01 15:48:03,681 - ERROR - Cleaned and reformatted 'OrderDate'
2024-12-01 15:48:03,743 - INFO - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:48:03,744 - ERROR - Cleaned and reformatted 'ShippedDate'
2024-12-01 15:48:03,802 - INFO - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:48:03,803 - ERROR - Cleaned and reformatted 'RequiredDate'
2024-12-01 15:48:03,804 - INFO - Finished cleaning for transactions
2024-12-01 15:48:03,804 - ERROR - Finished cleaning for transactions
2024-12-01 15:48:04,029 - INFO - TRANSFORMATION: Clean Data for transactions | STATUS: SUCCESS | DETAILS: Data cleaned with 2155 rows after removing duplicates.
2024-12-01 15:48:04,029 - ERROR - Starting cleaning for clients
2024-12-01 15:48:04,069 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:48:04,080 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:48:04,092 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:48:04,094 - INFO - Finished cleaning for clients
2024-12-01 15:48:04,094 - ERROR - Finished cleaning for clients
2024-12-01 15:48:04,235 - INFO - TRANSFORMATION: Clean Data for clients | STATUS: SUCCESS | DETAILS: Data cleaned with 91 rows after removing duplicates.
2024-12-01 15:48:04,235 - ERROR - Starting cleaning for produits
2024-12-01 15:48:04,245 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:48:04,256 - ERROR - Set negative values in 'UnitPrice' to 0.0
2024-12-01 15:48:04,286 - ERROR - Cleaned 'UnitsInStock' by removing non-numeric characters and setting invalid values to 0
2024-12-01 15:48:04,288 - INFO - Finished cleaning for produits
2024-12-01 15:48:04,288 - ERROR - Finished cleaning for produits
2024-12-01 15:48:04,460 - INFO - TRANSFORMATION: Clean Data for produits | STATUS: SUCCESS | DETAILS: Data cleaned with 77 rows after removing duplicates.
2024-12-01 15:48:04,461 - ERROR - Starting cleaning for magasins
2024-12-01 15:48:04,495 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:48:04,506 - ERROR - Standardized formats in 'Phone', set invalid formats to 'Unknown'
2024-12-01 15:48:04,519 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:48:04,520 - INFO - Finished cleaning for magasins
2024-12-01 15:48:04,520 - ERROR - Finished cleaning for magasins
2024-12-01 15:48:04,633 - INFO - TRANSFORMATION: Clean Data for magasins | STATUS: SUCCESS | DETAILS: Data cleaned with 29 rows after removing duplicates.
2024-12-01 15:48:04,634 - ERROR - Starting cleaning for exchange
2024-12-01 15:48:04,641 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:48:04,654 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:48:04,655 - INFO - Finished cleaning for exchange
2024-12-01 15:48:04,655 - ERROR - Finished cleaning for exchange
2024-12-01 15:48:04,894 - INFO - TRANSFORMATION: Clean Data for exchange | STATUS: SUCCESS | DETAILS: Data cleaned with 28130 rows after removing duplicates.
2024-12-01 15:48:04,895 - ERROR - Starting cleaning for rates
2024-12-01 15:48:04,900 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:48:04,912 - ERROR - Cleaned 'Country' by removing special characters
2024-12-01 15:48:04,913 - INFO - Finished cleaning for rates
2024-12-01 15:48:04,913 - ERROR - Finished cleaning for rates
2024-12-01 15:48:05,052 - INFO - TRANSFORMATION: Clean Data for rates | STATUS: SUCCESS | DETAILS: Data cleaned with 207 rows after removing duplicates.
2024-12-01 15:48:05,053 - ERROR - Starting cleaning for categories
2024-12-01 15:48:05,058 - ERROR - Applied fillna with values: {'ShipRegion': 'Unknown', 'ShipPostalCode': 'Unknown', 'ShipCountry': 'Unknown', 'Country': 'Unknown', 'CompanyName': 'Unknown', 'City': 'Unknown', 'PostalCode': 'Unknown', 'Fax': 'Unknown', 'Phone': 'Unknown', 'CategoryName': 'Unknown', 'Freight': 0.0, 'UnitPrice': 0.0, 'Discount': 0.0, 'Quantity': 1, 'UnitsInStock': 0, 'ShipAddress': 'Unknown'}
2024-12-01 15:48:05,067 - ERROR - Cleaned 'CategoryName' by removing special characters
2024-12-01 15:48:05,068 - INFO - Finished cleaning for categories
2024-12-01 15:48:05,068 - ERROR - Finished cleaning for categories
2024-12-01 15:48:05,170 - INFO - TRANSFORMATION: Clean Data for categories | STATUS: SUCCESS | DETAILS: Data cleaned with 8 rows after removing duplicates.
2024-12-01 15:48:05,374 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 2155 rows.
2024-12-01 15:48:05,506 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 91 rows.
2024-12-01 15:48:05,624 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 77 rows.
2024-12-01 15:48:05,764 - INFO - TRANSFORMATION: Enrich Data | STATUS: SUCCESS | DETAILS: Data enriched with new column 'enriched_column'. 29 rows.
2024-12-01 15:48:05,803 - INFO - Normalisation des colonnes 'Country' terminée.
2024-12-01 15:48:05,803 - INFO - Début des jointures et des transformations.
2024-12-01 15:48:05,848 - INFO - Filtrage des données d'exchange_df pour les pays présents dans transaction_df.
2024-12-01 15:48:06,857 - ERROR - Calcul des taxes en cours...
2024-12-01 15:48:06,858 - ERROR - Colonnes de transactions_df: ['OrderID', 'CustomerID', 'EmployeeID', 'OrderDate', 'RequiredDate', 'ShippedDate', 'ShipVia', 'Freight', 'ShipName', 'ShipAddress', 'ShipCity', 'ShipRegion', 'ShipPostalCode', 'ShipCountry', 'ProductID', 'UnitPrice', 'Quantity', 'Discount', 'MagasinCountry', 'ID_taux', 'currency', 'ratetoeuro']
2024-12-01 15:48:06,859 - ERROR - Colonnes de clients_df: ['CustomerID', 'CompanyName', 'ContactName', 'ContactTitle', 'Address', 'City', 'Region', 'PostalCode', 'Country', 'Phone', 'Fax']
2024-12-01 15:48:06,860 - ERROR - Colonnes de taxe_df: ['ID_Taxe', 'Country', 'TaxeRate', 'Year']
2024-12-01 15:48:06,861 - ERROR - Colonnes de produits_df: ['ProductID', 'ProductName', 'SupplierID', 'CategoryID', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock', 'UnitsOnOrder', 'ReorderLevel', 'Discontinued']
2024-12-01 15:48:06,891 - ERROR - Ajout de la colonne 'Year' basée sur 'ShippedDate'
2024-12-01 15:48:06,997 - ERROR - Affichage des données après ajout de TaxID et TaxeRate
2024-12-01 15:48:07,705 - ERROR - Calcul du taux de taxe terminé
2024-12-01 15:48:07,737 - ERROR - Calcul du prix après remise terminé
2024-12-01 15:48:08,971 - ERROR - Nombre total de lignes : 2155.
2024-12-01 15:48:08,971 - ERROR - Nombre de taux de change manquants : 2155.
2024-12-01 15:48:08,972 - ERROR - Remplacement des taux de change manquants par 1 (valeur par défaut).
2024-12-01 15:48:09,725 - ERROR - Nombre de devises manquantes : 2155.
2024-12-01 15:48:09,726 - ERROR - Remplacement des devises manquantes par 'UNKNOWN'.
2024-12-01 15:48:09,749 - ERROR - Détection des anomalies en cours...
2024-12-01 15:48:09,819 - ERROR - Détection des anomalies terminée.
2024-12-01 15:48:10,333 - ERROR - Total anomalies detected: 4
2024-12-01 15:48:10,333 - ERROR - TRANSFORMATION: Suivi des anomalies | STATUS: ERROR | DETAILS: Nombre total d'anomalies détectées : 4
2024-12-01 15:48:10,602 - ERROR - Ajout d'erreurs intentionnelles terminé.
2024-12-01 15:48:12,029 - INFO - Les produits ont été groupés par catégorie.
2024-12-01 15:48:12,030 - ERROR - Les produits ont été groupés par catégorie.
2024-12-01 15:48:12,452 - INFO - TRANSFORMATION: Ajout du statut produit | STATUS: SUCCESS | DETAILS: Statuts ajoutés pour 77 produits
2024-12-01 15:48:12,526 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:48:12,526 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:48:12,581 - INFO - Enrichissement des données pour les clients terminé.
2024-12-01 15:48:12,581 - ERROR - Enrichissement des données pour les clients terminé.
2024-12-01 15:48:12,692 - INFO - Clients enriched and grouped by region successfully.
2024-12-01 15:48:12,692 - ERROR - Clients enriched and grouped by region successfully.
2024-12-01 15:48:15,920 - INFO - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:48:15,920 - ERROR - Les données transformées ont été sauvegardées dans la couche Silver.
2024-12-01 15:48:16,332 - INFO - Data cleaning process completed.
2024-12-01 15:48:16,334 - INFO - Closing down clientserver connection
